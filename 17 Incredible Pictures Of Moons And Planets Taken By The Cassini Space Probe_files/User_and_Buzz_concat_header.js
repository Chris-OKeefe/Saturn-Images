BF_ShareEmail=function(){this.ERR_MESS=local.t("Please enter two email addresses.");this.current_button=null;this.from_email="";this.vertical="";this.init=function(){shareEmail.current_button=null;shareEmail.assign_handlers();shareEmail.draw_catcha()};this.assign_handlers=function(){universal_dom.assign_handler({bucket:"share-email-submit",handler:shareEmail.submit,event:"click"});universal_dom.assign_handler({bucket:"share-email__cancel",handler:shareEmail.hide_email_form,event:"click"});universal_dom.assign_handler({bucket:"newsletter_checkbox",handler:shareEmail.newsletter_checkbox,event:"click"});universal_dom.assign_handler({bucket:"email-signup",handler:shareEmail.email_signup,event:"click"});Element.observe(window,"resize",shareEmail.move_to_visible_area)};this.move_to_visible_area=function(){if($("share_email")&&$("share_email").visible()){var t=$("share_email").up(".share-box"),i=$("share_email").up(".share_tools_list"),r=$("share_email").up("#inline_shares_box"),a=t||i||r;if(typeof a!="undefined"){var s=a.select(".sub-buzz-email-share"),o=a.select(".mail .share-icon"),n=s.length?s:o,l=a.select(".email_icon.inlineShareBtn");if(n.length){if($("share_email").up(".buzz_superlist_item_update")){$("share_email").addClassName("top-arrow");var u=n[0].offsetLeft+n[0].getWidth()/2-$("share_email").getWidth()/2;$("share_email").setStyle({left:u+"px"});$("share_email").setStyle({top:50+"px"})}else{var _=n[0].offsetTop+n[0].getHeight()/2-$("share_email").getHeight()/2;$("share_email").setStyle({left:65+"px"});$("share_email").setStyle({top:_+"px"})}}else if(l){var _=l[0].offsetTop+l[0].getHeight()/2-$("share_email").getHeight()/2;$("share_email").setStyle({left:77+"px"});$("share_email").setStyle({top:_+"px"})}}else{var f=$("share_email").viewportOffset();if(f.left<=0){if(!$("share_email").getAttribute("data:originOffset")){$("share_email_form").addClassName("hide-arrow");$("share_email").setAttribute("data:originOffset",$("share_email").offsetLeft)}$("share_email").setStyle({left:$("share_email").offsetLeft-f.left+"px"})}else if($("share_email").getAttribute("data:originOffset")){if($("share_email").offsetLeft-f.left>=$("share_email").getAttribute("data:originOffset")){$("share_email").setStyle({left:$("share_email").offsetLeft-f.left+"px"})}else{$("share_email_form").removeClassName("hide-arrow");$("share_email").setStyle({left:$("share_email").getAttribute("data:originOffset")+"px"});$("share_email").removeAttribute("data:originOffset")}}}}};this.hide_email_form=function(){shareEmail.current_button=null;$("share_email").hide();if(typeof bf_rdio!="undefined")bf_rdio.enable();if(typeof bpage!="undefined"){bpage.hide_all_popups()}};this.locate_form_and_share_email=function(t,i,r){$("share_email").removeAttribute("data:originOffset");$("share_email_form").removeClassName("hide-arrow");$("newsletter_signup_form").hide();$("share-email-error").hide();$("share-email-confirm").hide();$("share_email_form").show();var a={top:0,left:0};if(shareEmail.current_button==t){shareEmail.hide_email_form();return false}else{shareEmail.current_button=t}var s=t.ancestors().indexOf($("inline_shares_box"))>=0;var o=t.hasClassName("sub-buzz-email-share");var n={left:Number($(t).offsetLeft),top:Number($(t).offsetTop),height:Number($(t).getHeight()),width:Number($(t).getWidth())};$("share_email_form").reset();if(BF_STATIC.tt_page=="Videos"&&"videopromo"in window&&videopromo!="undefined"&&videopromo.buzz_id){$("bid").value=parseInt(videopromo.buzz_id)}else{i=i.split("_");$("bid").value=i[0]}if(typeof bf_rdio!="undefined")bf_rdio.disable();$("share_email").show();$("share_email_form").addClassName("share-email-form");$("share_email").setOpacity(1);$("share_email_message").hide();if($("share_email_submit"))$("share_email_submit").removeAttribute("disabled");$(t).insert({after:$("share_email")});arrow={height:s?20:10,width:s?20:10};var l={width:$("share_email").getWidth(),height:$("share_email").getHeight()};if(s){a.top=n.top-parseInt(l.height/2)+parseInt(n.height/2);a.left=n.left+n.width+parseInt(arrow.width)}else if(o){a.top=n.top+n.height+parseInt(arrow.height/2);a.left=n.left-parseInt(l.width/2,10)}else{a.top=n.top+n.height+parseInt(arrow.height/2);a.left=n.left-parseInt(l.width/2,10)+parseInt(n.width/2,10)}$("share_email").setStyle({left:a.left+"px",top:a.top+"px"});shareEmail.move_to_visible_area();if(!r){BF_Effect.ScrollIntoView("share_email")}};this.newsletter_checkbox=function(t){if(t.id){$(t.id).toggleClassName("check-off");$(t.id).toggleClassName("check-on");var i=gtrack.findCatLabel(t.id);var r=$(t.id)[bfjs.read_attr](bfjs.gtrack_act);gtrack.track_events(i,r+"/"+($(t.id).hasClassName("check-off")?"uncheck":"check"),"(no label)")}};this.email_signup=function(){var t=[];if(shareEmail.from_email=="")return false;var i=shareEmail.from_email;$$("#newsletter_signup_form .check-box.check-on").each(function(i){var r=$(i).getAttribute("id").replace("_signup","");t.push(r)});if(!t.length){if($("email-sent-success-message"))$("email-sent-success-message").hide();if($("empty-sign-up-message"))$("empty-sign-up-message").removeClassName("hidden");return}else{if($("empty-sign-up-message"))$("empty-sign-up-message").addClassName("hidden")}$("email_signup").setAttribute("disabled","disabled");shareEmail.move_to_visible_area();new Ajax.Request("/buzzfeed/_email/",{method:"get",parameters:{email:i,category:t},onSuccess:function(t){if($("email-sent-success-message"))$("email-sent-success-message").removeClassName("hidden");if(t.responseText.match(/Email added/)){shareEmail.confirm_message("Great! You'll get your first email soon.")}else{shareEmail.fail_message("Sorry! We weren't able to sign you up.")}$("email_signup").removeAttribute("disabled");shareEmail.move_to_visible_area()},onFailure:function(t){if(BF_STATIC.bf_env=="dev"&&t.responseText){shareEmail.fail_message(t.responseText)}else{shareEmail.fail_message("Sorry! We weren't able to sign you up.")}$("email_signup").removeAttribute("disabled");shareEmail.move_to_visible_area()}})};this.submit=function(t){if(t.vertical){shareEmail.vertical=t.vertical}if(shareEmail.validate()){$("share_email_submit").setAttribute("disabled","disabled");shareEmail.move_to_visible_area();var i={};i.bf=$F("bf").strip();i.b2=$F("b2").strip();i.note=$F("note").strip();i.bid=$F("bid");i.sub_buzz_id=$F("sub_buzz_id");if($("hash_tag")){i.hash_tag=$F("hash_tag")}if(typeof BF_STATIC.pound_enabled!="undefined"&&BF_STATIC.pound_enabled&&!BF_STATIC.mobile_app){i.tracking_url=pound.urls.unescaped.queryStringOnly()}(new BF_Request).request("/buzzfeed/share_email",{method:"post",parameters:i,onSuccess:function(t){$("share_email_submit").removeAttribute("disabled");shareEmail.share_submit_success(t);shareEmail.move_to_visible_area()},onFailure:function(t){$("share_email_submit").removeAttribute("disabled");shareEmail.fail(t);shareEmail.move_to_visible_area()},onCatcha:function(t){$("share_email_submit").removeAttribute("disabled");$("share_email_message").className="message error";$("share_email_message").innerHTML="Please enter the correct Cat-cha answer.";$("share_email_message").show();shareEmail.move_to_visible_area()}});(new BF_Targetting_Pixel).add("email");gtrack.trackShares(22,"numSharesEmail");var r=gtrack.findCatLabel($("share_email_submit"));gtrack.track_events(r?r:"","share/email/send","")}};this.share_submit_success=function(t){$("share_email_submit").disabled=false;var i=JSON.parse(t.responseText);i.sent=i.sent==true||i.sent=="true";if(i&&i.sent&&i.sent==true){if(tracker){tracker.add({type:tracker.types.SHARE_EMAIL});tracker.run()}if($("bf"))$("bf").value="";if($("b2"))$("b2").value="";if($("note"))$("note").value="";if($("sub_buzz_id"))$("sub_buzz_id").value="";if(i.from_email){if($("newsletter_signup_form"))$("newsletter_signup_form").addClassName("share-email-form");shareEmail.from_email=i.from_email;if($("newsletter_signup_form"))$("newsletter_signup_form").show();if($("empty-sign-up-message"))$("empty-sign-up-message").addClassName("hidden");if($("email-sent-success-message"))$("email-sent-success-message").show();if($("share_email_form"))$("share_email_form").hide()}else{BF_Effect.FadeOut("share_email",50)}shareEmail.move_to_visible_area()}else{shareEmail.fail(t)}};this.fail=function(t){try{var i=JSON.parse(t.responseText);if(i&&i.error&&i.message&&(i.error=="blacklist"||i.error=="spam")){shareEmail.fail_message(i.message)}}catch(e){console.log(e)}};this.fail_message=function(t){$("share-email-error-text").update(t);console.log("share email failure: "+t);$("share_email_submit").removeAttribute("disabled");$("share_email_form").hide();$("newsletter_signup_form").hide();$("share-email-error").show();shareEmail.move_to_visible_area()};this.confirm_message=function(t){$("share-email-confirm_text").update(t);console.log("share email confirm: "+t);$("share_email_submit").removeAttribute("disabled");$("share_email_form").hide();$("newsletter_signup_form").hide();$("share-email-error").hide();$("share-email-confirm").show();shareEmail.move_to_visible_area()};this.validate=function(){var t=true;$("share_email_message").hide();if($F("bf").strip()==""||$F("b2").strip()==""){$("share_email_message").className="message error";$("share_email_message").innerHTML=shareEmail.ERR_MESS;$("share_email_message").show();t=false}shareEmail.move_to_visible_area();return t};this.draw_catcha=function(){if(BFW_Util.getCookie("catcha-email_a_friend")){universal_dom.get_bucket_elements("catcha-email_a_friend").each(function(t){t.show();bf_catcha.set_image_and_question({service:"email_a_friend",image_element:t.getElementsByTagName("IMG")[0],question_element:t.getElementsByTagName("SPAN")[0]})})}}};shareEmail=new BF_ShareEmail;BuzzLoader.register(function(){shareEmail.init()},1);var BF_HashTrack=function(){this.TYPE_FN={turn:function(t){hashtrack.ping(t)},google:function(t){hashtrack.google(t)}};this.google_regex=new RegExp("/([^/]*)/([^/]*)(?:#|\\?.*fb_ref=)(H[^0-9]+)([0-9]+)??$","i");this.redir_regex=new RegExp("/ht/([^/]*)/([^/]*)/(H[^0-9]+)([0-9]+)??$","i");this.primary_regex=new RegExp("/([^/]*)/([^/]*)(?:#|\\?.*fb_ref=)(H[^0-9]+)1??$","i");this.hashtrack2_regex=new RegExp("/h2/([a-z0-9]+)/([^/]+)/([^/]+)","i");this.tracked_params=false;this.init=function(){this.oldschool_hashtrack=window.location.href.match(hashtrack.hashtrack2_regex)?false:true;var t=hashtrack.hash_tag(window.location.href);if(t){t=t.toUpperCase();var i=unescape(bfjs.read_cookie("HT_PRIMARY"));var r=2;if(i&&i.split(",").length>3){r=hashtrack._process_cookie(i,t)}else if(hashtrack.redir_regex.test(document.referrer)||hashtrack.primary_regex.test(window.location.href)){r=1;hashtrack._process_without_cookie()}if(r==0)return;if(t&&!("hash_track"in window)){var a=window.location.href.match(hashtrack.google_regex);if(a&&a.length==5){hashtrack.setup_google({user:a[1],uri:a[2],code:a[3].toUpperCase(),number:r})}}if(t&&!("hash_track"in window)){var s=window.location.href.match(hashtrack.hashtrack2_regex);if(s&&s.length==4){hashtrack.setup_google({user:s[2],uri:s[3],code:s[1].toUpperCase(),number:r})}}if(this.oldschool_hashtrack)t=t.replace(/\d$/,r);else t+=r;if(!bfjs.isMobile())(new BF_Targetting_Pixel).hashtrack_pixel(window.location.toString(),r)}if(t&&typeof hash_track!="undefined"&&typeof hash_track[t]!="undefined"){var o=hashtrack.TYPE_FN[hash_track[t].type||"turn"];if(typeof o!="undefined"){var n=hash_track[t].conversion;o(n.id);if(!t.toUpperCase().match(/^H/))t="H"+t;hashtrack.track(t);hashtrack.tracked_hash_tag=t;if(this.oldschool_hashtrack){bfjs.onPageLoad(function(){try{hashtrack.do_rewrites(t.replace(/1$/,2))}catch(e){console.error(e)}})}}}else{if(this.oldschool_hashtrack)bfjs.onPageLoad(this.fixup_share_buttons)}};this._process_without_cookie=function(){var t=hashtrack.google_regex.exec(document.location.href);var i={user:t[1],uri:t[2],code:t[3].toUpperCase()};if(i.code.match(/^H.*/)){window["IS_HASH_WIDGET_CLICK"]=true}};this._process_cookie=function(t,i){var r=t.split(",");var a=r.shift();var s=r.shift();var o=r.shift();var n=new RegExp(".*/"+s+"/"+o+".*");var l=r.shift();var u=r.join(",");var _=2;var f=this.oldschool_hashtrack?"2":"";if(l&&n.exec(document.location.href)&&l+f==i){if(a=="UNCOUNTED"){_=1}window["IS_HASH_WIDGET_CLICK"]=true;if(u){window["HASH_REFER"]=u}bfjs.write_cookie("HT_PRIMARY",["COUNTED",s,o,l,u].join(","),600)}if(_==2){window["IS_HASH_WIDGET_CLICK"]=false}return _};this.setup_google=function(t){var i=t.code+t.number;var r=["_ga","hashtrack",t.user,t.uri,t.code,t.number];hash_track={};hash_track[i]={type:"google",conversion:{id:"/"+r.join("/")}}};this.hash_tag=function(t){return hashtrack.parse_hash_tag(t)};this.parse_hash_tag=function(t){var i=undefined;if(t.indexOf("/h2/")){var r=t.match("/h2/([^/]+)");if(r&&r.length>0)i=r[1]}if(!i&&t.indexOf("#")+1>0){var r=t.substring(t.indexOf("#")+1);if(r.length>0)i=r}if(!i&&t.indexOf("?")>-1){var a=bfjs.isMobile()?hashtrack._params_unserialize(t):t.toQueryParams();if(a["fb_ref"]){i=a["fb_ref"]}}if(!!i&&i.indexOf("?")>-1){i=i.substr(0,i.indexOf("?"))}return i};this.regex=new RegExp("(/[^/]+/[^/]+$)");this.do_rewrites=function(t,i){var r=window.location.href,a=!!i?i.getElementsByTagName("fb:like"):document.getElementsByTagName("fb:like");if(a.length==0)a=!!i?i.getElementsByTagName("like"):document.getElementsByTagName("like");for(var s=0;s<a.length;s++){a[s].setAttribute("ref",t);hashtrack._swap_node(a[s])}var o=!!i?i.getElementsByTagName("A"):document.getElementsByTagName("A");for(var s=0;s<o.length;s++){if(o[s].className.match(/twitter-share-button/)){var r=o[s].getAttribute("data-url");if(!r||r=="")r=window.location.href;o[s].setAttribute("data-url",r+"#"+t);o[s].setAttribute("data-counturl",r);hashtrack._swap_node(o[s])}}var n=!!i?i.getElementsByTagName("IFRAME"):document.body.getElementsByTagName("IFRAME");for(var s=0;s<n.length;s++){if(!!n[s].getAttribute("bf_src")){var r=hashtrack._get_hashtrack_share_url(n[s],t);hashtrack._swap_node(n[s],"src",r)}}var r=window.location.href,a=!!i?i.getElementsByTagName("g:plusone"):document.getElementsByTagName("g:plusone");if(a.length==0)a=!!i?i.getElementsByTagName("plusone"):document.getElementsByTagName("plusone");for(var s=0;s<a.length;s++){a[s].setAttribute("href",hashtrack._add_hashtrack_to_url(a[s].getAttribute("href"),t));hashtrack._swap_node(a[s])}if($("share_email_form")){var l=new Element("input",{type:"hidden",value:t,name:"hash_tag",id:"hash_tag"});$("share_email_form").appendChild(l)}};this._swap_node=function(t,i,r){var a=t.cloneNode(true);if(r)a.setAttribute(i,r);t.parentNode.replaceChild(a,t)};this._params_unserialize=function(t){var i={},r=t.replace(/^\?/,"").split("&"),a=r.length,s=0,o;for(;s<a;s++){if(!r[s]){continue}o=r[s].split("=");i[o[0]]=o[1]}return i},this._get_hashtrack_share_url=function(t,i){var r=t.getAttribute("bf_src");var a=r.indexOf("?")+1;var s=r.substring(a);var o=bfjs.isMobile()?hashtrack._params_unserialize(s):s.toQueryParams();if(typeof o["url"]!="undefined"){o["url"]=hashtrack._add_hashtrack_to_url(o["url"],i);r=r.replace(s,$H(o).toQueryString())}return r};this._add_hashtrack_to_url=function(t,i){var r=new RegExp("(/[^/]+/[^/]+$)");var a=t.match(r);t=t.replace(r,"/ht"+a[0]+"/"+i);return t};this.fixup_share_buttons=function(t){var i=!!t&&typeof t=="object"?t.getElementsByTagName("fb:like"):document.getElementsByTagName("fb:like");for(var r=0;r<i.length;r++){var a=document.createElement("fb:like");var s=i[r].attributes;for(var o=0;o<s.length;o++){a.setAttribute(s[o].name,s[o].value)}i[r].parentNode.replaceChild(a,i[r])}var n=!!t&&typeof t=="object"?t.getElementsByTagName("IFRAME"):document.getElementsByTagName("IFRAME");for(var r=0;r<n.length;r++){if(!!n[r].getAttribute("bf_src")){var l=n[r].cloneNode(true);l.setAttribute("src",n[r].getAttribute("bf_src"));n[r].parentNode.replaceChild(l,n[r])}}};this.ping=function(t){var i="&";if(t.indexOf("?")==-1)i="?";i+="rnd="+(new Date).getTime();(new Image).src=t+i};this.track=function(t){var i=document.createElement("img");var r,a;if(bfjs.isMobile()){r=$("#buzz")[bfjs.read_attr]("data-buzz-id");a=$("#buzz")[bfjs.read_attr]("data-user-id")}else{r=$$("head meta[property=bf:buzzid]");a=$$("head meta[property=bf:userid]");if(r)r=r.first().getAttribute("content");if(a)a=a.first().getAttribute("content")}if(r&&a){try{var s={buzzid:r,userid:a,hp:t,referrer:typeof window["HASH_REFER"]!="undefined"?window["HASH_REFER"]:document.referrer,z:(new Date).getTime()};hashtrack.tracked_params=s;(new Image).src="https://"+Cloud.servers[Math.floor(Math.random()*Cloud.servers.length)]+"/hp.gif?"+(bfjs.isMobile()?$.param(s):Object.toQueryString(s));if(Cloud.staging.sample>0&&Math.random()<=Cloud.staging.sample){(new Image).src="https://"+Cloud.staging.server+"/hp.gif?"+(bfjs.isMobile()?$.param(s):Object.toQueryString(s))}}catch(e){console.error(e)}}};this.google=function(t,i){return}};var hashtrack=new BF_HashTrack;(function(t){if(t.getGlobal("BF_ANNOUNCEMENT"))return;var $=t.getGlobal("$");var i=t.getGlobal("gtrack");var r={announcement:false,cookie_name:"bf_announce",set:function(t,a,s){if(typeof s=="undefined")s={};if(!s.close)s.close=false;r.announcement={id:t,text:a,close:close?true:false};if(r._get_cookie(r.cookie_name)!=r.announcement.id){document.write('<div id="bar_announcement"><div id="bar_announcement_area" class="c">'+(s.close?'<a id="announcement_close" class="close" href="javascript:;">'+s.close.text+"</a>":"")+"<p>"+a+"</p></div></div>");if(s.close){$("announcement_close").observe("click",function(e){if(s.close.handler){try{s.close.handler(e)}catch(e){}}else{}return false})}if($$(".react")){$$(".react").each(function(t,i){t.observe("click",function(e){var t=e.target.getAttribute("rel:reaction");if(typeof t!="undefined"){r.react(t)}})})}if($("feedback_email")){$("feedback_email").observe("click",function(e){i.track_events(r.announcement.id+":announcement_bar","feedback/email","")})}}},react:function(t){i.track_events(r.announcement.id+":announcement_bar","feedback/"+t,"");$("announcement_bar_react").hide();$("announcement_bar_thanks").show()},close:function(t){var i=r.announcement.expires;if(!i)i=2592e6;r._set_cookie(r.cookie_name,r.announcement.id);$("bar_announcement").hide()},_get_cookie:function(t){if(r._has_cookie(t)){var i=document.cookie.match("(^|;) ?"+t+"=([^;]*)(;|$)");return unescape(i[2])}else{return false}},_has_cookie:function(t,i){var r=document.cookie.match("(^|;) ?"+t+"=([^;]*)(;|$)");if(i&&typeof i=="string")i=RegExp(RegExp.escape(i));return r?i&&i!=""?unescape(r[2]).match(i):r[2]!=this.cookies_cancel:false},_set_cookie:function(t,i,e,r){var a=31536e6,s="",o="";if(e||e==0)a=parseInt(e);if(a!=0){var n=new Date;n.setTime(n.getTime()+a);s="; expires="+n.toGMTString()}o=escape(t)+"="+escape(i)+s+"; path=/; domain=."+(r?escape(r):"buzzfeed.com");document.cookie=o}};t.setGlobal("BF_ANNOUNCEMENT",r)})(bfjs);var BF_Quiz=function(){this.quizes={};this.answerResponse="#{a} is the correct answer.";this.pollHost=BF_STATIC.mango_url;this.pollUrl=this.pollHost+"/polls/service/";this.cookiePrefix="poll_result_sent_";this.messages={generic:{tally:"You got #{x} out of #{y} right!",fb:"I got #{score} out of #{total}! How do you measure up?",tw:"I got #{score} out of #{total} on #{title}!",pin:"I got #{score} out of #{total} on #{title}!",tumblr:"I got #{score} out of #{total} on #{title}!",email_subject:"#{title}",email_body:"I got #{score} out of #{total}! \n\n #{link}",percentile:"You did better than <b>percentile%</b> of those who took this quiz!"},personality:{fb:local.t("I got #{result}! #{title}"),tw:local.t("I got #{result}! #{title}"),pin:local.t("I got #{result}! #{title}"),tumblr:local.t("I got #{result}! #{title}"),email_body:local.t("I got #{result}!\n\n#{link}")},checklist:{custom_share:"I got #{result}!",tally:local.t("You #{result_verb} #{checked} out of #{total} #{result_subject}"),fb:local.t("#{share_text} #{title}"),tw:local.t("#{share_text} #{title}"),pin:local.t("#{share_text} #{title}"),tumblr:local.t("#{share_text} #{title}"),email_body:local.t("#{share_text} \n\n #{link}"),default_text:local.t("I #{result_verb} #{checked} out of #{total} #{result_subject}")},bff_create:{fb_title:"How well do you know #{bff_quiz_creator_name}?",fb_description:"I challenge you to find out how well you really know me!",tw:"How well do you know #{bff_quiz_creator_name}?",pin:"How well do you know #{bff_quiz_creator_name}?",email_subject:"How well do you know #{bff_quiz_creator_name}?",email_body:"I challenge you to find out how well you really know me! \n\n #{link}"},bff_take:{fb_title:"I got #{score} out of #{total}!",fb_description:"How well do you know #{bff_quiz_creator_name}?",tw:"I got #{score} out of #{total}! How well do you know #{bff_quiz_creator_name}?",pin:"I got #{score} out of #{total}! How well do you know #{bff_quiz_creator_name}?",email_subject:"How well do you know #{bff_quiz_creator_name}?",email_body:"I got #{score} out of #{total}! \n\n #{link}"},3397410:{fb_title:"I Got: #{result}! #{title}",fb_description:"#{outcome} - that’s why I’m doing Mute A Mate for Cancer Research UK! "+"I’ve donated £3 by texting MUTE to 70200 and I promise #{fb_promise} for at least a week. "+"Take the quiz to find out what your sin is, donate and pass it on!"+" <b>Text costs £3 plus 1 standard rate text. CRUK receives £2.93. UK mobiles 16+ only. "+"T&Cs @ cruk.org/text. Queries? 0300 1231861</b>",tw:"I Got #{result}! #{title} Let's #MuteAMate for Cancer Research UK! ",email_subject:"Quiz: #{title}",email_body:"I Got: #{result}! #{title}\n\n#{link}\n\n#{outcome} – "+"that’s why I’m doing Mute A Mate for Cancer Research UK! "+"I’ve donated £3 by texting MUTE to 70200 and I promise #{email_promise} for at least a week. "+"Take the quiz to find out what your sin is, donate and pass it on!"+"\nText costs £3 plus 1 standard rate text. CRUK receives £2.93. UK mobiles 16+ only. T&Cs @ cruk.org/text. Queries? 0300 1231861"},poll:{tally:local.t("You voted #{vote} #{poll_question}"),fb:local.t('I voted #{vote}! "#{poll_question}"'),tw:local.t('I voted #{vote}! "#{poll_question}"'),email_body:local.t('I voted #{vote} "#{poll_question}" \n\n #{link}')},poll_complete:{tally:"#{poll_question}",fb:"#{poll_question}",tw:"#{poll_question}",email_body:"#{poll_question} \n\n #{link}"},bf_26767_durex:{name:"#{bff_quiz_creator_name}?",tally:"You did #{compare} #{bff_quiz_creator_name}. ",fb_title:"Do you know more about sex than #{bff_quiz_creator_name}?",fb_description:"I challenge you to find it out!",tw:"Do you know more about sex than #{bff_quiz_creator_name}?",pin:"Do you know more about sex than #{bff_quiz_creator_name}?",email_subject:"Do you know more about sex than #{bff_quiz_creator_name}?",email_body:"I challenge you to find it out! \n\n #{link}"}};this.init=function(){var t=$(document.body)[bfjs.selector]("#buzz_sub_buzz .quiz");if(BF_STATIC.mobile_app){bf_quiz.user={p_editor_admin:"false"}}else{bf_quiz.user=(new BF_User).getUserInfo()}bfjs.universal_each(t,function(t,i){var r=$(t)[bfjs.read_attr]("rel:quiz_type");var a=$(t)[bfjs.read_attr]("rel:id");var s=$(t)[bfjs.read_attr]("rel:swap")=="1"?true:false;var o=$(t)[bfjs.selector](".quiz_question");var n=r=="single question"?".quiz_reveal":".quiz_result";var l=$(t)[bfjs.selector](n);var u=$(t)[bfjs.read_attr]("rel:question_count");var _=$(t)[bfjs.selector](".quiz_result_area").first();bf_quiz.quizes[i]={};bf_quiz.quizes[i]["id"]=a;bf_quiz.quizes[i]["type"]=r;bf_quiz.quizes[i]["swap"]=s;bf_quiz.quizes[i]["el"]=$(t);bf_quiz.quizes[i]["el_percentile"]=$(t)[bfjs.selector](".js-quiz-percentile").first();bf_quiz.quizes[i]["questions"]={};bf_quiz.quizes[i]["results"]={};bf_quiz.quizes[i]["question_count"]=u;bf_quiz.quizes[i]["quiz_result_area_el"]=_;bf_quiz.quizes[i]["completed"]=false;bf_quiz.quizes[i]["result_verb"]=$(t)[bfjs.read_attr]("rel:result_verb");bf_quiz.quizes[i]["show_answer"]=$(t)[bfjs.read_attr]("rel:show_answer");bf_quiz.quizes[i]["result_subject"]=$(t)[bfjs.read_attr]("rel:result_subject");bf_quiz.quizes[i]["pound_no_track"]=false;bf_quiz.quizes[i]["answer_positions"]=[];if(bf_quiz.isChecklist(bf_quiz.quizes[i]["type"])){bf_quiz.quizes[i].el[bfjs.selector](".show_results").first()[bfjs.observer]("click",function(e){$(e.target)[bfjs.up](".show_results_container").hide();bf_quiz.show_results(bf_quiz.quizes[i]);bf_quiz.quiz_shares(bf_quiz.quizes[i]);bf_quiz.quiz_complete(bf_quiz.quizes[i]);bfjs.universal_each(bf_quiz.quizes[i].questions[0].answers,function(t,i){if($(t)[bfjs.has_class]("selected")){return}bfjs.toggleClass(t,"deactivated",true)})})}bfjs.universal_each(o,function(t,r){var a=$(t)[bfjs.read_attr]("rel:id");var s=$(t)[bfjs.selector](".quiz_answer.quiz_answer_el");var o=$(t)[bfjs.selector](".quiz_reveal");var n=$(t)[bfjs.read_attr]("rel:question_type");var l=bf_quiz.quizes[i]["questions"];var u;l[r]={};l[r]["id"]=a;l[r]["el"]=$(t);l[r]["answers"]=s;l[r]["freeform_answers"]=[];l[r]["freeform_answers_ugly"]=[];l[r]["image"]=$(t)[bfjs.selector](".quiz_img").first();l[r]["reveal"]=o;l[r]["type"]=n;l[r]["response"]=null;l[r]["correct"]=null;l[r]["personality_index"]=null;u=$(t)[bfjs.selector](".quiz_un_reveal");if(n=="freeform"){var _={quizIndex:i,questionIndex:r};l[r]["freeform_input"]=$(t)[bfjs.selector](".js-freeform--input")[0];l[r]["freeform_submit"]=$(t)[bfjs.selector](".js-freeform--submit")[0];l[r]["freeform_giveUp"]=$(t)[bfjs.selector](".js-freeform--give-up")[0];$(l[r]["freeform_submit"])[bfjs.observer]("click",function(e){bf_quiz.freeformSubmit(_)});$(l[r]["freeform_input"])[bfjs.observer]("keyup",function(e){if(e.keyCode==13){bf_quiz.freeformSubmit(_)}});$(l[r]["freeform_giveUp"])[bfjs.observer]("click",function(e){bf_quiz.freeformSubmit(bfjs.mergeOptions(_,{giveUp:true}))})}if(u.length>0){u.first()[bfjs.observer]("click",function(e){var t=$(l[r]["image"])[bfjs.read_attr]("rel:question_src");var i=$(l[r]["image"])[bfjs.read_attr]("rel:reveal_src");var a=$(l[r]["image"])[bfjs.read_attr]("src");var s=$(l[r]["image"])[bfjs.read_attr]("rel:attr");var o=$(l[r]["image"])[bfjs.read_attr]("rel:reveal_attr");var n=$(l[r]["image"])[bfjs.up]()[bfjs.selector](".buzz_attribution").first();var u="";if(i&&a==i){$(l[r]["image"])[bfjs.write_attr]("src",t);if(s)u=s;$(e.target)[bfjs.update_html]("Show new image")}else if(i){if(o)u=o;$(l[r]["image"])[bfjs.write_attr]("src",i);$(e.target)[bfjs.update_html]("Show original image")}if(n)n[bfjs.update_html](u)})}bfjs.universal_each(s,function(t,a){var s=$(t),o=$(t)[bfjs.read_attr]("rel:text_answer");if(l[r]["type"]=="freeform"){l[r]["freeform_answers"].push(o);l[r]["freeform_answers_ugly"].push(bf_quiz.freeformUglyString(o))}s[bfjs.observer]("mouseover",function(e){var a=e||window.event;if(!e.relatedTarget&&e.fromElement){e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement}if(e.relatedTarget&&$(e.relatedTarget)[bfjs.up](".quiz_answer")==t||t===l[r].response)return;if(t===l[r].response||bf_quiz.isChecklist(bf_quiz.quizes[i].type)&&s[bfjs.has_class]("selected"))return;bf_quiz.style(0,l[r],t)});s[bfjs.observer]("mouseout",function(e){var a=e||window.event;if(!e.target)e.target=e.srcElement||document;if(!e.relatedTarget&&e.fromElement){e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement}if(bf_quiz.isChecklist(bf_quiz.quizes[i].type)&&s[bfjs.has_class]("selected")){return}if(e.relatedTarget&&$(e.relatedTarget)[bfjs.up](".quiz_answer")!=t&&(e.target==t||$(e.target)[bfjs.up](".quiz_answer")==t)){bf_quiz.style(1,l[r],t)}});s[bfjs.observer]("click",function(e){if(e.target.nodeName.toLowerCase()=="a"&&$(e.target)[bfjs.up]()[bfjs.has_class]("sub_buzz_source_via")){return true}if(bf_quiz.isChecklist(bf_quiz.quizes[i].type)){return bf_quiz.toggleSelection(i,r,a)}bf_quiz.answered(i,r,a);if(bf_quiz.quizes[i]["type"]!=="bff_create")bf_quiz.submit_quiz(bf_quiz.quizes[i])})})});bfjs.universal_each(l,function(t,r){var a=$(t)[bfjs.read_attr]("rel:range_start");var s=$(t)[bfjs.read_attr]("rel:range_end");var o=bf_quiz.quizes[i]["results"];var n=$(t)[bfjs.read_attr]("rel:id");var l=$(t)[bfjs.read_attr]("rel:name");o[r]={};o[r]["id"]=n;o[r]["el"]=$(t);o[r]["range_start"]=a;o[r]["range_end"]=s;o[r]["name"]=l;o[r]["imageEl"]=$(t)[bfjs.selector](".result_img").length?$(t)[bfjs.selector](".result_img")[0]:false});if(bf_quiz.quizes[i].type=="standard"||bf_quiz.quizes[i].type=="percentage"){bf_quiz.getSavedResults({quiz_i:i})}if(bf_quiz.quizes[i].type=="poll"){subbuzz_el=bfjs.getFirstEl($(bf_quiz.quizes[i].el)[bfjs.up](".buzz_superlist_item_quiz"));bf_quiz.quizes[i].close_poll=bf_quiz.quizes[i].el[bfjs.read_attr]("rel:close_poll")==1?true:false;bf_quiz.quizes[i].hide_results=bf_quiz.quizes[i].el[bfjs.read_attr]("rel:hide_results")==1?true:false;var f;if(subbuzz_el){f=subbuzz_el.id.split("_")[2]}if(f){if(bf_quiz.quizes[i].close_poll||bf_quiz.already_voted(f)){bf_quiz.quizes[i].voted=1;if(!bf_quiz.quizes[i].hide_results){bf_quiz.get_poll_agregates({poll_id:f,source:bf_quiz.get_poll_source()},bf_quiz.quizes[i])}else{bf_quiz.show_poll_results(bf_quiz.quizes[i])}bf_quiz.show_results(bf_quiz.quizes[i]);bf_quiz.quiz_shares(bf_quiz.quizes[i],bf_quiz.quizes[i].voted)}if(bf_quiz.quizes[i].hide_results&&!bf_quiz.quizes[i].voted){var c=$(bf_quiz.quizes[i].el)[bfjs.selector](".quiz_question");if(c.length>0){c.first()[bfjs.remove_class]("hidden")}}if(bf_quiz.user.p_editor_admin=="true"||!bf_quiz.quizes[i].close_poll){var d=$(bf_quiz.quizes[i].el)[bfjs.selector](".poll_view_results");if(d.length>0){if(bf_quiz.user.p_editor_admin=="true"){if(bf_quiz.quizes[i].hide_results&&!bf_quiz.quizes[i].voted){d.first()[bfjs.remove_class]("hidden")}if(bf_quiz.quizes[i].hide_results&&(bf_quiz.quizes[i].close_poll||bf_quiz.quizes[i].voted)){d.first()[bfjs.remove_class]("hidden")}}d.first()[bfjs.observer]("click",function(e){bf_quiz.get_poll_agregates({poll_id:f,source:bf_quiz.get_poll_source()},bf_quiz.quizes[i]);bf_quiz.toggle_preview_results(bf_quiz.quizes[i],true);if(bf_quiz.user.p_editor_admin=="true"&&bf_quiz.quizes[i].hide_results){if(bf_quiz.quizes[i].el[bfjs.has_class]("complete")){bf_quiz.quizes[i].el[bfjs.remove_class]("preview");d.first()[bfjs.add_class]("hidden")}}})}}}if(!bf_quiz.quizes[i].close_poll&&!bf_quiz.quizes[i].voted){var b=$(bf_quiz.quizes[i].el)[bfjs.selector](".go_back_and_vote");if(b.length>0){if(bf_quiz.user.p_editor_admin=="true"&&bf_quiz.quizes[i].hide_results){b.first()[bfjs.remove_class]("hidden")}b.first()[bfjs.observer]("click",function(e){bf_quiz.toggle_preview_results(bf_quiz.quizes[i],false)})}}}if(bf_quiz.quizes[i].type=="bff_create"||bf_quiz.quizes[i].type=="bf_26767_durex"){var h=bf_quiz.bff_quiz_retrieve_info(bf_quiz.quizes[i],t);if(h){if(bfjs.isMobile())$.extend(bf_quiz.quizes[i],h);else Object.extend(bf_quiz.quizes[i],h);bf_quiz.bff_quiz_observe_form(bf_quiz.quizes[i])}}if(bf_quiz.quizes[i]["type"]==="bff_take"){var h=bf_quiz.bff_quiz_retrieve_info(bf_quiz.quizes[i],t);if(h){if(bfjs.isMobile())$.extend(bf_quiz.quizes[i],h);else Object.extend(bf_quiz.quizes[i],h);if(BF_STATIC.campaignid=="3468441"){bf_quiz.bff_quiz_observe_fb_signin(bf_quiz.quizes[i])}bf_quiz.bff_quiz_build_take_quiz(bf_quiz.quizes[i])}}if(bf_quiz.quizes[i].type=="bf_26767_durex"){bf_quiz.bff_quiz_build_take_quiz(bf_quiz.quizes[i])}if(bf_quiz.quizes[i].type=="bff_create"&&BF_STATIC.campaignid!="3468332"){bf_quiz.newBffSetup(bf_quiz.quizes[i])}})};this.getSavedResults=function(t){var i="/polls/service/aggregate/trivia_quiz/get",r=bf_quiz.quizes[t.quiz_i],a=r.id,s=bf_quiz.pollHost+i+"?poll_id="+a;bfjs.loadJSONP(s,function(i){bf_quiz.storeSavedResults({response:i,quiz_i:t.quiz_i})})};this.storeSavedResults=function(t){var i=t.response;if(i.success==1){if(i.data&&i.data.results){bf_quiz.quizes[t.quiz_i]["past_results"]=i.data.results}}};this.displayPercentile=function(t){var i=t.score,r=t.quiz,a=r.past_results,s=0,o=0,n=0,l=0,u="";if(i!=0){for(var _ in a){s+=a[_];if(i==_||i>_){o+=a[_]}}l=o/s*100;l=Math.max(0,Math.min(100,Math.round(l)))}if(!isNaN(l)){u=bf_quiz.get_message("generic","percentile",{percentile:l});$(r.el_percentile)[bfjs.update_html](u)}};this.freeformSubmit=function(t){var i=bf_quiz.quizes[t.quizIndex],r=i.questions[t.questionIndex],a=r.el,s=r["freeform_submit"],o=r["freeform_input"],n=r["freeform_giveUp"],l=o.value;
if(r.correct!=null){return false}if(t.giveUp){$(n)[bfjs.add_class]("hidden");$(s)[bfjs.add_class]("hidden");$(o)[bfjs.write_attr]("disabled","disabled");$(a)[bfjs.add_class]("wrong");r.correct=false;if(i.show_answer=="1")bf_quiz.show_answers(r,i);bf_quiz.submit_quiz(i);o.value="";this.freeformShowAnswer({inputField:o,answer:r.freeform_answers[0]});bf_quiz.gaTrack("[ttp]","quiz:freeform","give-up")}else if(r.freeform_answers_ugly.indexOf(bf_quiz.freeformUglyString(l))!==-1){$(o.parentNode)[bfjs.remove_class]("has-errors");$(s)[bfjs.add_class]("hidden");$(o)[bfjs.add_class]("correct_answer");$(n)[bfjs.add_class]("hidden");$(o)[bfjs.write_attr]("disabled","disabled");r.correct=true;if(i.show_answer=="1")bf_quiz.show_answers(r,i);bf_quiz.submit_quiz(i);bf_quiz.gaTrack("[ttp]","quiz:freeform","correct")}else{if(!$(o.parentNode)[bfjs.has_class]("has-errors")){$(o.parentNode)[bfjs.add_class]("has-errors");$(n)[bfjs.add_class]("animated slideInDown")}if($(s)[bfjs.has_class]("animated")){$(s)[bfjs.remove_class]("animated");$(s)[bfjs.remove_class]("shake")}setTimeout(function(){$(s)[bfjs.add_class]("animated shake")},100);bf_quiz.gaTrack("[ttp]","quiz:freeform","wrong")}};this.freeformUglyString=function(t){var i=t.replace(/"/g,"").replace(/“/g,"").replace(/”/g,"").replace(/’/g,"").replace(/'/g,"").replace(/ /g,"").toLowerCase();return i};this.freeformShowAnswer=function(t){answer=t.answer,field=t.inputField;if(field.value.length<answer.length){field.value=answer.substring(0,field.value.length+1);setTimeout(function(){bf_quiz.freeformShowAnswer(t)},150)}};this.style=function(t,i,r){var a=$(i.el)[bfjs.up](".quiz")[bfjs.read_attr]("rel:quiz_type");if(bf_quiz.isChecklist(a)){if(t==2){bfjs.toggleClass(r,"selected",true)}else if(t==1){bfjs.toggleClass(r,"selected")}}if((t==2||t>=4)&&i.response&&r==bfjs.getFirstEl(i.response)){bfjs.toggleClass(r,"selected",true)}if(t==0){bfjs.toggleClass(r,"deactivated")}else if(t==1){if(!bfjs.universal_compare_els($(i.response),$(r))){bfjs.toggleClass(r,"selected");bfjs.toggleClass(r,"def_answer");if((i.type=="text"||i.type=="image")&&i.correct!=null){bfjs.toggleClass(r,"deactivated",true)}else{bfjs.toggleClass(r,"deactivated")}}}else if(t==2){$(r)[bfjs.add_class]("selected");bfjs.toggleClass(r,"deactivated")}else if(t==4){$(r)[bfjs.add_class]("correct_answer");bfjs.toggleClass(r,"deactivated")}else if(t==5){$(r)[bfjs.add_class]("wrong_answer");bfjs.toggleClass(r,"deactivated",true)}};this.toggleSelection=function(t,i,r){var a=bf_quiz.quizes[t];var s=a.questions[i];var o=s.answers;var n=s.answers[r];var l=$(o[r])[bfjs.read_attr]("rel:id");var u=s.id;var _=$(n)[bfjs.has_class]("selected")?1:2;bf_quiz.style(_,s,n);if(_==2){bf_quiz.gaTrack("[ttp]:content","quiz-answer",[u,l].join("="));bfa&&bfa("track","quiz","Answer","Subbuzz","",{quizType:a.type,quizId:a.id,questionId:u,answerId:l})}};this.answered=function(t,i,r){var a=bf_quiz.quizes[t];if(a.type=="poll"&&a.close_poll)return;var s=a.questions[i];var o=s.answers;var n=$(o[r])[bfjs.read_attr]("rel:id");var l=s.id;var u=1;var _,f;a["answer_positions"][i]=r;s.response=$(o[r]);s.correct=$(s.response)[bfjs.read_attr]("rel:correct")=="1"?true:false;s.personality_index=$(s.response)[bfjs.read_attr]("rel:personality_index");bfjs.universal_each(o,function(t){u=t===bfjs.getFirstEl(s.response)?2:1;bf_quiz.style(u,s,t)});if(a.type=="single question"){bf_quiz.show_answers(s,a);bf_quiz.show_results(a)}else if(a.type=="standard"&&a.show_answer=="1"||a.type=="bff_take"||a.type=="bf_26767_durex"){bf_quiz.show_answers(s,a)}else if(a.type=="poll"){_=bfjs.getFirstEl($(bf_quiz.quizes[t].el)[bfjs.up](".buzz_superlist_item_quiz"));if(_){f=_.id.split("_")[2];this.get_poll_agregates({poll_id:f,source:this.get_poll_source()},bf_quiz.quizes[t])}}bf_quiz.gaTrack("[ttp]:content","quiz-answer",[l,n].join("="));if(a.type==="poll"){bfa&&bfa("track","quiz","Answer","Subbuzz","",{quizType:a.type,quizId:f,questionId:l,answerId:n})}else{bfa&&bfa("track","quiz","Answer","Subbuzz","",{quizType:a.type,quizId:a.id,questionId:l,answerId:n})}};this.submit_poll=function(t){if(this.already_voted(t.poll_id)||document.location.href.match("/_draft")){return}var i=this.pollUrl+t.source+"/post?poll_id="+t.poll_id+"&result_id="+t.result_id;bfjs.loadJSONP(i,function(t){return bf_quiz.submit_poll_callback(t)});this.store_voted_cookie(t.poll_id)};this.store_voted_cookie=function(t){if(isNaN(t)){return}var i=this.cookiePrefix+t;if(typeof store!=="undefined"&&store.enabled){store.set(i,1)}else{createCookie(i,1,365)}};this.already_voted=function(t){var i=this.cookiePrefix+t;if(typeof store!=="undefined"&&store.enabled){return!!store.get(i)}else{return!!readCookie(i)}};this.submit_poll_callback=function(t){};this.get_poll_source=function(){return"editorial"};this.get_poll_agregates_callback=function(t,i){var r,a,s,o,n,l,u,_,f,c,d=this;if(t&&t.error==1){o=t.message.match(/Key (.*?) not found/);if(o){t.data={poll_id:i.poll_id,source:i.source,results:{}}}else{console.debug("Poll get results error",t.message);this.show_poll_error(i.poll_obj);return false}}if(!t.callbackSuccess){this.show_poll_error(i.poll_obj);return false}if(t&&t.data){a=$(document.getElementById("superlist_"+BF_STATIC.campaignid+"_"+t.data.poll_id))[bfjs.selector](".quiz")[0];e:for(_ in this.quizes){if(!this.quizes.hasOwnProperty(_)){continue}r=this.quizes[_];if(r.type!="poll"||bfjs.getFirstEl(r.el)!=bfjs.getFirstEl(a)){continue}for(f in r.questions){if(!r.questions.hasOwnProperty(f)){continue}s=r.questions[f];n=$(s.el)[bfjs.selector](".quiz_answer.selected")[0];l=$(s.el)[bfjs.selector](".quiz_answer");u=bfjs.indexOf(n,l);for(c in s.answers){if(!s.answers.hasOwnProperty(c)||isNaN(c)){continue}if(typeof t.data.results[c]==="undefined"){t.data.results[c]=0}}break e}}if(n){this.submit_poll({source:i.source,poll_id:t.data.poll_id,result_id:u})}if(typeof t.data.results[u]!=="undefined"){t.data.results[u]++}this.show_poll_results(r);if(!r.hide_results||bf_quiz.user.p_editor_admin=="true"){setTimeout(function(){d.fill_poll_agregates(t.data,r)},1)}}};this.get_poll_agregates=function(t,i){var r=this,a={poll_id:t.poll_id,poll_obj:i,source:t.source},s=this.pollUrl+"aggregate/"+t.source+"/get/?poll_id="+t.poll_id,o;if(typeof t==="undefined"||!t.poll_id||!t.source){return}o=setTimeout(function(){r.show_poll_error(i)},10*1e3);bfjs.loadJSONP(s,function(t){clearTimeout(o);if(t.callbackSuccess){return r.get_poll_agregates_callback(t,a)}else{return r.show_poll_error(i)}},{retries:3})};this.show_poll_error=function(t){if(!t){return}var i=t.el?$(t.el):$(t);if(i[bfjs.has_class]("filled")){return}$(i[bfjs.selector](".results_spinner")[0])[bfjs.add_class]("hidden");$(i[bfjs.selector](".results_content")[0])[bfjs.add_class]("hidden");$(i[bfjs.selector](".error_content")[0])[bfjs.remove_class]("hidden");$(i[bfjs.selector](".answer_shares_poll")[0])[bfjs.add_class]("hidden")};this.show_poll_results=function(t){if(!t){return}var i=$(t.el);$(i[bfjs.selector](".results_spinner")[0])[bfjs.add_class]("hidden");$(i[bfjs.selector](".error_content")[0])[bfjs.add_class]("hidden");$(i[bfjs.selector](".results_content")[0])[bfjs.remove_class]("hidden")};this.fill_poll_agregates=function(t,i){if(!t||!i){return}var r=0,a,s,o,n;$(i.el)[bfjs.add_class]("filled");for(a in t.results){if(!t.results.hasOwnProperty(a)||isNaN(t.results[a])){continue}r+=t.results[a]}var l=[];var u=[];for(a in t.results){l[a]=t.results[a]*100/(r||1)}var _=this.getLargestRemainder(l,100);for(a in t.results){o=i.el[bfjs.selector](".poll_result")[a];if(!o){continue}n=$(o);u.push({id:a,result:t.results[a],percentage:_[a]||0,el:o})}var f;if(i.questions[0]&&i.questions[0].answers){for(a in i.questions[0].answers){if(!i.questions[0].answers.hasOwnProperty(a)||isNaN(a)){continue}o=i.questions[0].answers[a];if(!o){continue}n=$(o);if(n[bfjs.has_class]("selected")){f=a;u[a].selected=true;break}}}var c=false;var d=i.el[bfjs.selector](".poll_results");if(d.length>0){d=d[0];c=$(d)[bfjs.read_attr]("rel:reorder_results")==1?true:false}if(c){var b=u.length;for(var a=0;a<b;a++){o=i.el[bfjs.selector](".poll_result")[a];if(!o){continue}n=$(o);var h=n[bfjs.read_attr]("rel:poll_result_num")-1;u[a].id=h;u[h].el=o}u.sort(function(t,i){return i.result-t.result});var m=i.el[bfjs.selector](".results_content ol");if(m.length>0){m=m[0];for(a in u){if(!u.hasOwnProperty(a)){continue}o=u[a].el;m.appendChild(o);window.getComputedStyle(o).background}}}for(a in u){if(!u.hasOwnProperty(a)){continue}if(c&&u[a].selected)f=a;s=u[a].result;l=u[a].percentage;o=u[a].el;if(!o){continue}window.getComputedStyle(o).width;n=$(o);n[bfjs.selector](".poll_percentage")[0].innerHTML=l+"%";n[bfjs.selector](".poll_votes .num")[0].innerHTML=bfjs.formatNumber(s);if(s!==1){$(n[bfjs.selector](".poll_votes")[0])[bfjs.add_class]("plural")}$(n[bfjs.selector](".poll_bar_inner")[0])[bfjs.write_attr]("style","width:"+l+"%;")}if(f){var p=$(i.el[bfjs.selector](".poll_result")[f]);{if(p){p[bfjs.add_class]("selected");setTimeout(function(){$(p[bfjs.selector](".poll_result_wrapper")[0])[bfjs.write_attr]("style","background: white;")},1500)}}}};this.getLargestRemainder=function(t,r){var a=0;var s=[];for(i in t){if(!t.hasOwnProperty(i)){continue}var o=t[i]|0;var n=t[i]%1;a+=o;s.push({integer:o,decimal:n,originalIndex:i})}if(a>0&&a!=r){s.sort(function(t,i){return i.decimal-t.decimal});var l=r-a;var u=0;while(u<l){s[u++].integer++;a++}s.sort(function(t,i){return t.originalIndex-i.originalIndex})}var _=bfjs.map(s,function(t){return t.integer});return _};this.submit_quiz=function(t){var i,r,a,s;if(bf_quiz.quiz_complete(t)&&!t.completed){i=bf_quiz.get_completed_quiz_result(t);if(t.answer_positions.length==t.question_count){r=t.answer_positions}if(typeof i=="undefined"||typeof i.el=="undefined"){i={el:false}}if(t.type=="standard"||t.type=="percentage"||t.type=="bf_26767_durex"){var o=parseInt(bf_quiz.number_correct(t),10);var n=this.pollUrl+"trivia_quiz/post?poll_id="+t["id"]+"&result_id="+o;if(!isNaN(o)){bfjs.loadJSONP(n,function(t){return bf_quiz.submit_poll_callback(t)});if(typeof t.past_results=="object"){bf_quiz.displayPercentile({score:o,quiz:t})}}}if(bfjs.isMobile()){a=$.Event("quiz_submit");a.answer_data=t.answer_positions;a.el=i.el;$(document).trigger(a)}else{EventManager.fire("quiz_submit",r,i.el)}bf_quiz.show_results(t);if(t.type!="single question"&&!(t.type=="poll"&&t.hide_results))bf_quiz.quiz_shares(t);t.completed=true;if(bfjs.isMobile()){s=$.Event("quiz_complete");s.answer_data=t.answer_positions;s.el=i.el;$(document).trigger(s)}else{EventManager.fire("quiz_complete",r,i.el)}}};this.show_answers=function(t,i){var r=t.answers;var a=i?i.type:null;bf_quiz.disable_question(t);bfjs.universal_each(r,function(s){if(i.type=="single question"&&r.length<=1){return}if(a!="personality"&&a!=="bff_create"){if($(s)[bfjs.read_attr]("rel:correct")=="1"){bf_quiz.style(4,t,s)}else if(s===bfjs.getFirstEl(t.response)){bf_quiz.style(5,t,s)}}});if(a=="single question"||i.type=="standard"||a=="bff_take"||a=="bf_26767_durex"){bf_quiz.reveal(t,i)}};this.show_results=function(t){var i=t.swap;var r=t.questions;var a=t.results;var s=bf_quiz.get_completed_quiz_result(t);var o="";var n=s?$(s.el)[bfjs.selector](".answer_response").first():null;var l,u,_,f,c,d,b,h;for(h in r){bf_quiz.disable_question(r[h])}if($(t.quiz_result_area_el)){$(t.quiz_result_area_el).show()}if(t.type=="personality"){if(s){$(t.el)[bfjs.selector](".quiz_tally_results").first().show();$(t.el)[bfjs.selector](".quiz_tally").first().hide();$(s.el).show();if(typeof window["BF_Effect"]!="undefined")BF_Effect.ScrollIntoView($(s.el));if(s){n.hide()}o=s.id}}else if(t.type=="single question"){if(t.questions[0].answers.length>1){l=t.questions[0];u=$(l.el)[bfjs.selector](".answer_response");_=bf_quiz.correct_answer(l);f=l.correct?"Correct! ":"Wrong! ";if(u.length>0){$(u[0])[bfjs.add_class](l.correct?"correct":"wrong")[bfjs.selector](".message_text").first()[bfjs.update_html](f);o=f}else if(s){n.hide();o=s.id}}}else if(bf_quiz.isChecklist(t.type)){c=bf_quiz.get_message("checklist","tally",{"#{result_verb}":t.result_verb,"#{result_subject}":t.result_subject});c=local.t(c,{variables:{total:t.questions[0].answers.length,checked:bf_quiz.number_selected(t)}});d=$(t.el)[bfjs.selector](".quiz_tally").first();$(d)[bfjs.update_html](c);o=c;$(t.el)[bfjs.selector](".quiz_tally_results").first().show();if(s){if(s.name){d.hide()}$(s.el).show();if(typeof window["BF_Effect"]!="undefined")BF_Effect.ScrollIntoView($(s.el));n.hide()}}else if(t.type=="poll"){t.el[bfjs.add_class]("complete");if(t.hide_results&&bf_quiz.user.p_editor_admin=="true"){var m=t.el[bfjs.selector](".poll_view_results");if(m.length>0){m.first()[bfjs.write_attr]("style","display: block;")}}if(!t.voted){bf_quiz.scroll_top_poll(t)}}else if(t.type=="bff_create"){}else{c=bf_quiz.get_message("generic","tally",{"#{x}":bf_quiz.number_correct(t),"#{y}":t.question_count});d=$(t.el)[bfjs.selector](".quiz_tally").first();o=c;$(d)[bfjs.update_html](c);if(t.type=="bf_26767_durex"&&"bff_quiz_answer_key"in t){bf_quiz.durexPatchResult(t,d,s)}$(t.el)[bfjs.selector](".quiz_tally_results").first().show();if(t.type=="percentage"||t.type=="standard"){for(h in t.questions){bf_quiz.show_answers(t.questions[h],t)}}if(t.type=="bff_take"&&BF_STATIC.campaignid=="3468441"){bf_quiz.bff_quiz_show_leaderboard(t["bff_quiz_leaderboard"][1]);window.setTimeout(function(){bf_quiz.bff_quiz_animate_leaderboard(t["bff_quiz_leaderboard"][1])},200)}if(s){n.hide();$(s.el).show();if(t.type=="percentage"||t.type=="standard"){if(typeof window["BF_Effect"]!="undefined"){BF_Effect.ScrollIntoView($(s.el))}else{var p=$(s.el).offset().top;if($(window).height()>=$(s.el).height()){p-=($(window).height()-$(s.el).height())/2}window.scrollTo(0,p)}}}}if(t.type!=="poll"){bfa&&bfa("track","quiz","Complete","Subbuzz","",{quizType:t.type,quizId:t.id,result:o})}if(s&&s.imageEl){$(s.imageEl)[bfjs.write_attr]("src",$(s.imageEl)[bfjs.read_attr]("data:src"))}};this.toggle_preview_results=function(t,r){t.preview_results=r?true:false;bfa&&bfa("track","click",r?"View-Results":"Go-Back-Vote","Subbuzz","Poll");if(t.hide_results&&bf_quiz.user.p_editor_admin=="true"){bf_quiz.toggle_hidden_results(t)}if($(t.quiz_result_area_el)){if(t.preview_results){$(t.quiz_result_area_el).show()}else{$(t.quiz_result_area_el).hide()}}if(t.preview_results){t.el[bfjs.add_class]("preview")}else{t.el[bfjs.remove_class]("preview");var a=t.el[bfjs.selector](".poll_result .poll_bar_inner");for(i in a){if(!a.hasOwnProperty(i)||isNaN(i)){continue}$(a[i])[bfjs.write_attr]("style","width:0;")}}bf_quiz.scroll_top_poll(t)};this.toggle_hidden_results=function(t){var i=t.el[bfjs.selector](".poll_end_voting");if(i.length>0){if(t.preview_results){i.first().hide()}else{i.first().show()}}var r=t.el[bfjs.selector](".results_content ol");if(r.length>0){if(t.preview_results){r.first().show()}else{r.first().hide()}}};this.scroll_top_poll=function(t){el=bfjs.getFirstEl(t.el);var i=0;if(!bfjs.isMobile()&&$$(".ptools-buzzpage").length){i=40}var r=window.pageYOffset!==undefined?window.pageYOffset:document.documentElement.scrollTop;window.scrollTo(0,r+el.getBoundingClientRect().top-10-i)};this.disable_question=function(t){var i=t.answers,r;for(r in i){if(typeof i[r]!="object"||!$(i[r])){continue}$(i[r])[bfjs.stop_observing]("mouseover");$(i[r])[bfjs.stop_observing]("mouseout");$(i[r])[bfjs.stop_observing]("click");bfjs.setStyle($(i[r]),{cursor:"default"})}};this.make_fb_title=function(t){var i=t.quiz;var r=t.data;var a=t.result;if(BF_STATIC.language!=="en"&&bf_quiz.isChecklist(i.type)){if(i.result_verb==="checked"&&i.result_subject==="on this list!"){return local.t("_generic_fb_share",{variables:r})}else if(a&&a.name){return local.t("_custom_fb_share",{variables:r})}}return bf_quiz.get_message(i.type,"fb",r)};this.get_message=function(t,i,r){var a=bf_quiz.messages.generic[i],s;if(bf_quiz.messages.hasOwnProperty(t)&&bf_quiz.messages[t].hasOwnProperty(i)){a=bf_quiz.messages[t][i]}a=local.t(a);for(s in r){if(!r.hasOwnProperty(s)){continue}r[s]=typeof r[s]=="string"?r[s].replace("$","$/"):r[s];a=a.replace(s,r[s])}a=a.replace("$/","$");return a};this.get_completed_quiz_result=function(t){var i=t.results,r,a,s,o;if(t.type=="personality"){r=bf_quiz.personality(t);return i[r[0]]}else if(t.type=="bff_create"){return{el:t["bff_quiz_create_results"][0],id:t["id"],range_end:0,range_start:0}}else if(t.type=="single question"){return i[0]}else if(bf_quiz.isChecklist(t.type)){a=bf_quiz.percent_checked(t);for(s in i){o=i[s];if(a>=o.range_start&&a<=o.range_end){return o}}}else{a=bf_quiz.percent_correct(t);for(s in i){o=i[s];if(a>=o.range_start&&a<=o.range_end){return o}}}return false};this.reveal=function(t,i){var r,a,s,o,n,l;if(t.reveal){if(t.image&&t.image[bfjs.read_attr]("rel:reveal_src")){t.image[bfjs.write_attr]("rel:question_src",t.image[bfjs.read_attr]("src"));t.image[bfjs.write_attr]("src",t.image[bfjs.read_attr]("rel:reveal_src"));s=t.image[bfjs.read_attr]("rel:reveal_attr");if(s){r=t.image[bfjs.up]()[bfjs.selector](".buzz_attribution").first();if(r){a=bfjs.getFirstEl(r).innerText||bfjs.getFirstEl(r).textContent;if(a){t.image[bfjs.write_attr]("rel:attr",a.replace('"',"&quot;"))}r[bfjs.update_html](s)}}}if($(t.el)[bfjs.selector](".reveal_embed").length>0){$(t.el)[bfjs.selector](".reveal_embed").first().show();$(t.el)[bfjs.selector](".question_embed").first().hide()}bfjs.universal_each(t.reveal,function(t){t.style.display=""})}if(i.type!="single question"||i.type=="single question"&&t.answers.length>1){o=$(t.el)[bfjs.selector](".answer_response");n=bf_quiz.correct_answer(t);l=t.correct?local.t("Correct!"):local.t("Wrong!");if(o.length>0){$(o[0])[bfjs.add_class](t.correct?"correct":"wrong")[bfjs.selector](".message_text").first()[bfjs.update_html](l)}}};this.correct_answer=function(t){bfjs.universal_each(t.answers,function(t){if($(t)[bfjs.read_attr]("rel:correct")=="1"){return $(t)}});return null};this.personality=function(t){var i=0,r=0,a=[],s=[],o,n;for(var o in t.results){a[o]=0}for(o in t.questions){n=t.questions[o];a[n.personality_index]++;i++}for(o=a.length-1;o>=0;o--){if(a[o]>r){r=a[o]}}for(o=a.length-1;o>=0;o--){if(a[o]==r)s.push(o)}return s};this.percent_checked=function(t){var i=bf_quiz.number_selected(t);var r=t.questions[0].answers.length;return Math.round(i/r*100)};this.percent_correct=function(t){var i=0,r=0,a,s;for(a in t.questions){s=t.questions[a];i++;if(s.correct==true){r++}}return Math.round(r/i*100)};this.number_selected=function(t){return t.el[bfjs.selector](".quiz_answer.selected").length};this.number_correct=function(t){var i=0,r,a;for(r in t.questions){a=t.questions[r];if(a.correct==true){i++}}return i};this.quiz_complete=function(t){var i=bf_quiz.GALabel(t),r="quiz-complete",a;if(t.type=="single question"){r="quiz-answer"}if(!bf_quiz.isChecklist(t.type)){for(var a in t.questions){var s=t.questions[a];if(s.correct==null){return false}}}if(t.type=="personality"){if(bf_quiz.personality(t).length>1){r="quiz-complete-ties"}}if(t.type=="poll"){r="quiz-answer/poll"}if(bfjs.isMobile()){$(".answer_shares_buttons a").each(function(){$(this).attr("data-label",i)})}bf_quiz.gaTrack("[ttp]:content",r,i);return true};this.GALabel=function(t){var i="",r=[],a;if(t.type=="personality"||t.type=="bff_create"){a=bf_quiz.personality(t);for(var s=0;s<a.length;s++){r.push(t.results[a[s]]["id"])}i=t.id+"="+r.join(",")}else if(bf_quiz.isChecklist(t.type)){i=bf_quiz.number_selected(t)+" out "+t.questions[0].answers.length}else if(t.type=="poll"){if(!t.answer_positions.length){i=""}else{i=t.id+"="+t.questions[0].answers[t.answer_positions[0]].getAttribute("rel:id")}}else{i=bf_quiz.number_correct(t)+" out "+t.question_count}return i};this.isChecklist=function(t){var i=["checklist","image checklist"];return i.indexOf(t)>-1};this.initShareFacebook=function(t,i){if(bfjs.isMobile()){$(i.el)[bfjs.selector](".js-action-bar--sharing.position-quiz .js-action-bar__btn--facebook")[bfjs.observer]("click",function(e){e.preventDefault();var r={name:unescape(i.fb_title),description:unescape(i.fb_blurb),link:i.buzz_uri.toString(),picture:i.picture,parent_id:"share-buttons-quiz",category:"MobileBuzz:sharing-quiz",action:$(this).data("action"),label:bf_quiz.GALabel(t)};if(t["type"]==="bff_create"||t["type"]==="bff_take"){r["redirect_uri"]=(document.URL.indexOf("https://")==0?"https://":"http://")+document.domain+"/static/html/fb-redirect.html"}Share.facebook(r)})}else{sharing.buttons.facebook_share({parentNode:i.el,url:i.buzz_uri,blurb:i.fb_blurb,picture:i.picture,title:i.fb_title,gt_label:bf_quiz.GALabel(t),pound_no_track:i.pound_no_track})}};this.initShareTwitter=function(t,i){if(bfjs.isMobile()){$(i.el)[bfjs.selector](".js-action-bar--sharing.position-quiz .js-action-bar__btn--twitter")[bfjs.observer]("click",function(e){e.preventDefault();var r={text:bfjs.stripTags(i.tw_blurb),url:i.buzz_uri,via:i.tw_via,parent_id:"share-buttons-quiz",category:"MobileBuzz:sharing-quiz",action:$(this).data("action"),label:bf_quiz.GALabel(t)};Share.twitter(r)})}else{sharing.buttons.twitter({parentNode:i.el,url:i.buzz_uri,blurb:bfjs.stripTags(i.tw_blurb),hashtags:i.tw_hashtags,via:i.tw_via,gt_label:bf_quiz.GALabel(t),pound_no_track:i.pound_no_track})}};this.initShareTumblr=function(t,i){if(bfjs.isMobile()){$(i.el)[bfjs.selector](".js-action-bar--sharing.position-quiz .js-action-bar__btn--tumblr")[bfjs.observer]("click",function(e){e.preventDefault();var t={url:i.buzz_uri,name:i.tumblr_name,description:i.tumblr_description,parent_id:"share-buttons-quiz",legacy_url:document.URL.replace(/[?#].*$/g,"")};t.category="MobileBuzz:content";t.action=$(e).data("action");Share.tumblr(t)})}else{if(t.type!="poll"){sharing.buttons.tumblr({parentNode:i.el,url:i.buzz_uri,name:i.tumblr_name,description:i.tumblr_description,gt_label:bf_quiz.GALabel(t),pound_no_track:i.pound_no_track})}}};this.initSharePinterest=function(t,i){if(bfjs.isMobile()){$(i.el)[bfjs.selector](".js-action-bar--sharing.position-quiz .js-action-bar__btn--pinterest")[bfjs.observer]("click",function(e){e.preventDefault();var r={media:i.picture||$(".buzz").data("image"),description:bfjs.stripTags(i.tw_blurb),url:i.buzz_uri,parent_id:"share-buttons-quiz",category:"MobileBuzz:sharing-quiz",action:$(this).data("action"),label:bf_quiz.GALabel(t)};Share.pinterest(r)})}else{if(t.type!="poll"){sharing.buttons.pinterest({parentNode:i.el,quiz_result:true,url:i.buzz_uri,media:i.picture,description:bfjs.stripTags(i.pin_description),gt_label:bf_quiz.GALabel(t),pound_no_track:i.pound_no_track})}}};this.initShareEmail=function(t,i){if(bfjs.isMobile()){$(i.el)[bfjs.selector](".js-action-bar--sharing.position-quiz .js-action-bar__btn--email")[bfjs.observer]("click",function(e){e.preventDefault();var r={subject:bfjs.stripTags(i.email_subject),body:bfjs.stripTags(i.email_body)+"\n\nGet the BuzzFeed App: http://bzfd.it/bfmobileapps",parent_id:"share-buttons-quiz",category:"MobileBuzz:sharing-quiz",action:$(this).data("action"),label:bf_quiz.GALabel(t)};Share.email(r)})}else{sharing.buttons.email({method:"mailto",parentNode:i.el,subject:bfjs.stripTags(i.email_subject),body:bfjs.stripTags(i.email_body),gt_label:bf_quiz.GALabel(t),pound_no_track:i.pound_no_track})}};this.getShareImage=function(t){var i=bf_quiz.get_completed_quiz_result(t);var r;try{if(i&&"imageEl"in i&&t.type!="bf_26767_durex"){r=i.imageEl.src}else{if(bfjs.isMobile()){r=$(".js-action-bar__btn--pinterest").data("media").replace("_big.","_dblbig.")}else{r=$$('meta[property="og:image"]')[0].getAttribute("content")}}}catch(a){return r||""}return r||""};this.quiz_shares=function(t,i){var r,a,s,o,n;var l,u,_,f;try{if(bf_quiz.isLegacyApp()){$(t.el)[bfjs.selector](".answer_shares").hide();return false}r=bf_quiz.get_completed_quiz_result(t);a=r&&r.el?$(r.el)[bfjs.read_attr]("rel:description"):"";s={el:$(t.el)[bfjs.selector](".answer_shares .answer_shares_buttons").first(),buzz_uri:{},buzz_name:bfjs.isMobile()?$("<div/>").html(BF_STATIC.buzz_name).text():BF_UI.renderEntities(BF_STATIC.buzz_name),buzz_blurb:bfjs.isMobile()?$("<div/>").html(BF_STATIC.buzz_blurb).text():BF_UI.renderEntities(BF_STATIC.buzz_blurb),picture:bf_quiz.getShareImage(t),result_description:bfjs.isMobile()?$("<div/>").html(a).text():BF_UI.renderEntities(a),fb_title:"",fb_blurb:"",tw_blurb:"",tw_hashtags:typeof ad_tw_hashtags!="undefined"?ad_tw_hashtags:"",tw_via:$(t.el)[bfjs.selector](".quiz_tally_results").first()[bfjs.read_attr]("rel:tweet_via")||"BuzzFeed",pin_description:"",email_subject:"",email_body:"",tumblr_name:"",tumblr_description:"",pound_no_track:t["pound_no_track"]};s.buzz_uri.href=BF_STATIC.base_url+window.location.pathname;s.buzz_uri.toString=function(){return s.buzz_uri.href};if(typeof BF_STATIC.pound_enabled!="undefined"&&BF_STATIC.pound_enabled){s.buzz_uri={href:pound.urls.unescaped.queryStringOnly(),toString:pound.urls.unescaped.queryStringOnly}}o={"#{title}":s.buzz_name,"#{link}":s.buzz_uri,"#{result_verb}":t.result_verb,"#{result_subject}":t.result_subject};if(t.type=="personality"&&!bf_quiz.post_rec){o["#{result}"]=$(r.el)[bfjs.read_attr]("rel:name");s.fb_title=bf_quiz.get_message("personality","fb",o);s.fb_blurb=s.result_description?s.result_description:s.buzz_blurb;s.tw_blurb=bf_quiz.get_message("personality","tw",o);s.pin_description=bf_quiz.get_message("personality","pin",o);s.email_subject=bf_quiz.get_message("personality","email_subject",o);s.tumblr_name=bf_quiz.get_message("personality","tumblr",o);s.tumblr_description=s.result_description?s.result_description:s.buzz_blurb;if(!unescape(s.email_subject).match("Quiz:")){s.email_subject="Quiz: "+s.email_subject}s.email_body=bf_quiz.get_message("personality","email_body",o)}else if(t.type=="personality"&&bf_quiz.post_rec){o["#{result}"]=$(r.el)[bfjs.read_attr]("rel:name");s.fb_title=s.buzz_name;s.fb_blurb=s.buzz_blurb;s.tw_blurb=s.buzz_name;s.pin_description=s.buzz_name;s.email_subject=s.buzz_name;s.tumblr_name=s.buzz_name;s.tumblr_description=s.buzz_blurb;if(!unescape(s.email_subject).match("Quiz:")){s.email_subject="Quiz: "+s.email_subject}s.email_body=s.buzz_name+"  "+(s.buzz_uri.href||s.buzz_uri)}else if(bf_quiz.isChecklist(t.type)){o["#{checked}"]=bf_quiz.number_selected(t);o["#{total}"]=t.questions[0].answers.length;o["#{share_text}"]=bf_quiz.get_message("checklist","default_text",o);if(r.name){o["#{result}"]=r.name;o["#{share_text}"]=bf_quiz.get_message("checklist","custom_share",o)}s.fb_title=bf_quiz.make_fb_title({quiz:t,data:o,result:r});s.fb_blurb=s.result_description||s.buzz_blurb;s.tw_blurb=bf_quiz.get_message("checklist","tw",o);s.pin_description=bf_quiz.get_message("checklist","pin",o);s.email_subject=bf_quiz.get_message("checklist","email_subject",o);s.tumblr_name=bf_quiz.get_message("checklist","tumblr",o);s.tumblr_description=s.result_description||s.buzz_blurb;if(!unescape(s.email_subject).match("Quiz:")){s.email_subject="Quiz: "+s.email_subject}s.email_body=bf_quiz.get_message("checklist","email_body",o)}else if(t.type=="poll"){var c=i?"poll_complete":"poll";o["#{vote}"]=!i?t.el[bfjs.selector](".quiz_answer.selected .quiz_answer_text")[0].innerHTML[bfjs.trim]():"";o["#{poll_question}"]=$(t.questions[0].el)[bfjs.selector](".quiz_question_header .headline-1")[0].innerHTML[bfjs.trim]();s.fb_title=bf_quiz.get_message(c,"fb",o);s.fb_blurb=s.result_description||s.buzz_blurb;s.tw_blurb=bf_quiz.get_message(c,"tw",o);s.email_subject=bf_quiz.get_message(c,"email_subject",o);if(!unescape(s.email_subject).match("Quiz:")){s.email_subject="Quiz: "+s.email_subject}s.email_body=bf_quiz.get_message(c,"email_body",o)}else if(t.type=="bff_create"){o["#{bff_quiz_creator_name}"]=t["bff_quiz_creator_name"];o["#{link}"]=t["bff_quiz_url"];s.fb_title=bf_quiz.get_message("bff_create","fb_title",o);s.fb_blurb=bf_quiz.get_message("bff_create","fb_description",o);s.tw_blurb=bf_quiz.get_message("bff_create","tw",o);s.pin_description=bf_quiz.get_message("bff_create","pin",o);s.email_body=bf_quiz.get_message("bff_create","email_body",o);s.email_subject=bf_quiz.get_message("bff_create","email_subject",o);s.buzz_uri=t["bff_quiz_url"]}else if(t.type=="bff_take"){o["#{score}"]=bf_quiz.number_correct(t);o["#{total}"]=t.question_count;o["#{bff_quiz_creator_name}"]=t["bff_quiz_creator_name"];s.fb_title=bf_quiz.get_message("bff_take","fb_title",o);s.fb_blurb=bf_quiz.get_message("bff_take","fb_description",o);s.tw_blurb=bf_quiz.get_message("bff_take","tw",o);s.pin_description=bf_quiz.get_message("bff_take","pin",o);s.email_subject=bf_quiz.get_message("bff_create","email_subject",o);s.buzz_uri=t["bff_quiz_url"];s.picture=$(t["quiz_result_area_el"])[bfjs.selector](".result_img")[0].src}else{o["#{score}"]=bf_quiz.number_correct(t);o["#{total}"]=t.question_count;s.fb_title=s.buzz_name;s.fb_blurb=bf_quiz.get_message("generic","fb",o);s.tw_blurb=bf_quiz.get_message("generic","tw",o);s.pin_description=bf_quiz.get_message("generic","pin",o);s.email_subject=bf_quiz.get_message("generic","email_subject",o);s.tumblr_name=s.buzz_name;s.tumblr_description=bf_quiz.get_message("generic","tumblr",o);if(!unescape(s.email_subject).match("Quiz:")){s.email_subject="Quiz: "+s.email_subject}s.email_body=bf_quiz.get_message("generic","email_body",o)}if(BF_STATIC.campaignid=="1931201"){l="Remember to eat your cereal, not your serial killers.";s.fb_blurb=l;s.tw_blurb=s.buzz_name+" "+l;s.tw_hashtags="ripperstreet";s.pin_description=s.buzz_name+" "+l;s.email_subject=bf_quiz.get_message("generic","email_subject",{"#{title}":s.buzz_name});s.email_body=l+" "+escape(s.buzz_uri);s.tumblr_name=s.buzz_name;s.tumblr_description=l}if(BF_STATIC.campaignid=="3397410"){u={"Constant Commentator":"I’m an over-sharer and proud","Too Proud Parent":"I’m all about my brilliant brood",Failosopher:"I love getting deep and meaningful",Animaniac:"I admit it, I’m all about the cute animals","Smug Couple":"I’m loved up and you’re tired of seeing it","Score Bore":"I’ve been boring you with my gym brags","Social Show-Off":"I’ve been flaunting the high life on here too long","Foodie Fanatic":"I’ve been over-sharing my food snaps",Lurker:"Okay, I spend too much time looking at other peoples’ updates"};_={"Constant Commentator":"to stop my constant updates","Too Proud Parent":"to stop boasting about my babies",Failosopher:"to stop posting deep and meaningful messages",Animaniac:"to stop all the animal pictures","Smug Couple":"to stop updating you all on my love life","Score Bore":"to stop boasting about my gym time","Social Show-Off":"to stop showing-off","Foodie Fanatic":"to stop posting food photos",Lurker:"to stop lurking"};f={"Constant Commentator":"to stop these posts","Too Proud Parent":"to stop these posts",Failosopher:"to stop these posts",Animaniac:"to stop these posts","Smug Couple":"to stop these posts","Score Bore":"to stop these posts","Social Show-Off":"to stop these posts","Foodie Fanatic":"to stop these posts",Lurker:"to stop lurking"};o["#{outcome}"]=u[o["#{result}"]];o["#{fb_promise}"]=_[o["#{result}"]];o["#{email_promise}"]=f[o["#{result}"]];s.fb_title=bf_quiz.get_message("3397410","fb_title",o);s.fb_blurb=bf_quiz.get_message("3397410","fb_description",o);s.email_subject=bf_quiz.get_message("3397410","email_subject",o);s.email_body=bf_quiz.get_message("3397410","email_body",o);o["#{title}"]="What's Your Social Media Sin?";o["#{link}"]=escape(s.buzz_uri);s.tw_blurb=bf_quiz.get_message("3397410","tw",o)}if($(s.el))$(s.el).show();if(bfjs.isMobile()){$(document.body)[bfjs.selector](".js-action-bar--sharing.position-lower")[bfjs.add_class]("hidden");var d=$(t.quiz_result_area_el)[bfjs.selector](".js-action-bar--sharing.position-quiz .js-action-bar__btn");d.each(function(i,r){r.setAttribute("data-label",bf_quiz.GALabel(t))})}bf_quiz.initShareFacebook(t,s);if(typeof abtest!=="undefined"&&abtest.abTests&&abtest.abTests.match("quiz_fb_share_only")&&abtest.abVariations.match("quiz_fb_share_only--test")){if(bfjs.isMobile()){$(".answer_shares_buttons .js-action-bar--sharing li",t.el).each(function(t,i){if(!$(i).hasClass("action-bar__btn-container--facebook")){$(i).remove()}})}return}bf_quiz.initShareTwitter(t,s);bf_quiz.initShareEmail(t,s);bf_quiz.initSharePinterest(t,s);
bf_quiz.initShareTumblr(t,s)}catch(b){console.error(b)}};this.gaTrack=function(t,i,r){if(typeof gtrack!=="undefined"){gtrack.track_events(t,i,r)}else{switch(BF_STATIC.os){case"ios":var a=$("<iframe />").attr("src","bf://analytics?category=MobileBuzz:content&action=click:"+i+"&label="+r).hide().on("load",function(){a.remove()});$("body").append(a);break;case"android":var s={category:"MobileBuzz:content",action:"click:"+i,label:r};bf.analytics("",JSON.stringify(s));break}}};this.isLegacyApp=function(){var t=false;if(BF_STATIC.mobile_app){switch(BF_STATIC.os){case"ios":var i=navigator.userAgent.toLowerCase(),r=/(buzzfeed\/)([^\s]+)/,a=33e3,s,o;o=r.exec(i);s=o?parseInt(o[2]):0;t=s<=a;break;case"android":t=typeof buzzshare!=="undefined";break}}return t};this.submit_bff_quiz=function(t,i){var r,a={};var s=$(i["bff_quiz_form"][0])[bfjs.read_attr](bfjs.gtrack_cat);if(!(i.type=="bff_create"||i.type=="bf_26767_durex")||!bf_quiz.bff_quiz_create_validates(i,t))return;bf_quiz.bff_disable_form(i["bff_quiz_form"][0]);i["bff_quiz_id"]=bf_quiz.create_bff_quiz_id();i["bff_quiz_creator_name"]=bfjs.escapeHTML(t.submit_name);r={bff_id:i["bff_quiz_id"],bff_name:i["bff_quiz_creator_name"]};if(i.type=="bff_create"){r.bff_key=i["answer_positions"]}else if(i.type=="bf_26767_durex"){r.bff_key=bf_quiz.number_correct(i)}if(i.type=="bff_create"){bf_quiz.gaTrack(s,"[nc]submit:name","")}bf_quiz.bff_quiz_create_url(i["bff_clone"],r,function(t,r){var a=$(i["bff_quiz_create_results"][0])[bfjs.selector](".js-bff_quiz_create_url").first();i["bff_quiz_url"]=t;bf_quiz.bff_quiz_name_replace(i,i["bff_quiz_creator_name"]);a[bfjs.update_html](t);a[bfjs.write_attr]("href",t);$(i["bff_quiz_form"][0])[bfjs.add_class]("bff-quiz__form--hidden");if(i.type=="bff_create"){bf_quiz.submit_quiz(i)}else if(i.type=="bf_26767_durex"){bf_quiz.durexShowLink(i)}})};this.bff_disable_form=function(t){var i=$(t)[bfjs.selector]("input, button");$(t)[bfjs.add_class]("bff-quiz__form--disabled");bfjs.universal_each(i,function(t){$(t)[bfjs.write_attr]("disabled","true")})};this.bff_enable_form=function(t){var i=$(t)[bfjs.selector]("input, button");$(t)[bfjs.remove_class]("bff-quiz__form--disabled");bfjs.universal_each(i,function(t){$(t)[bfjs.write_attr]("disabled","false")})};this.create_bff_quiz_id=function(){var t=new Date;return t.getTime().toString()};this.bff_quiz_all_answered=function(t){return bf_quiz.number_selected(t)===parseInt(t.question_count,10)};this.bff_quiz_create_validates=function(t,i){bfjs.each(t.bff_quiz_error,function(t){$(t)[bfjs.add_class]("hidden")});var r=true;if(typeof i.submit_name==="undefined"||!i.submit_name.length){$(t.bff_quiz_error[0])[bfjs.remove_class]("hidden");r=false}if(!bf_quiz.bff_quiz_all_answered(t)){$(t.bff_quiz_error[1])[bfjs.remove_class]("hidden");r=false}if(typeof i.submit_name!=="undefined"&&i.submit_name.length>50){$(t.bff_quiz_error[2])[bfjs.remove_class]("hidden");r=false}return r};this.bff_quiz_create_url=function(t,i,r){var a,s="";var o="";var n="/buzzfeed/_short_url";var l="json";var u="get";a=Base64.encode(JSON.stringify(i));if(t.search(/^http/)==0){s=t+"?bff_data="+a}else{s=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")+(t||window.location.pathname)+"?bff_data="+a}o={url:s,action:"direct"};var _=setTimeout(function(){return r(s,"Shorten service not available; returning original URL")},30*1e3);if(bfjs.isMobile()){jQuery.ajax({dataType:l,url:n,data:o,success:function(t){clearTimeout(_);var i=t;if(i.short_url.data.url){shareurl=i.short_url.data.url;return r(shareurl,t)}},fail:function(t){clearTimeout(_);return r(s,"Shorten service not available; returning original URL")}})}else{new Ajax.Request(n,{method:u,dataType:l,parameters:o,onSuccess:function(t){clearTimeout(_);var i=t.responseText.evalJSON();if(i.short_url.data.url){shareurl=i.short_url.data.url;return r(shareurl,t)}},onFailure:function(t){clearTimeout(_);return r(s,"Shorten service not available; returning original URL")}})}};this.bff_quiz_post_leaderboard=function(t,i){var r=encodeURI(t["name"]);var a=BF_STATIC.mango_url+"/quiz/service/leaderboard/post"+"?quiz_id="+t["quiz_id"]+"&score="+t["score"]+"&name="+r;var s=setTimeout(function(){return i(false)},30*1e3);bfjs.loadJSONP(a,function(t){clearTimeout(s);return i(t)})};this.bff_quiz_get_leaderboard=function(t,i){var r=BF_STATIC.mango_url+"/quiz/service/leaderboard/get/"+t;var a=setTimeout(function(){return i(false)},30*1e3);bfjs.loadJSONP(r,function(t){if(t.hasOwnProperty("success")&&!t["success"]){clearTimeout(a);return i(false)}else if(t.hasOwnProperty("success")&&t.hasOwnProperty("data")&&t["success"]){clearTimeout(a);bfjs.universal_each(t["data"],function(t){if(t.hasOwnProperty("name")){t["name"]=decodeURI(t["name"])}});return i(bf_quiz.bff_quiz_extract_leaderboard(t["data"]))}})};this.bff_quiz_takeover_answers=function(t,i){var r=t;if(parseInt(r.question_count,10)===i.length){for(var a in r.questions){if(r.questions.hasOwnProperty(a)){for(var s=0;s<r.questions[a]["answers"].length;s++){var o=r.questions[a]["answers"];if(s===i[a])$(o[s])[bfjs.write_attr]("rel:correct",1);else $(o[s])[bfjs.write_attr]("rel:correct",0)}}}}return true};this.bff_quiz_extract_leaderboard=function(t){var i=[];for(var r=t.length-1;r>=0;r--){if(t[r].hasOwnProperty("score")){i.push({name:t[r]["name"],score:t[r]["score"]})}}return i};this.bff_quiz_build_leaderboard=function(t,i){var r="";var a=0;var s=20;var o=$(t);var n=o[bfjs.selector](".js-bff-leaderboard__container");var l=o[bfjs.selector](".js-bff-leaderboard__reveal");var u="";var _=false;if(!n.length){console.error(".js-bff-leaderboard__container cannot be found!");return false}i.sort(function(t,i){if(t.score>i.score)return-1;if(t.score<i.score)return 1;return 0});_=i.length>5?o[bfjs.selector](".js-bff-leaderboard__show"):false;bfjs.universal_each(i,function(t,i){if(i<s){var r=i+1;u+=bf_quiz.bff_quiz_build_player(t,r)}});if(l.length){$(l[0])[bfjs.remove_class]("hidden");$(l[0])[bfjs.observer]("click",function(e){e.preventDefault();bf_quiz.bff_quiz_show_leaderboard(o);$(this)[bfjs.add_class]("hidden");window.setTimeout(function(){bf_quiz.bff_quiz_animate_leaderboard(n[0])},200)})}if(_.length){$(_[0])[bfjs.observer]("click",function(e){var t=$(this);var i=$(t[bfjs.selector](".js-bff-leaderboard__show-text"));var r="";e.preventDefault();if(t[bfjs.has_class]("bff-leaderboard__show--more")){t[bfjs.add_class]("bff-leaderboard__show--less");t[bfjs.remove_class]("bff-leaderboard__show--more");bf_quiz.bff_quiz_show_more_leaderboard(n[0]);bf_quiz.bff_quiz_animate_leaderboard(n[0])}else{t[bfjs.remove_class]("bff-leaderboard__show--less");t[bfjs.add_class]("bff-leaderboard__show--more");bf_quiz.bff_quiz_show_less_leaderboard(n[0])}if(i.length){r=$(i[0])[bfjs.read_attr]("rel:message");$(i[0])[bfjs.write_attr]("rel:message",i[0].innerHTML);$(i[0])[bfjs.update_html](r)}})}$(n[0])[bfjs.update_html](u);return true};this.bff_quiz_show_leaderboard=function(t){var i=$(t)[bfjs.selector](".js-bff-leaderboard__container");var r=$(t)[bfjs.selector](".js-bff-leaderboard__show");var a=$(t)[bfjs.selector](".js-bff-leaderboard__player-container");if(i.length)$(i[0])[bfjs.remove_class]("bff-leaderboard__container--hidden");if(r.length&&a.length>5)$(r[0])[bfjs.remove_class]("bff-leaderboard__show--hidden")};this.bff_quiz_animate_leaderboard=function(t){var i=$(t);var r=0;var a=100;bfjs.universal_each($(t)[bfjs.selector](".js-bff-leaderboard__player-container:not(.bff-leaderboard__player-container--wipe-effect-on):not(.hidden)"),function(t,i){window.setTimeout(function(){$(t)[bfjs.add_class]("bff-leaderboard__player-container--wipe-effect-on")},r);r+=a})};this.bff_quiz_show_more_leaderboard=function(t){bfjs.universal_each($(t)[bfjs.selector](".js-bff-leaderboard__player-container.hidden"),function(t,i){$(t)[bfjs.remove_class]("hidden")})};this.bff_quiz_show_less_leaderboard=function(t){bfjs.universal_each($(t)[bfjs.selector](".js-bff-leaderboard__player-container"),function(t,i){if(i>4)$(t)[bfjs.add_class]("hidden")})};this.bff_quiz_add_to_leaderboard=function(t,i,r){var a=$(t)[bfjs.selector](".js-bff-leaderboard__container");var s;var o=1;var n="";var l=false;var u=5;if(a.length){s=$(a[0])[bfjs.selector](".js-bff-leaderboard__player-container");if(s.length===0){a[0].innerHTML=bf_quiz.bff_quiz_build_player(r,1)+a[0].innerHTML;return}else{bfjs.universal_each(s,function(t,i){var a=$(t);var s=a[bfjs.selector](".bff-leaderboard__player-position")[0];var _=parseInt(a[bfjs.read_attr]("rel:leaderboarder-score"),10);if(r["score"]>=_&&!l&&u>=o){n=bf_quiz.bff_quiz_build_player(r,o);t.insertAdjacentHTML("beforebegin",n);o++;l=true}a[bfjs.write_attr]("rel:leaderboard-position",o);$(s)[bfjs.update_html](o);o++});if(!l&&s.length<u){n=bf_quiz.bff_quiz_build_player(r,o);s[s.length-1].insertAdjacentHTML("afterend",n)}else if(!l&&s.length>=u){n=bf_quiz.bff_quiz_build_player(r);s[0].insertAdjacentHTML("beforebegin",n)}}}};this.bff_quiz_build_player=function(t,i){var r="";var a=typeof i==="undefined"?"bff-leaderboard__player-container--new":i>5?"hidden":"";i=typeof i==="undefined"?"":i;r+="<div rel:leaderboard-position="+i+"  rel:leaderboarder-score="+t["score"]+' class="js-bff-leaderboard__player-container bff-leaderboard__player-container  bff-leaderboard__player-container--wipe-effect '+a+'">';r+='<span class="bff-leaderboard__player-position">'+i+"</span>";r+='<span class="bff-leaderboard__player-name">'+t["name"]+"</span>";r+='<span class="bff-leaderboard__player-score">'+t["score"]+"</span>";r+="</div>";return r};this.bff_quiz_retrieve_player_name=function(t){var i,r;var a=setTimeout(function(){return t(false)},120*1e3);FB.getLoginStatus(function(i){if(i.status==="connected"){clearTimeout(a);FB.api("/me",function(i){if(i&&!i.error){return t(i.first_name+" "+i.last_name.slice(0,1)+".")}else{return t(false)}})}else{FB.login(function(i){FB.api("/me",function(i){clearTimeout(a);if(i&&!i.error){return t(i.first_name+" "+i.last_name.slice(0,1)+".")}else{return t(false)}})})}})};this.bff_quiz_name_replace=function(t,i){var r="";if(bfjs.isMobile())r=$(document.body)[bfjs.selector]("#buzz_sub_buzz .buzz_superlist_item_image .sub_buzz_media");else r=$(document.body)[bfjs.selector]("#buzz_sub_buzz .buzz_superlist_item_image");bfjs.universal_each(t.bff_quiz_name_block,function(t){t.innerHTML=t.innerHTML.replace("#{name}",i)});if(t["type"]==="bff_take"){var a=$(document.body)[bfjs.selector](".bff-quiz__create-title--take");if(a.length)$(a[0])[bfjs.remove_class]("bff-quiz__create-title--take-hidden");if(r.length)r[0].appendChild(a[0])}};this.bff_quiz_observe_form=function(t){var i;var r;t["bff_quiz_form"].first()[bfjs.observer]("submit",function(e){i=this.elements;r={};e.preventDefault();for(var a=i.length-1;a>=0;a--){if(i[a].name&&i[a].value){r[i[a].name]=i[a].value.trim()}}bf_quiz.submit_bff_quiz(r,t)})};this.bff_quiz_observe_fb_signin=function(t){$(t["bff_quiz_leaderboard_facebook_sign__button"][0])[bfjs.observer]("click",function(e){e.preventDefault();var i=$(this);var r=$(t["bff_quiz_leaderboard_facebook_sign"][0]);if(i[bfjs.has_class]("bff-leaderboard-facebook-sign__button--waiting"))return false;i[bfjs.add_class]("bff-leaderboard-facebook-sign__button--waiting");bf_quiz.bff_quiz_retrieve_player_name(function(a){if(a){var s=parseInt(bf_quiz.number_correct(t),10);var o={quiz_id:t["bff_quiz_id"],name:a,score:s};bf_quiz.gaTrack("bff_quiz","[nc]submit:facebook-sign-in");r[bfjs.add_class]("bff-leaderboard-facebook-sign--hidden");bf_quiz.bff_quiz_post_leaderboard(o,function(i){bfjs.universal_each(t["bff_quiz_leaderboard"],function(i){if($(i)[bfjs.has_class]("bff-leaderboard--bottom")){bf_quiz.bff_quiz_add_to_leaderboard(i,t["bff_quiz_leaderboard_data"],o);window.setTimeout(function(){bf_quiz.bff_quiz_animate_leaderboard(i)},500)}});t["bff_quiz_leaderboard_data"].push(o)})}i[bfjs.remove_class]("bff-leaderboard-facebook-sign__button--waiting")})})};this.bff_quiz_build_take_quiz=function(t){var i=bfjs.getUrlVars();var r,a={};if(i.hasOwnProperty("bff_data")){try{a=JSON.parse(Base64.decode(i["bff_data"]));t["bff_quiz_creator_name"]=bfjs.escapeHTML(a["bff_name"]);t["bff_quiz_id"]=a["bff_id"];t["bff_quiz_answer_key"]=a["bff_key"];r={bff_id:t["bff_quiz_id"],bff_name:t["bff_quiz_creator_name"],bff_key:t["bff_quiz_answer_key"]}}catch(e){if(t.type=="bf_26767_durex"){bf_quiz.durexSetup(t,false)}else{window.location=t["bff_clone"];console.log(e)}return}if(t.type=="bf_26767_durex"){bf_quiz.durexSetup(t,true);return}bf_quiz.bff_quiz_name_replace(t,t["bff_quiz_creator_name"]);bf_quiz.bff_quiz_takeover_answers(t,t["bff_quiz_answer_key"]);bf_quiz.bff_quiz_create_url("",r,function(i){t["bff_quiz_url"]=i;bf_quiz.bff_quiz_takeover_default_shares(t)});bf_quiz.bff_quiz_get_leaderboard(t["bff_quiz_id"],function(i){if(i){t["bff_quiz_leaderboard_data"]=i;if(t["bff_quiz_leaderboard_data"].length){bfjs.universal_each(t["bff_quiz_leaderboard"],function(i){bf_quiz.bff_quiz_build_leaderboard(i,t["bff_quiz_leaderboard_data"])})}}})}else{if(t.type=="bf_26767_durex"){bf_quiz.durexSetup(t,false)}else{window.location=t["bff_clone"]}}};this.bff_quiz_takeover_default_shares=function(t){var i="Take this quiz to see how well you really know "+t["bff_quiz_creator_name"]+".";var r="How well do you know "+t["bff_quiz_creator_name"]+"?";var a=t["bff_quiz_url"];var s="Playstation";var o=t["pound_no_track"];if(bfjs.isMobile()){var n=$(".share-buttons .fb-share-dialog a, .js-action-bar__btn--facebook");var l=$(".share-buttons .tweet_btn a, .js-action-bar__btn--twitter");var u=$(".share-buttons .pin a, .js-action-bar__btn--pinterest");var _=$(".share-buttons .email a, .js-action-bar__btn--email");var f=$(".share-buttons .whatsapp a");var c=$(".share-buttons .tumblr a");var d=(document.URL.indexOf("https://")==0?"https://":"http://")+document.domain+"/static/html/fb-redirect.html";$(".js-action-bar--fixed").hide();n.each(function(t,s){$(s).data("name",r);$(s).data("url",a);$(s).data("description",i);$(s).data("pound_no_track",true);$(s).data("redirect_uri",d)});l.each(function(t,i){$(i).data("text",r);$(i).data("url",a);$(i).data("pound_no_track",true)});u.each(function(t,i){$(i).data("description",r);$(i).data("url",a);$(i).data("pound_no_track",true)});_.each(function(t,i){$(i).data("text",r);$(i).data("url",a);$(i).data("legacy-url",a);$(i).data("pound_no_track",true)});f.each(function(t,r){$(r).attr("href","whatsapp://send?text="+encodeURIComponent(i)+"%20"+encodeURIComponent(a));$(r).data("pound_no_track",true)});c.each(function(t,s){$(s).attr("href","http://www.tumblr.com/share/link?url="+encodeURIComponent(a)+"&name="+encodeURIComponent(r)+"&description="+encodeURIComponent(i));$(s).data("pound_no_track",true)})}else{var b=$(document.body)[bfjs.selector]("#share_control .horizontal-share-buttons, .bottom_shares.square_shares");if(b.length){bfjs.universal_each(b,function(t){t.innerHTML="";sharing.buttons.facebook_share({parentNode:t,url:a,blurb:i,title:r,pound_no_track:o});sharing.buttons.twitter({parentNode:t,url:a,blurb:i,via:s,pound_no_track:o});sharing.buttons.email({parentNode:t,url:a,body:i+"\n\n "+a,subject:r,method:"mailto",pound_no_track:o});sharing.buttons.pinterest({parentNode:t,url:a,blurb:i,title:r,pound_no_track:o})})}}};this.bff_quiz_retrieve_info=function(t,i){var r={};var a=false;var s=$(i)[bfjs.read_attr]("rel:bff_clone"),o=t.el[bfjs.selector](".js-bff-quiz__form"),n=$(i)[bfjs.selector](".js-bff-quiz__error"),l=t.el[bfjs.selector](".js-bff-quiz__create-results"),u=t.el[bfjs.selector](".js-bff-quiz_name-replace"),_=$(i)[bfjs.selector](".js-bff-leaderboard"),f=$(i)[bfjs.selector](".js-leaderboard-facebook-sign"),c=$(i)[bfjs.selector](".js-leaderboard-facebook-sign__button");t["pound_no_track"]=true;r["bff_quiz_id"]="";r.bff_quiz_name_block=u;r.bff_quiz_share_block=t.el[bfjs.selector](".answer_shares .answer_shares_buttons");if(t.type!="bf_26767_durex"){r["bff_quiz_leaderboard_data"]=[];r["bff_quiz_leaderboard_limit"]=20;r["bff_quiz_answer_key"]=[]}r["bff_clone"]=s===null||s===""||typeof s==="undefined"?{error:"Quiz clone URL (Maker/Taker) doesn't exist"}:s;if(t["type"]=="bff_create"||t["type"]=="bf_26767_durex"){r["bff_quiz_form"]=o.length?o:{error:"Creator form element .js-bff-quiz__form doesn't exist"};r["bff_quiz_error"]=n.length?n:{error:"Creator form error box .js-bff-quiz__error doesn't exist"};r["bff_quiz_create_results"]=l.length?l:{error:"Creator results .bff_quiz_create_results doesn't exist"}}else if(t["type"]==="bff_take"&&BF_STATIC.campaignid=="3468441"){r["bff_quiz_leaderboard"]=_.length===2?_:{error:"Need exactly two leaderboards (.js-bff-leaderboard) elements"};r["bff_quiz_leaderboard_facebook_sign"]=f.length?f:{error:"Taker facebook button element does not exist (.js-leaderboard-facebook-sign)"};r["bff_quiz_leaderboard_facebook_sign__button"]=c.length?c:{error:"Taker facebook button element does not exist (.js-leaderboard-facebook-sign__button)"}}for(var d in r){if(r.hasOwnProperty(d)){if(r[d].hasOwnProperty("error")){console.error(r[d]["error"]);a=true}}}return a?false:r};this.durexSetup=function(t,i){var r=$(document.body)[bfjs.selector](".buzz_superlist_item_image");var a=".sub_buzz_content";var s=$(r[0]);var o=$(r[1]);o[bfjs.selector](a)[0].appendChild(t.bff_quiz_name_block[0]);if(i){t.bff_quiz_name_block[0].innerHTML=bf_quiz.get_message("bf_26767_durex","name",{"#{bff_quiz_creator_name}":t.bff_quiz_creator_name})}var n=i?s:o;n[bfjs.add_class]("hidden");var l=$(r[r.length-1]);l[bfjs.add_class]("hidden");l[bfjs.selector](a)[0].appendChild(t.bff_quiz_create_results[0]);t.bff_quiz_result=l};this.durexPatchResult=function(t,i,r){var a=t.bff_quiz_answer_key;var s=bf_quiz.number_correct(t);var o=s>a?"better":s<a?"worse":"eq";var n={worse:"worse than",eq:"as good as",better:"better than"};var l=bf_quiz.get_message("bf_26767_durex","tally",{"#{compare}":n[o],"#{bff_quiz_creator_name}":t.bff_quiz_creator_name})+(i[0]||i).innerHTML;i[bfjs.update_html](l);var u={worse:"Too bad! You probably started this quiz full of hope, but sadly, the libido just isn’t strong in you. Learn the ways of the fornication, and your confidence will grow, my apprentice. And don’t forget the most important lesson: Confidence is totally sexy!",eq:"So close! You battled bravely using your sexual trivia, but alas… this time you clearly met your match. March forward with your head held high, and be confident that one day you might become the master of the sexy time. After all, being confident is totally sexy!",better:"Check you out, you sexy thang! You laid it all out on the line and still came up trumps – and for that, we salute you. Now your defeated foe must refer to you only as the Sexy One. Your sexual confidence is palpable, so revel in your success because confidence is totally sexy!"};r.el[bfjs.selector]("p:first-child").first()[bfjs.update_html](u[o]);r.el[bfjs.write_attr]("rel:description",u[o])};this.durexShowLink=function(t){var i={"#{bff_quiz_creator_name}":t.bff_quiz_creator_name,"#{link}":t.bff_quiz_url};t.bff_quiz_name_block[1].innerHTML=bf_quiz.get_message("bf_26767_durex","name",i);t.bff_quiz_share_block[1].innerHTML="";var r={el:t.bff_quiz_share_block[1],picture:bf_quiz.getShareImage(t),fb_title:bf_quiz.get_message("bf_26767_durex","fb_title",i),fb_blurb:bf_quiz.get_message("bf_26767_durex","fb_description",i),tw_blurb:bf_quiz.get_message("bf_26767_durex","tw",i),tw_via:$(t.el)[bfjs.selector](".quiz_tally_results").first()[bfjs.read_attr]("rel:tweet_via")||"BuzzFeed",email_body:bf_quiz.get_message("bf_26767_durex","email_body",i),email_subject:bf_quiz.get_message("bf_26767_durex","email_subject",i),buzz_uri:t.bff_quiz_url,pound_no_track:t.pound_no_track};bf_quiz.initShareFacebook(t,r);bf_quiz.initShareTwitter(t,r);bf_quiz.initShareEmail(t,r);if(typeof bf_prog_load!="undefined"){var a=t.bff_quiz_result[bfjs.selector]("img")[0];bf_prog_load.load_image(a,a.getAttribute("rel:bf_image_src"))}t.bff_quiz_result[bfjs.remove_class]("hidden")};this.newBffSetup=function(t){var i=$(document.body)[bfjs.selector](".buzz_superlist_item_image");var r=$(i[i.length-1]);var a=r[bfjs.selector](".sub_buzz_content img")[0];r[bfjs.add_class]("hidden");$($(t.bff_quiz_create_results[0])[bfjs.selector](".js-bff-quiz__create-img")[0])[bfjs.replace](a);if(typeof bf_prog_load!="undefined"){bf_prog_load.load_image(a,a.getAttribute("rel:bf_image_src"))}}};var bf_quiz=new BF_Quiz;bfjs.onPageLoad(bf_quiz.init);BF_Related=function(){this.related_links_controller="/buzzfeed/_related_links";this.init=function(){if(!acl.user_can("general_admin"))return;related.assign_handlers()};this.assign_handlers=function(){universal_dom.assign_handler({bucket:"update-related",handler:related.update_related,event:"click"});universal_dom.assign_handler({bucket:"related-cancel",handler:related.related_cancel,event:"click"});universal_dom.assign_handler({bucket:"related-save",handler:related.save_related,event:"click"})};this.update_related=function(t){if(t.buzz_id){var i=$$(".update_related")[0];var r=i.getWidth();var a=i.getHeight();var s=t.clientY;related.show_body_overlay();i.show();if(s+a>BF_UTIL.browser.dimensions.height()){s=BF_UTIL.browser.dimensions.height()-a}i.setStyle({left:t.clientX+"px",top:s+"px",position:"fixed"})}else{console.log("update_related: Invalid buzz id")}};this.related_cancel=function(){if($("bodyOverlay")){document.body.removeChild($("bodyOverlay"))}$("save_spinner").hide();var t=$$(".update_related")[0];t.hide()};this.show_body_overlay=function(){var t=document.body.getHeight();var i=document.body.getWidth();if(!$("bodyOverlay")){var r=document.createElement("div");r.setAttribute("id","bodyOverlay");r.setStyle({width:i+"px",height:t+"px"});document.body.appendChild(r)}};this.save_related=function(t){if(t.buzz_id){$("save_spinner").show();var i=new Array;var r=$$(".related_input");for(var a=r.length;a>=1;a--){if($("related"+a)!=undefined&&$("related"+a).value!==undefined&&$("related"+a).value!=""){i.push($("related"+a).value)}}var s={action:"validate_and_save",campaignid:t.buzz_id,related_urls:JSON.stringify(i)};(new BF_Request).request("/buzzfeed/_related_links",{method:"get",parameters:s,onSuccess:function(t){var r=JSON.parse(t.responseText);console.log(r.number);if(r.success==0){related.error(r.message)}else if(r.number==0){related.error("No urls could be validated. Must be buzzfeed.com links.")}else if(i.length>r.number){related.error("Only "+r.number+" out of "+i.length+" urls could be validated.")}related.related_cancel()},onFailure:function(t){var i=JSON.parse(t.responseText);related.error(i.message||"save_related: validate and save failure")}})}else{console.log("save_related: Invalid buzz id")}};this.error=function(t){console.log("related.error");(new BF_Request).alert(t)}};var related=new BF_Related;BuzzLoader.register(function(){related.init()},2);(function(t){var $=t.getGlobal("$");var i=t.getGlobal("$$");var r=t.getGlobal("BuzzLoader");var a=function(){this.init=function(){s.resize_embeds()};this.resize_embeds=function(){if(BF_STATIC.tt_page=="User"){i(".buzz_superlist_item_embed").each(function(t){var i=t.select("iframe")[0];if(i){var r=i.getAttribute("height");var a=i.getAttribute("width");if(a>625){i.setAttribute("width",625);var s=625/a;r=Math.floor(r*s);i.setAttribute("height",r)}}})}}};var s=new a;r.register(s.init,5)})(bfjs);var BF_bpage=function(){this.lastScrollPos=0;this.more_loaded=false;var t=10,i="bf_recently_viewed_bpages";this.init=function(){var r=$$(".js-persistent-share").first();if((new BF_User).isLoggedIn()&&r){r.addClassName("page-header--with-ptools");$$(".js-page-header--persistent-share").first().addClassName("page-header--persistent-share-with-ptools")}if(hasLocalStorage()&&!BF_STATIC.hp_type){var a=localStorage.getItem(i),s=$$('meta[property="article:section"]'),o=$$('meta[property="bf:buzzid"]'),n=o.length?o[0].readAttribute("content"):null,l;s=s&&s[0].readAttribute("content");if(n&&s!=="Advertiser"){a=a?JSON.parse(a):[];if(~(l=a.indexOf(n)))a.splice(l,1);else if(a.length>=t)a.splice(0,1);a.push(n);localStorage.setItem(i,JSON.stringify(a))}}bpage.update_intl_logo_link();if($$(".graphic_image_wrapper")[0]){$$(".graphic_image_wrapper").each(function(t){bpage.set_box_blur(t)})}universal_dom.assign_handler({bucket:"bpage_tweet",event:"click",handler:bpage.tweet});universal_dom.assign_handler({bucket:"more_shares",event:"mouseover",handler:bpage.load_more_shares});universal_dom.assign_handler({bucket:"share_link",event:"click",handler:bpage.copy_link});universal_dom.assign_handler({bucket:"pinterest",event:"click",handler:bpage.pinterest});universal_dom.assign_handler({bucket:"sticky_popup_button",event:"click",handler:bpage.hide_other_popups});universal_dom.assign_handler({bucket:"print_btn",event:"click",handler:bpage.show_popup});universal_dom.assign_handler({bucket:"toggleBreakingSummary",event:"click",handler:bpage.toggleBreakingSummary});$$(".bottom_shares").first().removeClassName("hidden");if(typeof ab_config!=="undefined"&&ab_config.shares_order_2){if(typeof abtest!=="undefined"&&abtest.abTests&&abtest.abTests.match("shares_order_2")){if(abtest.abVariations.match("js-shares_order--control")){bpage.update_upper_shares()}else{$$(".bottom_shares").first().removeClassName("hidden")}}else{EventManager.observe_once("abtest:shares_order_2",function(t){if(t==="js-shares_order--control"){bpage.update_upper_shares()}else{$$(".bottom_shares").first().removeClassName("hidden")}})}}else{bpage.update_upper_shares()}bpage.dedupe_buzz();bpage.arrange_badges();bpage.loadSummary();var u=abtest.abVariations.split(",");if(u.indexOf("promo_var_1")!=-1)console.log(u.indexOf("promo_var_1"));if(u.indexOf("promo_var_1")!=-1){if($("bpage-bottom-dfp")){$("bpage-bottom-dfp").removeClassName("bpage-lower-dfp");var _=$("bpage-bottom-dfp").select(".bf-image-big")[0];_.width=125;_.height=83}}var f=abtest.abVariations.split(","),c=["sharing_vertical","sharing_ref"],d,b;bpage.show_dfp(f);if(f.intersect(c)[0]!=undefined){var h=f.intersect(c)[0];if(h=="sharing_ref"){$(h).select(".share_div").each(function(t){if(!t.hasClassName("hidden")){d=t.select("#link_parent")[0];b=t.select(".link_bottom")[0]}})}else if(h=="sharing_vertical"){d=$(h).select("#link_parent")[0];b=$(h).select(".link_bottom")[0]}}if(f.indexOf("related_two")!=-1){bpage.related_img_reset()}if(f.indexOf("related_two")!=-1){var m=$("related_two").select(".subbuzzpromo li")[3];if(m)m.removeClassName("hidden")}EventManager.observe("badge_vote:vote_init",function(t){bpage.custom_badge_vote(t)});if(BF_STATIC.tt_page=="Buzz"){Event.observe(window,"scroll",function(e){var t=$$(".page-footer")[0].viewportOffset().top+100;if(t<document.viewport.getHeight()&&!bpage.more_loaded){bpage._more_stuff_init()}})}bpage.dedupe_sidebar();bpage.hide_indepth_buzz()};this.show_popup=function(){window.print()};this.referrer=function(){var t=null;if(BF_STATIC.bf_test_mode){if(window.location.href.match("referrer=pinterest")){t="pinterest"}else if(window.location.href.match("referrer=twitter")){t="tweet"}else if(window.location.href.match("referrer=tumblr")){t="tumblr"}else if(window.location.href.match("referrer=stumbleupon")){t="stumbleupon"}else if(window.location.href.match("referrer=reddit")){t="reddit"}else if(window.location.href.match("referrer=linkedin")){t="linkedin"}}else{if(document.referrer.match("pinterest")){t="pinterest"}else if(document.referrer.match("t.co")){t="tweet"}else if(document.referrer.match("tumblr")){t="tumblr"}else if(document.referrer.match("stumbleupon")){t="stumbleupon"}else if(document.referrer.match("reddit")){t="reddit"}else if(document.referrer.match("linkedin")){t="linkedin"}}return t};this.update_bottom_shares=function(){if(!$$(".bottom_shares .shareBtn").length){setTimeout(function(){bpage.update_bottom_shares()},250);return}var t=$$(".bottom_shares").first();var i=$$(".bottom_shares .referrer_shares .shareBtn");var r=$$(".bottom_shares .vertical_shares .shareBtn");var a=$$(".bottom_shares .other_shares .shareBtn");var s=$$(".bottom_shares #more_shares_box .shareBtn");var o=bpage.referrer();var n=o?o+"_share":null;var l=objExists(BF_STATIC.vertical)?BF_STATIC.vertical:"";var u=$("buzz_sub_buzz")&&$("buzz_sub_buzz").hasClassName("suplist_long")?true:false;var _=[];if(!i||!r||!t){return false}if(t.hasClassName("hidden"))t.removeClassName("hidden");i.each(function(t){var i=$(t).findParent("div"),r=null;if(i){if(o){r=n}else{r="fb_share"}$(i).hasClassName(r)?_.push(r):$(i).remove()}});r.each(function(t){var i=$(t).findParent("div"),r=null;if(i){if(n=="pinterest_share"||n=="tweet_share"){r="fb_share"}else{r="tweet_share"}$(i).hasClassName(r)?_.push(r):$(i).remove()}});a.each(function(t){var i=$(t).findParent("div");if(i&&n){if($(i).hasClassName(n)){$(i).remove()}}});bpage.remove_dupe_shares(s,_)};this.remove_dupe_shares=function(t,i){i.each(function(i){t.each(function(e){var t=$(e).findParent("div");if($(t).hasClassName(i)){$(t).remove()}})})};this.copy_link=function(e){var t=e.element;if(!t){return false}if($("shares-copy-link").visible()){$("shares-copy-link").hide();if(typeof bf_rdio!="undefined")bf_rdio.enable();return false}var i=$(t).getAttribute("rel:link");var r={left:Number($(t).positionedOffset()[0]),top:Number($(t).positionedOffset()[1]),height:Number($(t).getHeight()),width:Number($(t).getWidth())};var a={width:300};var s={height:10,width:10};var o=$$("#shares-copy-link .arrow");$(t).insert({after:$("shares-copy-link")});$("shares-copy-link").setStyle({left:r.left-a.width/2+"px",top:r.top+r.height+s.height/2+"px"});o.each(function(t,i){$(t).setStyle({left:175-s.width+i+"px",top:i-s.height+"px"})});$$("#shares-copy-link input")[0].setAttribute("value",i);$("shares-copy-link").show();Selector.findChildElements($("shares-copy-link"),["input"])[0].select();if(typeof BF_STATIC.pound_enabled!="undefined"&&BF_STATIC.pound_enabled&&typeof bf_visit!="undefined"){bf_visit.recordShare(t)}if(typeof bf_rdio!="undefined")bf_rdio.disable();BF_Effect.ScrollIntoView("shares-copy-link")};this.dedupe_buzz=function(){var t=$$('meta[property="bf:buzzid"]'),i=t.length?t[0].readAttribute("content"):null;if(i){$$(".sidebar_featured_unit .small-posts").each(function(t){if($(t).hasAttribute("rel:buzz_id")){if($(t).getAttribute("rel:buzz_id")==i){$(t).remove()}}});if($("next_on_1")){if($("next_on_1").hasAttribute("rel:buzz_id")){var r=$("next_on_1").readAttribute("rel:buzz_id");if(i==r){if($("next_on_1"))$("next_on_1").hide();if($("next_on_2"))$("next_on_2").show()}}}if($("next_on_ab_1")){if($("next_on_ab_1").hasAttribute("rel:buzz_id")){var r=$("next_on_ab_1").readAttribute("rel:buzz_id");if(i==r){if($("next_on_ab_1"))$("next_on_ab_1").hide();if($("next_on_ab_2"))$("next_on_ab_2").show()}}}}};this.update_upper_shares=function(){var t=bpage.referrer(),i=$("pin_ref"),r=$("tweet_ref"),a=$("share_control");if(!i||!a)return;if(t=="pinterest"){i.removeClassName("hidden");a.addClassName("hidden")}else if(t=="tweet"){r.removeClassName("hidden");a.addClassName("hidden")}else{if(!i.hasClassName("hidden"))i.addClassName("hidden");if(a.hasClassName("hidden"))a.removeClassName("hidden")}};this.tweet=function(e){data=e.target;var t=e.target.getAttribute("rel:tw_url");var i=escape(e.target.getAttribute("rel:tw_text"));var r=e.target.getAttribute("rel:tw_via");var a="http://twitter.com/intent/tweet?url="+t+"&text="+i+"&via="+r;window.open(a,"_blank","width=600, height=300")};this.pinterest=function(t){var i=function(t,i){var r=200;var a=200;var s="";if(t>i){r=t/(i/200);s="margin-left: "+(0-(r-200)/2)+"px"}else if(t<i){a=i/(t/200);s="margin-top: "+(0-(a-200)/2)+"px"}return{img_width:r,img_height:a,img_style:s}};var r=function(){var t=document.createElement("SPAN");t.addClassName("pin_image");t.innerHTML='<span class="loading_pin_image"></span>';return t};var a=function(t){var i=0,r=0;i=t.naturalWidth;r=t.naturalHeight;return{w:i,h:r}};var s=function(t,i,r,a,s,o,n,l,u,_,f){var c=new Template($("pin_img_template").innerHTML);return c.evaluate({img_style:t,img_src:i,img_width:r,img_height:a,img_n_width:s,img_n_height:o,ieheight:n,scroll_pos:l,url:u,media:_,
desc:f})};bpage.lastScrollPos=$(document.viewport).getScrollOffsets().top;window.scrollTo(0,0);var e=BF_UTIL.document.height();$("pin_bg").setStyle({height:e+"px"});$("pin_bd").setStyle({height:e+"px"});if(typeof t!="undefined"&&typeof t.target!="undefined"){if(typeof t.target.up(".upper-share-buttons")!="undefined")$("pin_bd").setAttribute("rel:gt_cat","[ttp]:sharing-upper/pioverlay");if(typeof t.target.up(".bottom-share-buttons")!="undefined")$("pin_bd").setAttribute("rel:gt_cat","[ttp]:sharing-bottom/pioverlay")}document.body.appendChild($("pin_bg").show());document.body.appendChild($("pin_bd").show());var o=BF_STATIC.page="Videos"&&typeof videopromo!="undefined"?videopromo:$("post-"+BF_STATIC.campaignid).readAttribute("rel:data").evalJSON();var n=undefined;if(typeof BF_STATIC.pound_enabled!="undefined"&&BF_STATIC.pound_enabled){n=pound.urls.queryStringOnly()}else if(BF_STATIC.tt_page=="Videos"&&videopromo!=undefined&&videopromo.uri){n="http://www.buzzfeed.com/"+videopromo.uri}else{n="http://www.buzzfeed.com/"+BF_STATIC.username+"/"+o.uri}if($("pin_img_container").innerHTML)$("pin_img_container").innerHTML="";var l=Prototype.Browser.IE?636:336;var u=$s("title").innerHTML.replace(/'/g,"%27").replaceAll("&nbsp;"," ").unescapeHTML().stripTags().trim();var _=function(t,i,r){t.remove()};var f=function(){if($("pin_bg"))$("pin_bg").hide();if($("pin_bd"))$("pin_bd").hide()};var c=function(t,r,o,n){var u=a(this);var _=i(u.w,u.h);var c=_.img_width,d=_.img_height,b=_.img_style;var h=s(b,r,c,d,u.w,u.h,l,bpage.lastScrollPos,o,r,n);t.innerHTML=h.replaceAll("&lt;","<").replaceAll("&gt;",">");if(typeof BF_STATIC.pound_enabled!="undefined"&&BF_STATIC.pound_enabled){if(t.select("a").length)t.select("a")[0].observe("click",f)}};var d=$$(".buzz_superlist_item_image,"+".buzz_superlist_item_grid_row,"+".buzz_superlist_item_video.video_instagram,"+".buzz_superlist_item_photoslider,"+"#optimized_image_wrapper");if(d.length&&BF_STATIC.page!="Videos"){d.each(function(t){var i,a;var s=t.id;if(s){i=s.split("superlist_")[1];t=t.select("img")}if(n.indexOf("?")>-1){a=encodeURIComponent(n+(i?"&sub="+i:""))}else{a=encodeURIComponent(n+(i?"?sub="+i:""))}t.each(function(e){if(typeof e.up(".catcha_service")!="undefined")return;var t="";var i=r();$("pin_img_container").appendChild(i);var o=new Image;o.onload=function(){var r=s?e.readAttribute("rel:bf_image_src"):$$('link[rel="image_src"]')[0].href;if(e.up(".buzz_superlist_item")&&e.up(".buzz_superlist_item").select("h2").length){var o=Element.clone(e.up(".buzz_superlist_item").select("h2")[0],true);if(o.select("span.buzz_superlist_number_inline").length){o.select("span.buzz_superlist_number_inline")[0].remove()}t=o.innerHTML.stripTags().unescapeHTML().trim()}if(u)t=t?t+" | "+u:u;if(e.hasAttribute("rel:bf_image_desc"))t=e.readAttribute("rel:bf_image_desc");t=encodeURIComponent(t);c.apply(this,[i,r,a,t])};o.onabort=_.bind(null,i,b,1);o.onerror=_.bind(null,i,b,2);if(e.readAttribute("rel:bf_image_src"))o.src=e.readAttribute("rel:bf_image_src");else o.src=e.src})})}else{var b=BF_STATIC.big_image_root+"/static/images/global/buzzfeed-logo.png";if($$('meta[property="og:image"]').length>0){b=$$('meta[property="og:image"]')[0].attributes["content"].value}if(BF_STATIC.tt_page=="Videos")b=videopromo.promo_image;var h=r();$("pin_img_container").appendChild(h);var m=new Image;m.onload=function(){c.apply(this,[h,b,encodeURIComponent(n),encodeURIComponent(u)])};m.onabort=_.bind(null,h,b,1);m.onerror=_.bind(null,h,b,2);m.src=b}};this.related_img_reset=function(){var t=$$(".related_var_2 .subbuzzpromo li.wide")[0];var i=t.select("img")[0];var r=i.getAttribute("src");var a=r.replace("_wide.jpg",".jpg");i.setAttribute("src",a)};this.show_dfp=function(t){var i=["related_control","related_one","related_two"];var r=t.intersect(i)[0];if(r=="related_two"){if($("related_one"))$("related_one").select(".related_dfp")[0].remove()}else if(r=="related_one"){if($("related_two"))$("related_two").select(".related_dfp")[0].remove()}};this.load_more_shares=function(e){var t,i,r,a,s=e.element,o=function(t){try{if(t){return t.className.match("arrow")}}catch(e){console.warn(e);return false}},n=function(t){try{if(t){return t===u||t.ancestors().indexOf(u)>=0}}catch(e){console.warn(e);return false}},l=function(i){try{if(i){return i===t||i.firstChild===t||i.ancestors().indexOf(t)>=0}}catch(e){console.warn(e);return false}};if(!s){return false}bpage.hide_all_popups();var u=$("more_shares_box");s.insert({after:u});var u=$("more_shares_box");var _=u.select(".shareBtn:not(.hidden)").filter(function(t,i){return t.up().getStyle("display")!="none"});if(_.length){if(_.length==1){u.setStyle({width:"123px"})}else if(Math.floor(_.length/2)==_.length/2&&Math.floor(_.length/3)!=_.length/3){u.setStyle({width:"245px"})}}var f={width:Number(u.getWidth())};var c={left:Number($(s).positionedOffset()[0]),top:Number($(s).positionedOffset()[1]),height:Number($(s).getHeight()),width:Number($(s).getWidth())};var d=u.select(".arrow");u.setStyle({left:c.left-f.width/2+c.width/2+"px",top:c.top+c.height+"px"});d.each(function(t,i){$(t).setStyle({left:f.width/2-10+i+"px",top:i-10+"px"})});u.show();if(typeof bf_rdio!="undefined")bf_rdio.disable();i=$(s).on("mouseout",function(e){var t=e.toElement?e.toElement:e.relatedTarget;if(o(t)||n(t))return;i.stop();u.hide();if(typeof bf_rdio!="undefined")bf_rdio.enable()});r=$(u).on("mouseout",function(e){var i=e.toElement?e.toElement:e.relatedTarget;t=$$(".gc-bubbleDefault").first();if(o(i)||n(i))return;if(t){if(!a){a=$(t).on("mouseout",function(e){var t=e.toElement?e.toElement:e.relatedTarget;if(n(t)||l(t))return;a.stop();u.hide();if(typeof bf_rdio!="undefined")bf_rdio.enable()})}if(l(i))return}r.stop();u.hide();if(typeof bf_rdio!="undefined")bf_rdio.enable()})};this.arrange_badges=function(){var t=$$(".wrap_badge");if(!t.length)return;t.each(function(i){if(i.hasClassName("disapprove")){var r=t.indexOf(i);t.splice(r,1);t.unshift(i);if(t.length>10){var a=t.length-10}}});var i=55;for(var r=0;r<=t.length;r++){if(t[r]){var a=getWidth(t[r].select("img")[0]);if(a>50)i=a+5;if(r!=0){t[r].setStyle({left:i+"px"});i+=55}}}};this.hide_other_popups=function(e){var t=e.element,i=$$(".sticky-popup"),r=t.nextSiblings(".sticky-popup")[0];if(t.getAttribute("rel:gt_act")!=="share/email")shareEmail.current_button=null;i.each(function(t){if(t!==r)t.setStyle({display:"none"})});if(typeof sub_links!="undefined")sub_links.share_box_inactive()};this.hide_all_popups=function(){shareEmail.current_button=null;$$(".sticky-popup").each(function(t){if(t.getStyle("display")==="block")t.hide()});if(typeof bf_rdio!="undefined")bf_rdio.enable();if(typeof sub_links!="undefined")sub_links.share_box_inactive()};this.set_quote_style=function(){$$(".buzz_superlist_item_quote").each(function(t){var i=new Element("span",{"class":"ie-quote-before"});var r=new Element("span",{"class":"ie-quote-after"});t.select("blockquote p")[0].insert({before:i});t.select("blockquote p")[t.select("blockquote p").length-1].insert(r);if(t.select("blockquote p").length>=2){t.addClassName("long-quote")}if(t.select("blockquote p").length<=1){t.addClassName("short-quote")}})};this.set_box_blur=function(t){var i=t.getOffsetParent(),r=i.select("div.graphic_image_warning")[0],a=t.select("video.graphic_image")[0],s=null,o=t.select(".sub_buzz_content__mp4"),n="img.graphic_image",l=i.select(".click_to_blur")[0],u=Prototype.Browser.WebKit&&!isSafari5()||isIE9(),_=Prototype.Browser.Gecko&&!isIE11(),f=isIE11(),c="";var d=function(){var t=!a||!s.getAttribute("data-mp4_url")||s.getAttribute("data-mp4_error")!==null?s:a;if(a&&a.getAttribute("data-status")==="not_loaded"){t=s.parentElement.nextElementSibling.firstElementChild}if(u){t.addClassName("graphic_image")}else if(_){t.setAttribute("style","filter:url("+c+");")}else if(f){$$("#"+s.id+" image")[0].style.filter="url(#blur-effect-"+s.id.replace("svg-image-blur-","")+")"}else{i.select(".image_block")[0].removeClassName("hidden")}r.removeClassName("hidden");l.addClassName("hidden");i.removeClassName("no_blur")};var b=function(){var t=!a||!s.getAttribute("data-mp4_url")||s.getAttribute("data-mp4_error")!==null?s:a;if(a&&a.getAttribute("data-status")==="not_loaded"){t=s.parentElement.nextElementSibling.firstElementChild}if(u){t.removeClassName("graphic_image")}else if(_){t.setAttribute("style","")}else if(f){$$("#"+s.id+" image")[0].style.filter=""}else{$s("#"+i.identify()+" .image_block").addClassName("hidden")}r.addClassName("hidden");l.removeClassName("hidden");i.addClassName("no_blur")};if(!!a&&o.length){s=o.first().select(n)[0]}else{s=t.select(n)[0]}if(f){r.style.top=s.getAttribute("height")/2*-1+"px";s.remove();s=t.select("svg")[0];s.style.display=""}if(BF_STATIC.bf_env=="dev"||BF_STATIC.bf_env=="live"){c=BF_STATIC.image_root+"/static/images/public/quickpost/blur.svg#blur30"}else if(BF_STATIC.bf_env=="stage"){c="http://stage.buzzfeed.com/static/images/public/quickpost/blur.svg#blur30"}d();if(!isIE11())s.addClassName("box_blur");t.observe("click",function(){b()});l.observe("click",function(){d()})};this.custom_badge_vote=function(t){if(t){t=t.toLowerCase();if(t=="kaching"){BFAudio.player("/sounds/kaching.mp3")}}};this.update_intl_logo_link=function(){if(BF_STATIC.non_english==1||BF_STATIC.tt_page!="Buzz")return;var t=typeof BFW_Util=="object"&&BFW_Util.getCookie("country")?BFW_Util.getCookie("country"):"us";if(BF_STATIC.all_countries&&BF_STATIC.all_countries[t]&&BF_STATIC.all_countries[t].composite_code.match(/^en/)&&BF_STATIC.all_countries[t]["intl_logo_link"]){$s(".page-header__logo-primary").href=BF_STATIC.home_url+BF_STATIC.all_countries[t]["intl_logo_link"]}};this._more_stuff_init=function(){if(document.location.href.match("/video/"))return;var t=$$(".Content")[0].getHeight()+200,i=$$(".Column2")[0]?$$(".Column2")[0].getHeight():0;if(t>=i&&$("lower-more-content")){bpage._more_stuff_request()}};this._more_stuff_request=function(){bpage.more_loaded=true;var t=$("lower-more-content"),i=t.getAttribute("rel:plugin_version"),r,a=new BF_Request,s=parseInt(Math.random()*10+1);if(!i)return;var o="/country:us";if(typeof BFW_Util=="object"&&(BFW_Util.getCookie("country")=="uk"||BFW_Util.getCookie("country")=="au")){o="/country:"+BFW_Util.getCookie("country")}r=BF_STATIC.web_root+"/plugin/infinitesidebar/v:"+i+o+"/p:"+s;if(BF_STATIC.bf_env=="dev"&&BF_STATIC.bf_test_mode==true){r=BF_STATIC.web_root+"/plugin/infinitesidebar/v:"+i+"/country:us/p:3"}a.request(r,{onSuccess:function(t){if(t.responseText){bpage.load_more_stuff(t.responseText)}},onFailure:function(t){console.error(t)}})};this.load_more_stuff=function(t){if($("lower-more-content")){$("lower-more-content").insert(t);$$("#lower-more-content .post img.thumb").each(function(t,i){t.src=t.getAttribute("rel:bf_image_src")})}};this.toggleBreakingSummary=function(t){var i=$("breaking_news_summary_content"),r=$("toggleBreakingSummary"),t=typeof t!="boolean"?i.hasClassName("hidden")?true:false:t;if(i&&r){if(t){if(i.hasClassName("hidden"))i.removeClassName("hidden");r.innerHTML="Hide summary"}else{if(!i.hasClassName("hidden"))i.addClassName("hidden");r.innerHTML="Show summary";BF_Effect.ScrollIntoView(r,0)}}if(BF_STATIC.campaignid)store.set(BF_STATIC.campaignid+"_summary",t)};this.loadSummary=function(){if(BF_STATIC.campaignid){if(store.get(BF_STATIC.campaignid+"_summary")==false){bpage.toggleBreakingSummary(false)}}};this.hide_indepth_buzz=function(){var t=BF_STATIC&&BF_STATIC.campaignid?BF_STATIC.campaignid:null,i=universal_dom&&universal_dom._bucket&&universal_dom._bucket["indepth_buzz"]?universal_dom._bucket["indepth_buzz"].elements:[];if(!t||!i.length){return}i.each(function(i){if(i.data&&i.data.indepth_buzz_id&&i.data.indepth_buzz_id==t){i.element.addClassName("hidden")}})};this.dedupe_sidebar=function(){var t=new Array("promoted");var i=window.location.href.replace(/bf2\//,"");i=i.replace(/http:\/\/.*?\/.*?\/(.*)/,"$1");var r=new Array(/#.*/,/\/.*/,/\?.*/);for(var a=0;a<r.length;a++){if(i.match(r[a]))i=i.replace(r[a],"")}for(var a=0;a<t.length;a++){var s=$(t[a]+"-"+i);if(s){s.hide();var o=$(t[a]+"-extra-hidden");if(o)o.show()}}}};$(document).observe("click",function(e){if(typeof e.target=="undefined"||!isHTMLElement(e.target)){return}var t=false,i=e.toElement?e.toElement:e.relatedTarget||e.target,r=function(t){var i=$(t).getAttribute("rel:bf_bucket");var r=$(t).getAttribute("rel:bf_bucket_data");var a=$(t).hasClassName("sticky-popup");var s=i&&i.match("sticky_popup_button")!==null;var o=r&&r.match("email-share")!==null;return a||s||o};if(!i||r(i))return;i.ancestors().each(function(i){if(!t){t=r(i)}});if(t)return;bpage.hide_all_popups()});$(document).observe("keyup",function(e){if(e.keyCode==Event.KEY_ESC){bpage.hide_all_popups()}});var bpage=new BF_bpage;BuzzLoader.register(bpage.init,5);var Rerankable=function(){var t=this;var i=false;this.isPinnedCTA=false;this.pinnedThreshold=0;this.username="";this.is_not_rerank_mode=false;this.removing=false;this.modeIsReady=false;this.templates={share_modal:'<div class="rerank_modal #{amazon} rerank_share_modal modal hidden" rel:gt_cat="Buzz:Re-Rank">                <a href="javascript:;" class="bf_dom fa fa-times close_btn" rel:bf_bucket="re_rank_modal_close"></a>                <div class="title_img"></div>                <div class="title">                    Thanks, <span class="wrap_text_hidden">#{name}!</span><br/>Now share your post!                </div>                <div class="help_txt">                    <a href="#{url}">#{url}</a>                </div>                <div class="share_buttons"></div>            </div>',confirm_modal:'<div class="rerank_modal #{amazon} rerank_confirm_modal modal hidden" rel:gt_cat=#{category}>                <a href="javascript:;" class="bf_dom fa fa-times close_btn" rel:bf_bucket="re_rank_modal_close" rel:gt_act="cancel-abandon"></a>                <div class="title">                    OMG!<br />Want to abandon your #{label}?                </div>                <div class="help_txt">                    Your changes won\'t be saved.                </div>                <a class="bf_dom btn rerank_btn rerank_btn_big rerank_btn_white" rel:gt_act="quit-rerank" rel:bf_bucket="re_rankable_mode_close">Yep, I Quit</a>                <div class="add_help_text">                    <a href="javascript:;" class="bf_dom" rel:gt_act="cancel-abandon" rel:bf_bucket="re_rank_modal_close">No wait! I want to keep working &rarr;</a>                </div>            </div>',error_modal:'<div class="rerank_modal rerank_error_modal modal hidden">                <a href="javascript:;" class="bf_dom fa fa-times close_btn" rel:bf_bucket="re_rank_modal_close"></a>                <div class="title">ERROR</div>                <div class="help_txt">#{error}.</div>            </div>',subway_rerank_quiz:'<div class="rerank_modal subway_rerankable_quiz modal hidden">                  <a href="javascript:;" class="bf_dom fa fa-times close_btn" rel:bf_bucket="re_rank_modal_close"></a>                  <div class="result_headline">You are...<br/>                    #{title}                  </div><br/>                  <div class="result_image">                     <img src="#{static_root}#{image}" height="280" width="280">                  </div><br/>                  <div class="result_description">                    #{description}                  </div>                  <p class="share_title">SHARE YOUR RESULTS</p>                  <div class="share_buttons" rel:gt_cat="Buzz:Subway-Re-Rank"></div>                </div>',text_subbuzz:'<div class="subbuzz bf_dom subbuzz_text" id="element_#{id}" data-id="#{id}" rel:bf_bucket_data=\'{"drag_element-md":{}}\'>                    <div class="rank_numbering">                        <input type="text" class="bf_dom rank_numb" rel:gt_act="number" value="#{number}" rel:bf_bucket_data=\'{"re_rank_number":{}, "re_rank_number_blur":{}, "re_rank_number_focus": {}, "re_rank_number_keypress": {}}\'/>                    </div>                    <h2>#{title}</h2>                    <p class="rank-description">#{text}</p>                    <div class="arrows">                        <a href="javascript:;" class="fa fa-arrow-up up bf_dom" rel:bf_bucket="re_rank_up"></a>                        <a href="javascript:;" class="fa fa-arrow-down down bf_dom" rel:bf_bucket="re_rank_down"></a>                    </div>                    <a href="javascript:;" class="subbuzz__remove fa fa-close bf_dom" rel:bf_bucket="re_rank_remove">&#xf00d;</a>                    <a href="javascript:;" class="subbuzz__restore fa fa-plus bf_dom" rel:bf_bucket="re_rank_restore"></a>                </div>',image_subbuzz:'<div class="subbuzz bf_dom subbuzz_image" id="element_#{id}" data-id="#{id}" rel:bf_bucket_data=\'{"drag_element-md":{}}\'>                    <div class="rank_numbering">                        <input type="text" class="bf_dom rank_numb" rel:gt_act="number" value="#{number}" rel:bf_bucket_data=\'{"re_rank_number":{}, "re_rank_number_blur":{}, "re_rank_number_focus": {}, "re_rank_number_keypress": {}}\'/>                    </div>                    <div class="rank_img_holder"><img width="100" src="#{image}"/></div>                    <h2>#{title}</h2>                    <p class="rank-description">#{text}</p>                    <div class="arrows">                        <a href="javascript:;" class=" fa fa-arrow-up up bf_dom" rel:bf_bucket="re_rank_up"></a>                        <a href="javascript:;" class="fa fa-arrow-down down bf_dom" rel:bf_bucket="re_rank_down"></a>                    </div>                    <a href="javascript:;" class="subbuzz__remove fa fa-close bf_dom" rel:bf_bucket="re_rank_remove">&#xf00d;</a>                    <a href="javascript:;" class="subbuzz__restore fa fa-plus bf_dom" rel:bf_bucket="re_rank_restore"></a>                </div>',video_subbuzz:'<div class="subbuzz bf_dom subbuzz_video" id="element_#{id}" data-id="#{id}" rel:bf_bucket_data=\'{"drag_element-md":{}}\'>                    <div class="rank_numbering">                        <input type="text" class="bf_dom rank_numb" value="#{number}" rel:gt_act="number" rel:bf_bucket_data=\'{"re_rank_number":{}, "re_rank_number_blur":{}, "re_rank_number_focus": {}, "re_rank_number_keypress": {}}\'/> #{title}                    </div>                    <div class="rank_img_holder"><img width="100" src="#{video}"/></div>                    <h2>#{title}</h2>                    <p class="rank-description">#{text}</p>                    <div class="arrows">                        <a href="javascript:;" class=" fa fa-arrow-up up bf_dom" rel:bf_bucket="re_rank_up"></a>                        <a href="javascript:;" class="fa fa-arrow-down down bf_dom" rel:bf_bucket="re_rank_down"></a>                    </div>                    <a href="javascript:;" class="subbuzz__remove fa fa-close bf_dom" rel:bf_bucket="re_rank_remove">&#xf00d;</a>                    <a href="javascript:;" class="subbuzz__restore fa fa-plus bf_dom" rel:bf_bucket="re_rank_restore"></a>                </div>'};this.text=function(t){if(!t){return""}var i=typeof t.innerText=="undefined"?"textContent":"innerText";return t[i]};this.text_with_emojis=function(t){if(!t){return""}if(typeof t.innerHTML=="undefined")return this.text(t);var i=t.innerHTML;var r=i.match(/<img class=\"twitter-emoji\" src=\"[^<]*\.png\">/g);var a=i.replace(/<img class=\"twitter-emoji\" src=\"[^<]*\.png\">/g,"☺");var s=0;function o(){var t=r[s];s++;return t}var n=document.createElement("p");n.innerHTML=a;a=n.innerText;a=a.length>150?a.substr(0,147)+"...":a;return a.replace(/\u263a/g,o)};this.init=function(){var t=this;this.defaultRerankData={tooltips:{top:false,number:false,number_enter:false},sharedUrl:""};if(!store.get("rerank_data")){this.setRerankData(this.defaultRerankData)}this.container=$$(".rerankable_container")[0];this.list=this.container.select("#reranked_list")[0];this.removable=$$(".reranked_list_holder")[0].hasClassName("removable");this.isSubway=this.container.hasClassName("js-subway-rerank");if(this.isSubway){this.category="Buzz:Subway-Re-Rank";this.insertScriptInHead("/static/js/public/buzz/subway_rerankable_quiz.js")}this.isAmazon=this.container.hasClassName("amazon-wishlist");if(this.removable){this.removedList=this.container.select("#reranked_removed_list")[0]}this.data=this.container.readAttribute("rel:data")?JSON.parse(this.container.readAttribute("rel:data")):{};this.isContinue=true;this.$cta=$$(".rerank_cta")[0];this.$submitBtn=$("re_rank_submit_btn");this.$ctaBottom=$$(".rerank_cta_bottom")[0];this.render();if(!this.isContinue)return false;this.startNum=this.list.select(".subbuzz .rank_numbering input")[0].getValue();this.ctaTop=this.$cta.cumulativeOffset().top;this.ctaLeft=this.getCtaLeft();this.ctaBottomTop=this.$ctaBottom.cumulativeOffset().top;this.initHandlers();this.initDragDrop();this.reorder();this.showShare();this.startPostOrderItems=[];this.startRerankOrderPos=[];this.fillObjOrder();this.initOrderList=this.getOrder(this.list).join(",");this.startItemNumber=0;this.checkRemoveAbility();Element.observe(window,"resize",function(){t.placeTooltips();t.showTooltips();t.onWindowResize()});Event.observe(document,"mouseup",this.onDragElMouseUp.bind(this));Event.observe(window,"scroll",this.onScroll.bind(this));this.container.select(".rerank_username")[0].observe("click",function(){t.container.select(".rerank_username")[0].removeClassName("error");t.container.select(".rerank_username_error_message")[0].hide()})};this.setCtaLeft=function(){if(t.isPinnedCTA){t.$cta.setStyle({left:t.ctaLeft+"px"})}};this.clearCtaLeft=function(){t.$cta.setStyle({left:""})};this.getCtaLeft=function(){var t=$("buzz_header");return t.cumulativeOffset().left+(t.getWidth()-this.$cta.getWidth())/2+3};this.fillObjOrder=function(){var i="";startRerankItemsOrder={};$$("#buzz_sub_buzz .buzz_superlist_item").each(function(r,a){i=$(r).id.split("_")[2];t.startPostOrderItems.push(i);t.list.select(".subbuzz").each(function(r,s){if(i==$(r).readAttribute("data-id")){t.startRerankOrderPos.push(a)}})})};this.getOrder=function(t){var i={},r=[];t.select(".subbuzz").each(function(t,i){var a=$(t).readAttribute("data-id");if(!a){return}r.push(a)});return r};this.setRerankData=function(t){var i=false,r=this.getRerankData();if(typeof t!=="undefined"&&t){if(typeof t.tooltips!=="undefined"){r.tooltips=t.tooltips;i=true}if(typeof t.sharedUrl!=="undefined"){r.sharedUrl=t.sharedUrl;i=true}if(typeof t.currentUrl!=="undefined"){r.currentUrl=t.currentUrl;i=true}if(typeof t.subwayRerankableQuiz!=="undefined"){r.subwayRerankableQuiz=t.subwayRerankableQuiz;i=true}}if(i)store.set("rerank_data",r)},this.getRerankData=function(){var t=this.defaultRerankData,i=store.get("rerank_data");if(i&&typeof i.tooltips!=="undefined"){t.tooltips=i.tooltips}if(i&&typeof i.sharedUrl!=="undefined"){t.sharedUrl=i.sharedUrl}if(i&&typeof i.currentUrl!=="undefined"){t.currentUrl=i.currentUrl}if(i&&typeof i.subwayRerankableQuiz!=="undefined"){t.subwayRerankableQuiz=i.subwayRerankableQuiz}return JSON.parse(JSON.stringify(t))},this.setSubwayRerankableQuiz=function(t){var i=this.getRerankData();i.subwayRerankableQuiz=t;this.setRerankData(i)},this.getSubwayRerankableQuiz=function(){var t=this.getRerankData();return t.subwayRerankableQuiz},this.setTooltipsShown=function(t){var i=this.getRerankData();i.tooltips[t]=true;if(!this.getTooltipsShown(t)){this.setRerankData(i)}},this.getTooltipsShown=function(t){var i=this.getRerankData();return i.tooltips[t]},this.setSharedUrl=function(t){var i=this.getRerankData();i.sharedUrl=t;this.setRerankData(i)},this.setCurrentUrl=function(t){var i=this.getRerankData();i.currentUrl=t;this.setRerankData(i)},this.getCurrentUrl=function(){var t=this.getRerankData();return t.currentUrl},this.getSharedUrl=function(){var t=this.getRerankData();return t.sharedUrl},this.initDragDrop=function(){Position.includeScrollOffsets=true;Sortable.create("reranked_list",{tag:"div",onChange:this.reorder.bind(this),starteffect:this.onDragStart.bind(this),endeffect:this.onDragEnd.bind(this),scroll:window})};this.insertScriptInHead=function(t){var i=document.getElementsByTagName("head")[0];var r=document.createElement("script");r.src=t;i.appendChild(r)};this.initHandlers=function(){universal_dom.assign_handler({bucket:"re_rank",event:"click",handler:this.onRerankClick.bind(this)});universal_dom.assign_handler({bucket:"re_rank_up",event:"click",handler:this.onUp.bind(this)});universal_dom.assign_handler({bucket:"re_rank_down",event:"click",handler:this.onDown.bind(this)});universal_dom.assign_handler({bucket:"re_rank_remove",event:"click",handler:this.onRemove.bind(this)});universal_dom.assign_handler({bucket:"re_rank_restore",event:"click",handler:this.onRestore.bind(this)});universal_dom.assign_handler({bucket:"re_rank_reset",event:"click",handler:this.onReset.bind(this)});universal_dom.assign_handler({bucket:"re_rank_submit",event:"click",handler:this.onSubmit.bind(this)});universal_dom.assign_handler({bucket:"re_rank_modal_close",event:"click",handler:this.closeLoginModal.bind(this)});universal_dom.assign_handler({bucket:"re_rankable_mode_close",event:"click",handler:this.closeRerankableMode.bind(this)});universal_dom.assign_handler({bucket:"rerank_sign_in",event:"click",handler:this.signin.bind(this)});universal_dom.assign_handler({bucket:"rerank_submit_name",event:"click",handler:this.submitName.bind(this)});universal_dom.assign_handler({bucket:"re_rank_number_blur",event:"blur",handler:this.onNumberBlur.bind(this)});universal_dom.assign_handler({bucket:"re_rank_number_focus",event:"focus",handler:this.onNumberFocus.bind(this)});universal_dom.assign_handler({bucket:"re_rank_number",event:"change",handler:function(e){rerankable.onNumberChangeDebounced(e)}});universal_dom.assign_handler({bucket:"re_rank_number_keypress",event:"keypress",handler:function(e){rerankable.onNumberKeyPressDebounced(e)}});universal_dom.assign_handler({bucket:"drag_element-md",event:"mousedown",handler:this.onDragElMouseDown.bind(this)});universal_dom.assign_handler({bucket:"reranked-times",handler:this.reranked_times.bind(this)});universal_dom.update(this.container)};this.reranked_times=function(t,i){new Ajax.Request(BF_STATIC.web_root+"/rerank_subbuzz/"+i.buzz_id,{method:"get",onSuccess:function(r){var a=r.responseText.evalJSON();t.innerHTML=a[i.buzz_id]}})};this.onWindowResize=function(){this.ctaTop=this.$cta.cumulativeOffset().top;this.ctaLeft=this.getCtaLeft();this.setCtaLeft()};this.render=function(){this.build();var t=this.list.select(".subbuzz");if(t.length<2){this.isContinue=false;return}this.$cta.removeClassName("hidden");this.$ctaBottom.removeClassName("hidden");universal_dom.update(this.container)};this.build=function(){this.list.update("");$$("#buzz_sub_buzz .buzz_superlist_item").each(function(i){t.buildList(i,t.list)});$$("#reranked_list .subbuzz").each(function(t){t.addClassName("active")});if(this.removable){this.removedList.update('<div class="reranked_removed_list__header">Removed Items</div>');$$("#reranked_removed_subbuzzes .buzz_superlist_item").each(function(i){t.buildList(i,t.removedList)})}this.modeIsReady=true};this.buildList=function(i,r){if(i.select('[class^="buzz_superlist_number"]').length==0){return}if(i.hasClassName("buzz_superlist_item_text")){t.parseText(i,r)}else if(i.hasClassName("buzz_superlist_item_image")){t.parseImage(i,r)}else if(i.hasClassName("buzz_superlist_item_video")){t.parseVideo(i,r)}};this.parseText=function(t,i){var r={};r.id=t.id.replace("superlist_"+BF_STATIC.campaignid+"_","");var a=this.text_with_emojis(t.select("h2")[0]);var s=this.text(t.select("h2 .buzz_superlist_number_inline")[0]);r.title=a.replace(s+" ","");r.text=this.text_with_emojis(t.select(".sub_buzz_desc")[0]);if(!r.text)r.text=this.text(t.select(".sub_buzz_desc_w_attr")[0]);r.number=t.readAttribute("rel:buzz_num");this.append(r,"text",i)};this.parseImage=function(t,i){var r={};r.id=t.id.replace("superlist_"+BF_STATIC.campaignid+"_","");var a=this.text(t.select("h2")[0]);var s=this.text(t.select("h2 .buzz_superlist_number_inline")[0]);r.title=a.replace(s+" ","");r.image=t.select(".sub_buzz_content img")[0].readAttribute("rel:bf_image_src");r.text=this.text(t.select(".sub_buzz_desc")[0]);if(!r.text)r.text=this.text(t.select(".sub_buzz_desc_w_attr")[0]);r.text=r.text.length>170?r.text.substr(0,167)+"...":r.text;r.number=t.readAttribute("rel:buzz_num");this.append(r,"image",i)};this.parseVideo=function(t,i){var r={};r.id=t.id.replace("superlist_"+BF_STATIC.campaignid+"_","");var a=this.text(t.select("h2")[0]);var s=this.text(t.select("h2 .buzz_superlist_number_inline")[0]);r.title=a.replace(s+" ","");if(t.hasClassName("video_instagram")){r.video=t.select(".sub_buzz_content img")[0].src}else{r.video=t.select(".sub_buzz_content .video-embed-big")[0].readAttribute("rel:thumb")}r.text=this.text(t.select(".sub_buzz_desc")[0]);if(!r.text)r.text=this.text(t.select(".sub_buzz_desc_w_attr")[0]);r.text=r.text.length>250?r.text.substr(0,147)+"...":r.text;r.number=t.readAttribute("rel:buzz_num");this.append(r,"video",i)};this.append=function(t,i,r){if(typeof this.templates[i+"_subbuzz"]==undefined){console.error("Incorrect template type: "+i);return}var a=new Template(this.templates[i+"_subbuzz"]);var s=a.evaluate(t);r.insert(s)};this.onRerankClick=function(e){var t="top",i=$(e.target).up(".rerank_cta")||$(e.target);this.toggle();this.toggleSaveButton();if(e.target.hasClassName("close")){}else{t=i.hasClassName("rerank_cta_bottom")?"bottom":i.hasClassName("fixed")?"in-scroll":t;gtrack.track_events(this.category||"Buzz:Re-Rank","re-rank",t,null,null)}};this.onNumberFocus=function(e){var t=$(e.target),i=this.container.select(".tooltip_number_enter")[0];this.startItemNumber=t.getValue();i.removeClassName("hidden");var r=t.cumulativeOffset().left+t.getWidth()/2-i.getWidth()/2+8,a=t.cumulativeOffset().top-i.getHeight()-5;i.setStyle({left:0,top:0});i.setStyle({left:r+"px",top:a+"px"});this.showTooltip(i)};this.onNumberBlur=function(e){if(isNaN(parseInt($(e.target).getValue(),10))||parseInt($(e.target).getValue(),10)<0){$(e.target).setValue(this.startItemNumber)}var t=this.container.select(".tooltip_number_enter")[0];this.hideTooltip(t)};this.onNumberChange=function(e){var t,i,r,a,s=this.list.select(".subbuzz"),o=parseInt($(e.target).getValue(),10),n=s.length,l=$(e.target).up(".subbuzz");if(isNaN(o)||o<0){$(e.target).setValue(this.startItemNumber);return}o=o==0?1:o;this.hideTooltips();if(o>=n){if(this.startNum!=1){s[0].insert({before:l})}else{s[n-1].insert({after:l})}}else{i=s.indexOf(l)+1;a=this.startNum!=1?n-o:o-1;t=parseInt(s[a].select(".rank_numb").first().getValue(),10);if(this.startNum!=1){t=n-t}r=i>t?{before:l}:{after:l};s[a].insert(r)}this.animateRankedItem(l);this.toggleSaveButton();this.reorder();this.setTooltipsShown("number_enter")};this.onNumberKeyPress=function(e){var t=e.which||e.keyCode;if(t==Event.KEY_RETURN){this.onNumberChange(e)}};this.onNumberChangeDebounced=BF_UTIL.debounce(this.onNumberChange,300);this.onNumberKeyPressDebounced=BF_UTIL.debounce(this.onNumberKeyPress.bindAsEventListener(this),300);this.onDragElMouseUp=function(){$("reranked_list").select("div.dragging").each(function(t){t.removeClassName("dragging")})};this.onDragElMouseDown=function(e){var t=e.target;if(t.hasClassName("rank_numb")||t.hasClassName("fa-arrow-up")||t.hasClassName("fa-arrow-down")||t.hasClassName("fa-close")||t.hasClassName("fa-plus")){return}if($$("input.rank_numb:focus").length!=0){$$("input.rank_numb:focus")[0].blur();return}if(!t.hasClassName("subbuzz")){t=t.up(".subbuzz")}t.addClassName("dragging")};this.onDragStart=function(){this.hideTooltips();this.setTooltipsShown("top");this.setTooltipsShown("number")};this.onDragEnd=function(t){this.animateRankedItem(t);this.toggleSaveButton();var i=t.id.split("_")[1],r=this.list.select(".subbuzz").indexOf(t)+1;gtrack.track_events(this.category||"Buzz:Re-Rank","drag/re-order",i+":"+r,null,null)};this.animateRankedItem=function(t){new Effect.Highlight(t,{startcolor:"#fff88f",endcolor:"#ffffff",restorecolor:"#ffffff"
})};this.showTooltips=function(){var t=this;this.container.select(".tooltip").each(function(i){if(i.hasClassName("tooltip_number_enter")){return}t.showTooltip(i)})};this.hideTooltips=function(){var t=this;this.container.select(".tooltip").each(function(i){t.hideTooltip(i)})};this.hideTooltip=function(t){t.addClassName("fadeout");setTimeout(function(){if(!t.hasClassName("fadeout")){return}t.addClassName("hidden")},500)};this.showTooltip=function(t){var i=t.getAttribute("rel:data");if(this.getTooltipsShown(i)){return}if(t.hasClassName("fadeout")&&!t.hasClassName("hidden")){t.removeClassName("fadeout")}t.removeClassName("hidden");setTimeout(function(){t.removeClassName("fadeout")},1)};this.getFirstSubbuzzTitle=function(){var t=$$(".subbuzz h2")[0].innerHTML;return t};this.getSubwayRerankableQuizAnswer=function(){var t={};var i=this.getFirstSubbuzzTitle();t=subway_rerankable_quiz_matrix.initialize(i);this.setSubwayRerankableQuiz(t)};this.onSubmit=function(e){if(this.$submitBtn.hasClassName("disabled"))return false;gtrack.track_events(this.category||"Buzz:Re-Rank","publish",null,null,null);if(!(new BF_User).isLoggedIn()){this.showLoginModal()}else{if(this.isSubway){this.getSubwayRerankableQuizAnswer()}this.submit()}};this.submitName=function(e){this.username=this.container.select(".rerank_username")[0].getValue();if(!this.username){this.container.select(".rerank_username")[0].addClassName("error");this.container.select(".rerank_username_error_message")[0].show();return false}this.container.select(".login_modal .close_btn")[0].simulate("click");if(this.isSubway){this.getSubwayRerankableQuizAnswer()}this.submit()};this.showLoginModal=function(){this.container.select(".login_modal")[0].removeClassName("hidden");this.toggleOverlay();gtrack.track_events("Buzz:Re-Rank","[nc]imp:submit")};this.toggleSaveButton=function(){if(this.getOrder(this.list).join(",")==this.initOrderList){this.$submitBtn.addClassName("disabled")}else{this.$submitBtn.removeClassName("disabled")}};this.closeLoginModal=function(e){var t=$(e.target).up(".modal");t.addClassName("hidden");$("rerank_modal_overlay").addClassName("hidden");$$(".rerank_modal_overlay")[0].addClassName("hidden")};this.closeRerankableMode=function(){this.toggleOverlay();$$(".rerank_confirm_modal")[0].addClassName("hidden");this.hide();this.onReset()};this.toggleOverlay=function(){var t=$("rerank_modal_overlay");if(this.is_not_rerank_mode){if($$(".rerank_modal_overlay")[0].hasClassName("hidden")){$$(".rerank_modal_overlay")[0].removeClassName("hidden")}else{$$(".rerank_modal_overlay")[0].addClassName("hidden")}this.is_not_rerank_mode=false}else{if(t.hasClassName("hidden")){t.removeClassName("hidden")}else{t.addClassName("hidden")}}};this.submit=function(){var t=this;var i={action:"rank",buzz_id:BF_STATIC.campaignid,ranking:this.getOrder(this.list).join(","),display_name:this.getUserName()};if(this.container.down("#reranked_removed_list")){i.unrank=this.getOrder(this.container.down("#reranked_removed_list")).join(",")}$$("#rerank_modal_overlay .loader")[0].removeClassName("hidden");this.toggleOverlay();new Ajax.Request("/buzzfeed/rerank_subbuzz",{method:"get",parameters:i,onSuccess:t.onSuccess.bind(t),onFailure:t.onFailure.bind(t)})};this.onSuccess=function(t){var i=JSON.parse(t.responseText),r="Something went wrong, sorry";if(!i||i.success==0){this.toggleOverlay();this.showModal(this.templates.error_modal,"rerank_error_modal",{error:r});return false}var a=this.getUrl(i.id);var s=this;var o;if(this.isSubway){o="Buzz:Subway-Re-Rank"}new Ajax.Request("/buzzfeed/_short_url",{method:"get",dataType:"json",parameters:{url:encodeURI(a),buzz_id:11111111111},onComplete:function(t){var i=a;if(t.status=200){var r=t.responseText.evalJSON();if(r.short_url){i=r.short_url}}s.setSharedUrl(i);s.setCurrentUrl(s.getPureUrl(a));gtrack.track_events(o||"Buzz:Re-Rank","save-rerank",s.getQueryString(a));document.location.href=a}})};this.showModal=function(t,i,r){if(!$$("."+i).length){templ=new Template(t);r["amazon"]=this.isAmazon?"amazon-modal":"";html=templ.evaluate(r?r:{});$(document.body).insert(html);universal_dom.update($$("."+i)[0])}this.toggleOverlay();$$("."+i)[0].removeClassName("hidden")};this.showShare=function(){var t=this.getSharedUrl();if(!t||this.getCurrentUrl()!==this.getPureUrl(document.location.href)){return}this.setSharedUrl("");if($$(".rerank_share_modal").length){this.container.select(".rerank_share_modal")[0].remove()}if(this.isSubway){var i=this.getSubwayRerankableQuiz();this.showModal(this.templates.subway_rerank_quiz,"subway_rerankable_quiz",{name:this.data.display_name,url:t,title:i.result_title,description:i.description,image:i.image,static_root:BF_STATIC.static_root+"/images/subway_reranked_quiz/results/"});this.is_not_rerank_mode=true;this.toggleOverlay();this.insertSubwayReRankShareButtons(t,i.result_title);universal_dom.update($$(".subway_rerankable_quiz")[0])}else{this.showModal(this.templates.share_modal,"rerank_share_modal",{name:this.data.display_name,url:t});this.is_not_rerank_mode=true;this.toggleOverlay();this.insertShareButtons(t);universal_dom.update($$(".rerank_share_modal")[0])}};this.onScroll=function(){var t,r,a=document.viewport.getScrollOffsets().top,s=document.viewport.getHeight();if(i&&a>0){this.hideTooltips();this.setTooltipsShown("top");this.setTooltipsShown("number")}if(!this.$cta||i){return}var o=$$("#buzz_header .user-bg")[0]||$$("#buzz_header .reranked_info")[0];t=this.ctaTop<a&&this.ctaBottomTop+40>a+s;r=!this.pinnedThreshold||this.pinnedThreshold&&a>this.pinnedThreshold;if(t&&r){if(!this.pinnedThreshold){this.pinnedThreshold=this.ctaTop}this.isPinnedCTA=true;this.$cta.addClassName("fixed");o.setStyle({"margin-bottom":"70px"});this.setCtaLeft()}else{this.isPinnedCTA=false;this.$cta.removeClassName("fixed");this.clearCtaLeft();o.setStyle({"margin-bottom":""})}};this.insertSubwayReRankShareButtons=function(t,i){var r=$$(".subway_rerankable_quiz .share_buttons")[0];if(!r){return}var a=this.getQueryString(document.location.href),s="I got "+i+"! What your Subway toppings say about you?",o=$$("head title")[0].textContent;var n={divider:false,parentNode:r,url:t,blurb:s,gt_label:a};sharing.buttons.facebook_share(Object.extend(Object.clone(n),{gt_act:"share-rerank-facebook"}));sharing.buttons.twitter(Object.extend(Object.clone(n),{via:"subway",gt_act:"share-rerank-twitter"}));sharing.buttons.email(Object.extend(Object.clone(n),{url:t,method:"mailto",subject:o,body:s,gt_act:"share-rerank-email"}));sharing.buttons.pinterest(Object.extend(Object.clone(n),{description:s,url:t,gt_act:"share-rerank-pinterest"}));sharing.buttons.tumblr(Object.extend(Object.clone(n),{url:t,name:o,description:s,gt_act:"share-rerank-tumblr"}))};this.insertShareButtons=function(t){var i=$$(".rerank_share_modal .share_buttons")[0];if(!i){return}var r=this.getQueryString(t);var a={type:"ic_with_txt",divider:false,parentNode:i,url:t,blurb:this.isAmazon?"Create your own holiday wish list and tell your friends and family what you really want this year.":"I just re-ranked this BuzzFeed post. Did I nail it?",gt_label:r};sharing.buttons.facebook_share(Object.extend(Object.clone(a),{divider:true,title:this.isAmazon?"I Just Created My Perfect Holiday Wish List":"My very own take on "+BF_STATIC.buzz_name+"!",gt_act:"share-rerank-facebook"}));if(this.isAmazon){a.blurb="I just created my Amazon holiday wish list. Check it out and make your own!"}sharing.buttons.twitter(Object.extend(Object.clone(a),{hashtags:"",via:this.container.getAttribute("rel:twitter-via")||"buzzfeed",gt_act:"share-rerank-twitter"}))};this.signin=function(){BF_LOGIN_SIGNUP.show({locationName:"rerank",onSuccessLoginCb:function(){BF_LOGIN_SIGNUP.updateUserNav();if(t.isSubway){t.getSubwayRerankableQuizAnswer()}this.submit()}.bind(this)})};this.getUserName=function(){var t=new BF_User;var i=this.username?this.username:"";return t.isLoggedIn()?t.getUserInfo().display_name:i};this.getUrl=function(t){var i=sub_links.get_url(),r="",a="";if(i.include("#")){a=i.split("#")[1];i=i.split("#")[0];a=a?"#"+a:""}if(i.include("?")){r=i.split("?")[1];i=i.split("?")[0]}if(r){r=document.location.search?document.location.search+"&"+r:"?"+r}else{r=document.location.search}var s=i.split("/");var o=s.indexOf(BF_STATIC.username)+2;s.splice(o,s.length-o);return s.join("/")+"/"+t+r+a};this.getQueryString=function(t){var i=t.split("/");i.splice(0,i.indexOf(BF_STATIC.username)+2);return"/"+i};this.getPureUrl=function(t){if(t.include("#")){t=t.split("#")[0]}if(t.include("?")){t=t.split("?")[0]}return t};this.onFailure=function(t){$$("#rerank_modal_overlay .loader")[0].addClassName("hidden");alert("error");console.debug("fail",t)};this.reorder=function(){var i=this.list.select(".subbuzz");var r=this.list.select(".subbuzz").length;var a,s;i.each(function(i,o){a=o+1;s=r--;if(t.startNum!=1){$(i).select(".rank_numbering input")[0].setValue(s)}else{$(i).select(".rank_numbering input")[0].setValue(a)}i.removeClassName("first").removeClassName("last")});i[0].addClassName("first");i[i.length-1].addClassName("last")};this.onUp=function(t){var i=$(t.target).up(".subbuzz"),r=i.previous(),a=i.readAttribute("data-id"),s;if(!r){return}this.insertBefore(r,i);this.animateRankedItem(i);s=this.list.select(".subbuzz").indexOf(i)+1;gtrack.track_events(this.category||"Buzz:Re-Rank","arrow-up",a+":"+s,null,null)};this.onDown=function(t){var i=$(t.target).up(".subbuzz"),r=i.next(),a=i.readAttribute("data-id"),s;if(!r){return}this.insertBefore(i,r);this.animateRankedItem(i);s=this.list.select(".subbuzz").indexOf(i)+1;gtrack.track_events(this.category||"Buzz:Re-Rank","arrow-down",a+":"+s,null,null)};this.onRemove=function(t){this.removing=true;var i=$(t.target).up(".subbuzz");i.removeClassName("dragging");var r=i.id.split("_")[1];this.animateRemoving(i);gtrack.track_events("Buzz:Re-Rank","to-remove",r,null,null)};this.onRestore=function(t){var i=$(t.target).up(".subbuzz");$("reranked_list").insert(i);var r=i.id.split("_")[1];this.reorder();this.checkRemoveAbility();this.toggleSaveButton();this.initDragDrop();gtrack.track_events("Buzz:Re-Rank","restore",r,null,null)};this.onReset=function(){this.modeIsReady=false;this.build();this.checkRemoveAbility();this.toggleSaveButton();this.initDragDrop();universal_dom.update(this.container)};this.animateRemoving=function(t){this.hideTooltips();var i=this;t.setStyle({top:t.positionedOffset().top+"px"});t.addClassName("removing");if($(".removed-hint")!==null)$("removed-hint").remove();t.insert({before:'<div style="opacity:0;" id="removed-hint"><span>Item Removed</span><div></div></div>'});$("reranked_removed_list").down(".reranked_removed_list__header").insert({after:t});t.removeClassName("removing");t.removeClassName("dragging");t.setStyle({top:"",left:""});new Effect.Opacity("removed-hint",{from:0,to:1,duration:.5,afterFinish:function(){new Effect.Opacity("removed-hint",{from:1,to:0,duration:.5,afterFinish:function(){new Effect.Morph("removed-hint",{style:{height:"0px"},delay:0,duration:.5,afterFinish:function(t){t.element.remove();i.reorder();i.checkRemoveAbility();i.toggleSaveButton();i.initDragDrop();i.removing=false}})}})}})};this.checkRemoveAbility=function(){if($$("#reranked_list .subbuzz").length>1&&this.removable){$$(".reranked_list_holder")[0].addClassName("reranked-removing")}else{$$(".reranked_list_holder")[0].removeClassName("reranked-removing")}};this.insertBefore=function(t,i){this.hideTooltips();t.insert({before:i});this.toggleSaveButton();this.reorder()};this.toggle=function(){if(i){this.showModal(this.templates.confirm_modal,"rerank_confirm_modal",{label:this.isAmazon?"wish list":"re-ranking",category:this.category||"Buzz:Re-Rank"})}else{this.show()}};this.placeTooltips=function(){var t=this.list.select(".subbuzz")[1];var i=t.select(".rank_numbering input")[0],r=this.container.select(".tooltip_number")[0];r.setStyle({visibility:"hidden"}).removeClassName("hidden");var a=i.cumulativeOffset().left,s=i.cumulativeOffset().top+i.getHeight()+5;r.setStyle({left:a+"px",top:s+"px"});r.addClassName("hidden").setStyle({visibility:"visible"})};this.show=function(){this.render();this.initDragDrop();this.reorder();var t=["pin_bd","pin_bg","shares-copy-link"];$$("body>div").each(function(i){if(i.hasClassName("rerankable_container")||i.hasClassName("rerank_confirm_modal")||i.hasClassName("rerank_error_modal")||i.hasClassName("spinner_container")){return}if(i.id&&t.indexOf(i.id)!=-1){return}i.addClassName("hidden_by_rerank")});this.container.removeClassName("hidden");window.scrollTo(0,0);this.placeTooltips();i=true;this.showTooltips()};this.hide=function(){$$(".hidden_by_rerank").each(function(t){t.removeClassName("hidden_by_rerank")});this.container.addClassName("hidden");i=false;this.onScroll()}};if(!rerankable!="1"){var rerankable=new Rerankable;BuzzLoader.register(rerankable.init.bind(rerankable),1)}(function(t){if(t.getGlobal("comment_links"))return;var $=t.getGlobal("$");var i=t.getGlobal("$$");var r=t.getGlobal("BuzzLoader");var a=t.getGlobal("objExists");var s;var o=function(){this.box_id;this.init=function(){s=t.getGlobal("universal_dom");s.assign_handler({bucket:"share-social",handler:n.show_share_box,event:"click"});s.assign_handler({bucket:"share-comment",handler:n.show_share_box,event:"click"});s.assign_handler({bucket:"fb-share-comment",handler:n.comment_share,event:"click"});s.assign_handler({bucket:"tw-share-comment",handler:n.comment_share,event:"click"});s.assign_handler({bucket:"link-share-comment",handler:n.comment_share,event:"click"});s.assign_handler({bucket:"em-share-comment",handler:n.comment_share,event:"click"});s.assign_handler({bucket:"pin-share-comment",handler:n.comment_share,event:"click"});n.fix_box_height();if(document.URL.include("?comment")){var r=document.URL.toQueryParams();n.highlite(r.comment)}if(document.URL.include("?commentid")){var r=document.URL.toQueryParams();n.highlite(r.commentid)}document.observe("scroll",n.hide_share_box);document.observe("click",n.click_hide_share_box);i(".comment-share .share-icon").each(function(t){t.observe("click",n.comment_share)})};this.fix_box_height=function(){i(".comment-share").each(function(t){if(t.select(".share-icon#pinterest").length==0)$(t).setStyle({height:"120px"})})};this.click_hide_share_box=function(e){try{if(typeof e.target=="undefined"||!isHTMLElement(e.target)){console.log("Not html element. SVG fix.");return}if(!$(e.target).up(".share")&&!$(e.target).hasClassName("share")&&!$(e.target).up(".comment-share")&&!$(e.target).hasClassName("comment-share")){n.hide_share_box()}}catch(e){console.error(e)}};this.hide_share_box=function(){if(n.box_id){var t=$(n.box_id).select(".comment-share").first(),i=$(n.box_id).select(".comment-social").first(),r=$(n.box_id).select(".comment-lovehate-buttons").first(),a=$(n.box_id).select(".copy-link").first();if(t)t.addClassName("hidden");if(i)i.addClassName("hidden");if(r)r.addClassName("hidden");if(a)a.remove();n.box_id=null}};this.show_share_box=function(e){var t=e.target.up("a");if(t&&typeof t!=undefined)var i=JSON.parse(t.getAttribute("rel:bf_bucket_data"));var r=i["share-comment"].id;if(!($(e.target).up("#link")||$(e.target).up(".copy-link")))n.hide_share_box();var a=$(t).up("li");if(typeof a=="undefined"||!("className"in a))return false;var s=a.className;s.split(" ").each(function(t){var i=$(r).select(".comment-"+t).first();if(typeof i!=="undefined"){if(!n.box_id){n.box_id=r;i.removeClassName("hidden");if(t==="share"||t==="social"){var s={left:Number(a.positionedOffset()[0]),top:Number(a.positionedOffset()[1]),height:Number(a.getHeight()),width:Number(a.getWidth())};i.setStyle({left:s.left-4+"px",top:s.top+s.height+"px",height:"auto"})}}}})};this.highlite=function(t){var i=$(t);if(i){if(i.nodeName=="DIV")i=i.parentNode;i.select("div.what")[0].style.border="2px solid yellow";i.scrollTo();setTimeout(function(){i.scrollTo()},2e3)}else{}};this.comment_share=function(e){var t=e.target.up();var r=JSON.parse(t.getAttribute("rel:share_data"));var a=$(r.id);var s=a.getAttribute("rel:comment_id");var o=n.get_url(s);var l,u,_;var f=a.getAttribute("rel:data");f=JSON.parse(f);if(a&&a.select(".blurb")[0])l=a.select(".blurb")[0].textContent;if(f.type=="image")_=a.select(".image img")[0].src;if(f.type=="video"){if(a.select(".video iframe").length){_=a.select(".video iframe")[0].src}else{_=a.select(".video embed")[0].src}}if(!u&&i('meta[property="og:title"]').length>0)u=i('meta[property="og:title"]')[0].attributes["content"].value;if(!l&&i('meta[property="og:description"]').length>0)l=i('meta[property="og:description"]')[0].attributes["content"].value;if(!_&&i('meta[property="og:image"]').length>0)_=i('meta[property="og:image"]')[0].attributes["content"].value;if(u.indexOf("Contribution To: ")<0)u="Contribution To: "+u;if(t.id=="facebook"){o=encodeURIComponent(o);u=encodeURIComponent(u);l=encodeURIComponent(l);_=encodeURIComponent(_);window.open("http://facebook.com/sharer/sharer.php?s=100&p[url]="+o+"&p[title]="+u+"&p[images][0]="+_+"&p[summary]="+l,"_blank","width=600, height=260");n.hide_share_box()}else if(t.id=="twitter"){l=encodeURIComponent(l.length>120?l.substr(0,115)+"...":l);o=encodeURIComponent(o);window.open("https://twitter.com/intent/tweet?text="+l+(typeof hashtags!="undefined"?"&hashtags="+hashtags:"")+"&url="+o,"_blank","width=600,height=400");n.hide_share_box()}else if(t.id=="email"){o=encodeURIComponent(o);u=encodeURIComponent(u);l=encodeURIComponent(l);window.open("mailto:?subject="+u+"&body="+l+" "+o,"_self");n.hide_share_box()}else if(t.id=="link"){$(a).select(".copy-link").each(function(t){$(t).remove()});$(a).select(".comment-share").each(function(t){$(t).insert('<div class="copy-link"><span>Share This Link</span><input type="text" value="'+o+'" /></div>')})}else if(t.id=="pinterest"){o=encodeURIComponent(o);l=encodeURIComponent(l);_=encodeURIComponent(_);window.open("http://pinterest.com/pin/create/button/?media="+_+"&url="+o+"&description="+l,"_blank","width=600,height=400");n.hide_share_box()}};this.get_url=function(i){var r=t.getGlobal("pound");if(typeof r!="undefined"){return r.urls.unescaped.queryStringOnly([],[["comment",i]])}var a=[];var s={};if(!!document.location.search){a=document.location.search.substr(1,document.location.search.length).split("&");for(var o=0,n=a.length;o<n;o++){var l=a[o].split("=");if(l.length==2){s[l[0]]=l[1]}else{s[l[0]]=""}}}s["comment"]=i;var a=[];for(var o in s){if(s.hasOwnProperty(o)){a.push(o+"="+s[o])}}var u="?"+a.join("&");return document.location.protocol+"//"+document.location.host+document.location.pathname+u+document.location.hash}};var n=new o;t.setGlobal("comment_links",n);r.register(n.init,1)})(bfjs);BF_STICKING_RIGHTCOL=function(){this.init=function(){(function t(){if($$(".wide-content").length>0||$$(".Content.Column1").length>0)return;if($$(".js-rightcol--sticking, .js-rightcol--control").length){if($$(".js-rightcol--sticking").length){this.el=$$(".js-rightcol--sticking").last();if(this.el_bot()>this.margin_bot())return;Event.observe(window,"scroll",this.onScroll.bind(this));this.onScroll.call(this)}}else setTimeout(t,200)}).call(this)};this.el_bot=function(){return this.el.getHeight()+this.el.positionedOffset().top};this.margin_bot=function(){return $$(".bottom_shares, #social-actions, #preFacebookComment").filter(function(t){if(t.visible()&&!t.hasClassName("hidden"))return true}).last().positionedOffset().top};this.onScroll=function(){var t=this.el_bot();var i=document.viewport.getScrollOffsets().top+document.viewport.getHeight();var r=i-t;if(r>150||parseInt(this.el.style.marginTop)>0){this.el.style.marginTop=(parseInt(this.el.style.marginTop)||0)+(r-150)+"px";if(parseInt(this.el.style.marginTop)<0)this.el.style.marginTop=0}var a=this.margin_bot();t=this.el_bot();r=a-t;if(t>a){this.el.style.marginTop=(parseInt(this.el.style.marginTop)||0)+r+"px"}}};var bf_sticking_rightcol=new BF_STICKING_RIGHTCOL;BuzzLoader.register(function(){bf_sticking_rightcol.init()},1);Array.isArray||(Array.isArray=function(t){return"object"===typeof t&&"[object Array]"===Object.prototype.toString.call(t)});var CountView=function(){this._elems_arr=[];this._time_interval=250;this._callback=null;this._interval_id=null};CountView.prototype=function(){function t(t){t=t||window;if(t.pageXOffset!=null)return{x:t.pageXOffset,y:t.pageYOffset};var i=t.document;if(document.compatMode=="CSS1Compat")return{x:i.documentElement.scrollLeft,y:i.documentElement.scrollTop};return{x:i.body.scrollLeft,y:i.body.scrollTop}}function i(t){t=t||window;if(t.innerWidth!=null)return{w:t.innerWidth,h:t.innerHeight};var i=t.document;if(document.compatMode=="CSS1Compat")return{w:i.documentElement.clientWidth,h:i.documentElement.clientHeight};return{w:i.body.clientWidth,h:i.body.clientWidth}}var r=function(r){var a=r.offsetTop;var s=r.offsetLeft;var o=r.offsetWidth;var n=r.offsetHeight;while(r.offsetParent){r=r.offsetParent;a+=r.offsetTop;s+=r.offsetLeft}var l=t();var u=i();return a<l.y+u.h&&s<l.x+u.w&&a+n>l.y&&s+o>l.x};var a=function(){for(var t=0,i=this._elems_arr.length;t<i;t++){var a=this._elems_arr[t];if(r.call(this,a["elem"])){a["time"]+=this._time_interval;a["active"]=true}else{a["active"]=false}}if(this._callback){this._callback(this._elems_arr)}};return{set_elems_arr:function(t,i){if(!Array.isArray(t)){t=[t]}for(var r=0,a=t.length;r<a;r++){this._elems_arr.push({elem:$(t[r]),time:0,active:false})}},get_elems_stat:function(){return this._elems_arr},start_count:function(t,i){if(t){this._time_interval=t}if(i){this._callback=i}var r=a.bind(this);r();this._interval_id=setInterval(r,this._time_interval)},stop_count:function(){if(this._interval_id){clearInterval(this._interval_id);this._interval_id=null}}}}();var HeatMap=function(){var t,i,r={},a=250,s=18e5,o=new CountView,n="/buzzfeed/api/v1/heatmap/buzz/",l=document.location.search.toQueryParams(),u=l.hasOwnProperty("heatmap_debug");seleniumMode=l.hasOwnProperty("selenium");var _=function(){t=BF_STATIC.campaignid;i=$$(".buzz_superlist_item");gtrack.track_events("[ttp]:heatmap_tracking","[nc]initialized","","",true);if(BF_STATIC.bf_env!="live")console.log("HEATMAP: Tracking stats for this visit.");if(window.onpagehide||window.onpagehide===null){p(window,"pagehide",h)}else{p(window,"beforeunload",h)}o.set_elems_arr(i);o.start_count(a,f);if(acl.user_can("options_heatmap")){m()}};var f=function(t){if(u){for(var i=0,r=t.length;i<r;i++){var a=t[i]["elem"];var s=t[i]["time"];var o=t[i]["active"];if(o){var n=c(a);console.log("unit_number: "+n);var l="green"}else{var l="#C70000"}$(a).setStyle({backgroundColor:l})}}};var c=function(t){var i=null,r=$(t.id);if(r){i=r.readAttribute("rel:buzz_num")}return i};var d=function(t){var i=t.id;if(matches=i.match(/(\w+)_(\d+)_(\d+)/)){return matches[3]}return null};var b=function(i){var r=!i||!i.hasOwnProperty("type")?"current":i.type;if(r!=="historical"){var a=o.get_elems_stat();var l=[];for(var u=0,_=a.length;u<_;u++){var f=a[u]["elem"];var b=a[u]["time"];var h=c(f);if(h!=null){b=b>s?s:b;var m=d(f);l.push({buzz_id:t,sub_buzz_id:m,position:h,duration:b,type:"sub_buzz_impression"})}}return l}else{(new BF_Request).request(n+t,{method:"get",onSuccess:i.onSuccess,onFailure:i.onFailure})}};var h=function(){if(t){gtrack.track_events("[ttp]:heatmap_tracking","[nc]tracking-started","","",true);var i=b();for(var r=0;r<i.length;r++){pixiedust.push(i[r])}pixiedust.flush();if(BF_STATIC.bf_env!="live")console.log("HEATMAP: Fired tracking.",i);gtrack.track_events("[ttp]:heatmap_tracking","[nc]tracking-complete","","",true)}};var m=function(){var r=$("buzz_sub_buzz"),a=r.className,s=a.match("suplist"),o=a.match("suplist_none"),n=function(t){var a=[],s=0,n=l.heatmap_display==="time"?"heatmap-time":"heatmap-views",u=function(t){var i=Math.floor(t/(60*60)),r=t%(60*60),a=Math.floor(r/60),s=r%60,o=Math.ceil(s),n=function(t){return t<10?"0"+t:t};return n(i)+":"+n(a)+":"+n(o)},_=function(t,i){t.heatmapValue=n==="heatmap-time"?t.duration:t.views,t.avgDurationInSeconds=t.views!=0?Math.round(parseInt(t.duration)/10)/100/t.views:0,t.retentionRate=h!=0?Math.round(parseInt(t.views)*100/h):0;t.dropOff=i!=null?i.retentionRate-t.retentionRate:0;return t},f=function(){return{retentionRate:0,dropOff:0,avgDurationInSeconds:0,heatmapValue:0}},c=function(t,i){var r='<div class="sb-stats arrow_box">                <div class="sb-views"><div class="sb-val">'+i.retentionRate+'%</div><div class="sb-label">VIEWED THIS</div></div>                <div class="sb-drop-off"><div class="sb-val">'+i.dropOff+'%</div><div class="sb-label">DROP OFF</div></div>                <div class="sb-time"><div class="sb-val">'+u(i.avgDurationInSeconds)+'</div><div class="sb-label">AVG TIME</div></div></div>';t.insert(r);s++;t.writeAttribute("rel:"+n,i.heatmapValue);a.push(t)},b=function(){return $(this).readAttribute("rel:"+n)};var h=0;i.each(function(i,r){itemId=d(i),matchIndex=[],itemStats=t.findAll(function(t,i){if(t.sub_buzz_id!==itemId)return false;matchIndex.push(i);return true});if(matchIndex.length){itemStats.each(function(t){h=parseInt(t.views)>h?parseInt(t.views):h})}});prevStatItem=null;i.each(function(i,r){var a,n=d(i),l=[],u=t.findAll(function(t,i){if(t.sub_buzz_id!==n)return false;l.push(i);return true});if(l.length){l.each(function(i){t.splice(i,1)});u.each(function(t){if(+t.position===s+1){t=_(t,prevStatItem);c(i,t);prevStatItem=t;throw $break}})}else{a=!o&&(i.select(".buzz_superlist_number_inline").length||i.select(".buzz_superlist_number").length);if(o||a){c(i,f())}}});r.addClassName(n)};if(!t||!s)return;b({type:"historical",onSuccess:function(e){var t=e.responseText.evalJSON(),i=t.stats;if(Object.prototype.toString.apply(i)!=="[object Array]"||!i.length){if(BF_STATIC.bf_env!="live")console.log("HEATMAP: No stats returned for this post.");return}n(i)},onFailure:function(e){switch(e.status){case 400:if(BF_STATIC.bf_env!="live")console.log("HEATMAP: Invalid request. "+e.responseJSON.error);break;case 404:if(BF_STATIC.bf_env!="live")console.log("HEATMAP: No stats returned for this post.");break;case 500:if(BF_STATIC.bf_env!="live")console.log("HEATMAP: Error retrieving stats.");break}}})};var p=function(t,i,r){if(t){if(t.addEventListener){t.addEventListener(i,r,false)}else if(t.attachEvent){t.attachEvent("on"+i,r)}}};return{init:function(){try{_()}catch(t){if(BF_STATIC.bf_env!="live")console.error(t)}},get_stat:function(){return b()},save_stat:function(){return h()}}}();if(typeof BF_STATIC!="undefined"&&typeof BF_STATIC.country_locale!="undefined"){window.___gcfg={lang:BF_STATIC.country_locale}}BF_UTIL.createScript({url:"https://apis.google.com/js/client:plusone.js?onload=GCallback"});if(BF_STATIC.bf_test_mode&&BF_STATIC.bf_env=="dev"){(function(){var t=document.createElement("script");t.type="text/javascript";t.async=true;t.src="https://apis.google.com/js/client:plusone.js";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(t,i)})()}function GCallback(){EventManager.fire("gplus:api-loaded")}var HeatColor=function(t,i,r){var a={elementFunction:function(){return $(this)},minval:0,maxval:0,lightness:.75,colorStyle:"roygbiv",reverseOrder:false};if(r){Object.extend(a,r)}var s={findcolor:function(t,i,r){var s=i===r?1:(t-i)/(r-i);var o=a.colorStyle=="roygbiv"?.5*s+1.7*(1-s):s+.2+5.5*(1-s);var n=128;var l=2*Math.PI;var u=o+s*l;u=a.colorStyle!="roygbiv"?-u:u;var _=this.process(Math.floor((Math.cos(u)+1)*n));var f=this.process(Math.floor((Math.cos(u+Math.PI/2)+1)*n));var c=this.process(Math.floor((Math.cos(u+Math.PI)+1)*n));return"#"+_+f+c},process:function(t){var i=Math.floor(t+a.lightness*(256-t));var r=i.toString(16);r=r.length==1?"0"+r:r;return r},setMaxAndMin:function(t){var r=[];t.each(function(t){r.push(i.apply(t))});r=r.sort(function(t,i){return t-i});a.maxval=!a.reverseOrder?r[r.length-1]:r[0];a.minval=!a.reverseOrder?r[0]:r[r.length-1]}};if(!a.minval&&!a.maxval)s.setMaxAndMin(t);else if(a.reverseOrder){var o=a.minval;a.minval=a.maxval;a.maxval=o}t.each(function(t){var r=i.apply(t);var o=s.findcolor(r,a.minval,a.maxval);var n=a.elementFunction.apply(t);if(n.nodeType==1)n.setStyle({backgroundColor:o});else if(n.nodeType==3)n.setStyle({color:o})});return this};BFContribute=function(){var t=this;this.ERR='Sorry, there was a problem processing your request. If it persists please <a href="http://www.buzzfeed.com/about/contact">contact support</a>.';this.ERR_DUPE="Woops. It looks like you've already contributed this response.";this.TEXT_ERR="Please add your message.";this.IMAGE_ERR="Please add your image and a description.";this.IMAGE_TOO_LARGE="Max image upload size is 2 megabytes.";this.VIDEO_ERR="Please add a valid video link and a description.";this.QUOTE_ERR="Please add a quote and an author.";this.LINK_ERR="Please add a link and a description.";this.ERR_BLIST="An error has occurred processing a request from your IP. If it continues, contact error@buzzfeed.com.";this.type_list=new Array("text","video","image","link");this.buzz_data={};this.subContributeParent=0;this.main_buzz_id;this.init=function(){bf_login.init();var t=(new BF_User).getUserInfo();if(t&&typeof t.p_disable_comment!="undefined"&&t.p_disable_comment=="true"){$$("#contribute-box").each(function(t){t.style.display="none"});return true}if(!$("contribute-form"))return;var r=function(t){t.stop();bf_contribute.submit()}.bind(this);if($("contribute-id"))bf_contribute.main_buzz_id=$("contribute-id").value;$("add-something-interesting").observe("click",function(t){t.stop();bf_contribute.reset_contribute_box()});$$(".respond").invoke("observe","click",bf_contribute.observeRespond);$("contribute-form").observe("submit",r);$("contribute-submit").show();$("contribute-post").observe("click",function(e){$("submit-mode").value="save"});$("contribute-submit").observe("click",function(e){$("submit-mode").value="preview"});var a=function(t){return function(t){t.stop();bf_contribute_toggleTabs("on");if($("respond"))$("respond").removeClassName("previewing");$("contribute-message").update("");$("contribute-message").hide();$("contribute-preview").hide();$("contribute-form").reset();$("contribute-cancel").hide();$("image-button").value="Select Image...";$("contribute-post").hide();$("contribute-submit").value="Preview";$("contribute-preview-content").update()}};$("contribute-cancel").observe("click",a(true));$("contribute-close-success-box").observe("click",function(e){$("contribute-success").hide()});bf_contribute.goforit_default();var s=function(e){e.stop();type=e.element().id.match(/(^\w+)/)[0];bf_contribute.disableCurrent();var t=type+"-contribute-activate";bf_contribute.buttonToggle(t);var i="contribute-"+type+"-form";bf_contribute.enableForm(i);if($("big-pink-arrow"))$("big-pink-arrow").style.display="none";var r="@a:Submit; @d:"+type+"; @l:Contributions;";$("contribute-post").writeAttribute("data-bfa",r);return false}.bind(this);for(i=0;i<bf_contribute.type_list.length;i++){var o=bf_contribute.type_list[i]+"-contribute-activate";var n=$(o);if(n){n.observe("click",function(e){e.stop();s(e);return false})}}$("create_full_post_toggle").observe("click",function(e){e.stop();$$(".full-post-field").invoke("show");$("create_full_post_toggle").hide();$("create_simple_post_toggle").show()});$("create_simple_post_toggle").observe("click",function(e){e.stop();$$(".full-post-field").invoke("hide");$("create_full_post_toggle").show();$("create_simple_post_toggle").hide()});var l=$("video-embed");if(l){$("video-embed").observe("mouseup",function(){bf_contribute.setVideo()}.bindAsEventListener(this));$("video-embed").observe("keyup",function(){bf_contribute.setVideo()}.bindAsEventListener(this))}var u=$("image-button");var _=$("photo-editor-button");if(u&&Prototype.Browser.IE&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))==6){var f=function(e){e.stop();$("image-preview-div").show();$("image-preview").hide();if($("user-loading"))$("user-loading").show();$("user-image-edit-iframe").src="/static/images/public/spinners/big_on_eee.gif";$("user-image-edit").addClassName("bf_dialog_confirm");BF_UI.showDialog("user-image-edit");$("user-image-edit-iframe").src="/buzzfeed/_edit_user_contribution_image?action=imageform";
}.bindAsEventListener(this);u.observe("click",f);u.show();if(_)_.hide()}if(_){var c=function(e){e.stop();if($("user-loading"))$("user-loading").show();$("user-image-edit-iframe").src="/static/images/public/spinners/big_on_eee.gif";$("user-image-edit").removeClassName("bf_dialog_confirm");BF_UI.showDialog("user-image-edit","Edit a Photo");var t="";if($("photo_editor_image"))t="&overlay="+escape($F("photo_editor_image"));$("user-image-edit-iframe").src="/buzzfeed/_edit_photo_editor_image?action=imageform"+t}.bindAsEventListener(this);_.observe("click",c)}if($("video-supported-text")){$("video-supported-text").update(BF_VIDEO_TYPES_STRING)}bf_contribute.update_contribs()};this.reset_contribute_box=function(){$("contribute-form").reset();bf_contribute_toggleTabs("on");$("contribute-cancel").hide();$("contribute-post").hide();$("contribute-submit").value="Preview";$("contribute-preview-content").update();$("contribute-parent-id").setValue(0);var t=$("add-something-interesting");t.parentNode.insertBefore($("contribute-box"),t.nextSibling);t.parentNode.insertBefore($("contribute-preview-content"),t.nextSibling);bf_contribute.subContributeParent=0};this.update_contribs=function(){var t=$$(".contribution-list .what .blurb");t.each(function(t){bf_contribute.create_list_link($(t))})};this.create_list_link=function(t){if(!t||!bf_contribute.buzz_data)return;if(!bf_contribute.fetched_buzz)bf_contribute.fetch_buzz_data();var a=$(t).innerHTML;var s=new RegExp("(?!>)(#[0-9]+)(?!</a>)","g");var o=new RegExp("[^0-9]+","g");var n=bf_contribute.buzz_data;var l=[];while(a.match(s)){r=a.match(s);a=a.replaceAll(r[0],"");key=r[0].replace(o,"");if(n.hasOwnProperty(key)){var u="";u='<a class="scroll" href="javascript:void(0);" onclick="BF_Effect.ScrollIntoView('+n[key].eid+')">';$(t).innerHTML=$(t).innerHTML.replaceAll(r[0],u+"#"+key+"</a>");if(n[key].btype.match("image|video")&&n[key].img&&l.indexOf(key)<0&&!n[key].is_graphic){$(t).innerHTML=$(t).innerHTML+u+"<img src='"+n[key].img+"' class='list_img_thumb'></a>";l.push(key)}else if(n[key].btype.match("grid_row")&&n[key].img&&l.indexOf(key)<0){var _=u.replace('class="scroll"','class="scroll contrib_grid_row"');for(i=0;i<n[key].img.length;i++){_=_+"<img src='"+n[key].img[i]+"' class='list_grid_row_thumb'>";l.push(key)}_="<div>"+_+"</div>";$(t).innerHTML=$(t).innerHTML+_+"</div></a>"}}}};this.fetch_buzz_data=function(){$$(".buzz_superlist_item").each(function(t){var i=$(t).down(".buzz_superlist_number, .buzz_superlist_number_inline");if(!i)return false;var r=i?i.innerHTML.replace(".",""):"";var a=$(t).down(".sub_buzz_content")?$(t).down(".sub_buzz_content"):"";var s=$(t).className;var o=false;try{o=a.down(".graphic_image_wrapper")}catch(e){}bf_contribute.buzz_data[r]={eid:$(t).id,btype:s.match("image")?"image":s.match("video")?"video":s.match("grid_row")?"grid_row":"na",is_graphic:o};if(bf_contribute.buzz_data[r].btype.match("image")){var n=$(a).down("img");bf_contribute.buzz_data[r].img=n.hasAttribute("rel:bf_image_src")&&!n.src.match(/_preview.gif/)?n.getAttribute("rel:bf_image_src"):n.src}else if(bf_contribute.buzz_data[r].btype.match("video")){var l=$(a).down(".video-embed-area");if(l)bf_contribute.buzz_data[r].img=l.getAttribute("rel:thumb")}else if(bf_contribute.buzz_data[r].btype.match("grid_row")){bf_contribute.buzz_data[r].img=[];$(t).select(".grid_cell img").each(function(t){bf_contribute.buzz_data[r].img.push(t.hasAttribute("rel:bf_image_src")&&!t.src.match(/_preview.gif/)?t.getAttribute("rel:bf_image_src"):t.src)})}});bf_contribute.fetched_buzz=1};this.getFormParams=function(t){var i={form:t,buzz_id:$F("contribute-id"),parent_id:$F("contribute-parent-id"),real_parent_id:$F("contribute-real-parent-id"),category:$F("contribute-category")};switch(t){case"text":var r=$F("text-text");if(!r){this.setErrMessage(this.TEXT_ERR);bf_contribute_toggleTabs("on");if($("contribute-post"))$("contribute-post").hide();return false}Object.extend(i,{blurb:r});break;case"image":var r=$F("image-text").strip();var a=TT_Filters.html_noentities($F("image-image").strip());var s=bf_contribute.form=="mixedpic"||bf_contribute.form=="mixedpic_wide"?true:false;var o=TT_Filters.html_noentities(TT_Filters.link($F("image-credit").strip()));if(o&&!o.match(/^https?:\/\//))o="http://"+o;if(o)o=this.url_entities(o);if(!a||!r&&!s){this.setErrMessage(this.IMAGE_ERR);if($("contribute-post"))$("contribute-post").hide();if(a)$("image-preview-div").show();bf_contribute_toggleTabs("on");return false}if($F("submit-mode")=="save")$("image-preview").hide();Object.extend(i,{blurb:r,url:a,credit_url:o,height:this.image_height,width:this.image_width});break;case"video":var r=TT_Filters.html_noentities($F("video-text").strip());var n=TT_Filters.link($F("video-embed-url").strip());if(typeof n=="undefined")n="";if(typeof r=="undefined")r="";if(n&&!n.match(/^https?:\/\//))n="http://"+n;if(!r||!n){this.setErrMessage(this.VIDEO_ERR);bf_contribute_toggleTabs("on");if($("contribute-post"))$("contribute-post").hide();return false}Object.extend(i,{blurb:r,url:n});break;case"quote":var r=TT_Filters.html_noentities($F("quote-text").strip());var l=TT_Filters.html_noentities($F("quote-attribution").strip());if(!r||!l){this.setErrMessage(this.QUOTE_ERR);if($("contribute-add-your-response-heading"))$("contribute-add-your-response-heading").show();bf_contribute_toggleTabs("on");if($("contribute-post"))$("contribute-post").hide();return false}Object.extend(i,{blurb:r,author:l});break;case"link":var r=TT_Filters.html_noentities($F("link-text").strip());var n=TT_Filters.link($F("link-url").strip());if(!n.match(/^https?:\/\//))n="http://"+n;n=this.url_entities(n);if(!r||!n){this.setErrMessage(this.LINK_ERR);bf_contribute_toggleTabs("on");if($("contribute-post"))$("contribute-post").hide();return false}Object.extend(i,{blurb:r,url:n});break}return i};this.submit=function(t,i){var r=new BF_User;if(!$("contribute-post"))return false;if(r.isLoggedIn()&&(this.type!="image"||$F("image-image")))$("contribute-post").show();$("contribute-message").hide();$("contribute-box").show();if(this.login_enable_form){this.login_enable_form=false;this.enableForm("contribute-"+this.type+"-form")}else{if($F("submit-mode")=="preview"){$("contribute-cancel").show();$("contribute-submit").value="Preview Again";if($("video-preview"))$("video_preview").hide()}if(i){$("submit-mode").value="preview"}else{i=this.getFormParams(this.type)}if(i!==false){if($F("submit-mode")=="save"){this.postit(i,t)}else{this.previewFromServer(i,t)}}}};this.previewFromServer=function(t,i){$("saving-status").show();var r=new BF_User;if(r.isLoggedIn()){var a=r.getUserInfo();t.username=a.username;t.display_name=a.display_name?a.display_name:a.username;if(a.image&&a.image!=null&&a.image!="null"){t.user_image=a.image}else{t.user_image="/static/images/public/defaults/user_large.jpg"}}else{t.username="You";t.user_image="/static/images/public/defaults/user_large.jpg"}t.action="process";t.template="contribution";t.preview="true";t.since_minutes="1";t.static_root=BF_STATIC.static_root;t.image_root=BF_STATIC.image_root;if(bf_contribute.subContributeParent>0){t.child_comment="1"}var s=new BF_Request;s.request("/buzzfeed/_template",{method:"post",parameters:t,onSuccess:function(t){$("contribute-post").disabled=false;var r=new BF_User;var a=t.responseText;var s=a.evalJSON();if(s.success){var o=s.snippet;if(!(r.isLoggedIn()||i)){$("contribute-post").show()}this.preview_contribution(o,s)}else{var n="";for(var l in s.errors){if(n!="")n+=", ";n+=s.errors[l]}this.setErrMessage(n);$("contribute-post").hide()}$("saving-status").hide();document.fire("contribute:previewFromServerOk")}.bind(this),onFailure:function(t){s.alert("Error contacting server");$("saving-status").hide();document.fire("contribute:previewFromServerError")},bf_auth:true})};this.preview_contribution=function(t,i){var r=new BF_User;if($("big-pink-arrow"))$("big-pink-arrow").style.display="none";if($("respond")){$("respond").addClassName("previewing")}if($("image-preview"))$("image-preview").hide();$("contribute-preview-content").update(t.toString());bf_contribute_toggleTabs("off");if($("who-preview")){console.warn("who-form is obsolete?")}if(r.isLoggedIn()){if((new BF_User).getUserInfo().f_ad=="true"){$$("#contribute-preview-content .contrib")[0].addClassName("ad")}}if(this.type=="video"){var a=$F("video-embed-url");if(a){if(bf_contribute.subContributeParent>0){var s=BF_initSwfObject(a,{width:575,height:375});s.write("video_buzz_element_"+i.video_preview_uri)}else{var s=BF_initSwfObject(a,{width:605,height:505});s.write("video_buzz_element_"+i.video_preview_uri)}}}bf_contribute.create_list_link($$("#contribute-preview-content .what .blurb")[0])};this.postit=function(i,r){var a=new BF_User;if(!a.isLoggedIn()&&!r){BF_LOGIN_SIGNUP.show({locationName:"contribution",onSuccessLoginCb:function(t,i){this[this.type+"Contribution"]&&typeof this[this.type+"Contribution"]==="function"&&this[this.type+"Contribution"](i);location.reload()}.bind(t),delayedCbConf:[{obj:"bf_contribute",fn:"previewAndPostIt",params:[i]}]});return false}$("saving-status").show();this.params=i;var s=function(t){this._response(t);document.fire("contribute:postitOk")}.bindAsEventListener(this);var o=function(i){if(i.status===401){BF_Request.debug_log(i.request.url);BF_LOGIN_SIGNUP.show({locationName:"contribution",onSuccessLoginCb:function(t,i){this[this.type+"Contribution"]&&typeof this[this.type+"Contribution"]==="function"&&this[this.type+"Contribution"](i);location.reload()}.bind(t),delayedCbConf:[{obj:"bf_contribute",fn:"previewAndPostIt",params:[this.params]}]})}else{this.server_error(i);document.fire("contribute:postitError")}}.bindAsEventListener(this);if(i.form=="mixedpic"&&(i.id==1860073||i.id==1927310||i.id==1984234)){this.use_minisuper(i)}else{(new BF_Targetting_Pixel).add("comment");i.delete_images="no";var n={method:"post",parameters:i,onSuccess:s,onFailure:o};var l=(new BF_User).getUserInfo();if(l.username)n.needsToken=true;var u=new BF_Request;$("contribute-post").disabled=true;u.request("/buzzfeed/_commentribute",n);$("contribute-submit").value="Preview"}};this._response=function(t){if($("contribwhat_"))$("contribwhat_").show();$("saving-status").hide();this.goforit_default();var i=JSON.parse(t.responseText);if(i.updated||i.success&&i.success==1){if(objExists(i.last_active))BFW_Util.updateInfoCookie({last_active:i.last_active});if(this.params.form=="text")this.params.form_string="responded ";if(this.params.form=="link")this.params.form_string=" added a link ";if(this.params.form=="image")this.params.form_string=" added an image ";if(this.params.form=="video")this.params.form_string=" added a video ";this.params.parent_title=$F("parent_name");this.params.title_is_excerpt=$F("title_is_excerpt");this.params.parent_blurb=$F("parent_blurb");this.params.username=$F("current-username");this.params.buzz_uri=objExists(buzzDetails.uri)?buzzDetails.uri:null;this.params.buzz_username=objExists(BF_STATIC.username)?BF_STATIC.username:null;this.params.id=objExists(i.id)?i.id:null;contrib_uri="http://"+BFWebPath()+"/"+this.params.buzz_username+"/"+this.params.buzz_uri+"?comment="+i.id;if(i.thumb){this.params.image_src=i.thumb}else{this.params.image_src=$("image-thumb").value}var r=BFWebPath()+this.params.image_src;social.contribute(this.params);if($("permalink-href")){$("permalink-href").setAttribute("href",contrib_uri);$("permalink-href").id+=Math.random()*1e5}if($("tools-bar")){$("tools-bar").show();$("tools-bar").id+=Math.random()*1e5}var a=$("contribute-preview-content").cloneNode(true);a.id+=Math.random()*1e5;var s="highlight-"+Math.floor(Math.random()*100);var o=new Element("li",{id:s});o.appendChild(a);o.setOpacity(0);if(bf_contribute.subContributeParent!=0){var n=o.getElementsByClassName("respond");if(n[0])n[0].setAttribute("rel:parent_magic_id",this.params.parent_username+":"+this.params.parent_uri)+":"+a.id;$("contrib-form-container-"+bf_contribute.subContributeParent).insert({before:o})}else{var l=o.getElementsByTagName("A");for(var u=0;u<l.length;u++){if(!l[u].className.match("scroll")){l[u].setAttribute("href",contrib_uri)}}$("contribution-list").insert({top:o})}setTimeout(function(){fadeIn(s,0)},100);var _=new BF_User;if(_.isLoggedIn()&&!$("moderation_contribute")){removeAllCssClasses("contribute-success");$("contribute-success").addClassName(this.params.type);$("contribute-success-shares").childElements().each(function(t){$(t).remove()});var f="",c="",d=objExists(i.cleaned_text)?i.cleaned_text:"";if(objExists(i.cleaned_text)){f=i.cleaned_text}c=f;if(objExists(c)&&c.indexOf("®")){c=c.replace("®","&#174;")}var b="";if(typeof this.params["react_wtih_gif"]!="undefined"){r="http://"+BFWebPath()+this.params.thumb;b="rwg:"+rwg.cleanGifName(this.params.thumb)}var h="buzzfeed";if(typeof this.params["category"]!="undefined"){var m=this.params["category"].toLowerCase();if(m=="politics"||m=="world"||m=="business"||m=="tech"||m=="usnews"||m=="uknews"||m=="aunews"||m=="francenews"||m=="canadanews"||m=="japannews"){h="buzzfeednews"}}bf_shares.fb_share({el:$("contribute-success-shares"),title:objExists(BF_STATIC.buzz_name)?BF_STATIC.buzz_name:document.title,uri:contrib_uri,size:"big",picture:r,description:objExists(c)?c:d,onclick:"gtrack.track_events('[ttp]:contribution','share/facebook/comment','"+b+"');"});bf_shares.tw_tweet({el:$("contribute-success-shares"),title:objExists(BF_STATIC.buzz_name)?BF_STATIC.buzz_name:document.title,uri:contrib_uri,size:"big",picture:r,description:f,via:h,hashtags:typeof hashtags!="undefined"?hashtags:"",onclick:"gtrack.track_events('[ttp]:contribution','share/twitter/comment','"+b+"');"});bf_shares.email_link({el:$("contribute-success-shares"),size:"big",subject:objExists(BF_STATIC.buzz_name)?BF_STATIC.buzz_name:document.title,body:(objExists(c)?c:d)+"%0D%0A"+contrib_uri,onclick:"gtrack.track_events('[ttp]:contribution','share/email/comment','"+b+"');"});$(s).insert($("contribute-success"));$("contribute-success").show()}else if(!$("moderation_contribute")){$("contribute-box").hide();if($("reg-success-message"))$("reg-success-message").update(bf_register.SUCCESS1);$("registered-success").show()}BF_Effect.ScrollIntoView(s);if($("number_of_contribs_header"))$("number_of_contribs_header").show();$("contribute-post").hide();$("contribute-preview").hide();$("contribute-form").reset();bf_contribute.reset_contribute_box();$("contribute-preview-content").update();bf_contribute_toggleTabs("on");gtrack.trackShares(25,"numComments");gtrack.track_events(gtrack.tt_page+":contribute","contribute/submit","")}else if(i.error=="duplicate name"){this.setErrMessage(this.ERR_DUPE)}else if(i.error=="blacklist"){this.setErrMessage(this.ERR_BLIST)}else{this.setErrMessage(this.ERR)}};this.previewAndPostIt=function(t){var i=parseInt($F("comments-pages"));var r=i?"ajax_comments:loaded":"ajax_comments:load";if(window[r]){var a=false;document.observe("contribute:previewFromServerOk",function(t){if(!a){a=true;this.postit.call(this,t)}}.bind(this,t));this.submit(null,t)}else{EventManager.observe(r,this.previewAndPostIt.bind(this,t));$("responses").scrollIntoView()}};this.use_minisuper=function(t){var i="auto-title_"+(new Date).getTime();var r="auto-title_"+(new Date).getTime();if(t.caption){i=t.caption;r=truncateStr(t.caption,100)}var a={action:"save",name:r,description:i,image:t.url,width:t.width,height:t.height};a["submit-to"]=364333;a["auto-tag"]=t.id==1927310?"floridaoj2":t.id==1984234?"floridaoj3":"floridaoj";var s=function(t){this._response(t)}.bindAsEventListener(this);var o=function(t){console.log(t);this.server_error(t)}.bindAsEventListener(this);new Ajax.Request("/buzzfeed/minisuper",{parameters:a,evalJSON:"force",onFailure:o,onSuccess:s})};this.setVideo=function(){var t=new bf2_terminal_Video;t.detect_type($F("video-embed"));$$("#contribute-video-form .video_privacy_warning").each(function(t){t.hide()});if(t.type){var i=t.src_link,r=BF_initSwfObject(i);r.write("video_preview");if($("video_preview"))$("video_preview").show();$("video-embed-url").value=i;if(!!t.possible_privacy_restrictions)$$("#contribute-video-form .video_privacy_warning").each(function(t){t.show()})}else{if($("video_preview"))$("video_preview").update("");if($("video_preview"))$("video_preview").hide();$("video-embed-url").value=""}};this.save_image=function(t,i,r,a){$("user-image-edit").removeClassName("bf_wide_canvas");BF_UI.closeDialog("user-image-edit",{loadDefaultDiv:"quickpost-spinner"});$("image-image").value=t;bf_contribute.image_width=i;bf_contribute.image_height=r;if(a)bf_contribute.form=a;$("image-preview").show();$("image-preview").src=BF_STATIC.image_root+t;if(i>425){$("image-preview").setStyle({width:"425px",height:"auto"})}else{if(r)$("image-preview").setStyle({height:r+"px"})}$("image-preview-div").show();$("photo-editor-button").value="Change Image..."};this.enableForm=function(t){if(!$(t))return;$(t).show();this.currentForm=t;this.type=t.match(/\-(\w+)/)[1];this.login_enable_form=false};this.cleanup_image_registration=function(){if($("contribute-submit-fieldset"))$("contribute-submit-fieldset").show();$("contribute-submit-fieldset").show();bf_contribute_toggleTabs("on");if($("image-preview-div"))$("image-preview-div").show();if($("video_preview")&&$F("video-embed"))$("video_preview").show()};this.buttonToggle=function(t){if(!$(t))return;$(t).addClassName("current");this.currentToggle=t;if(t!="image-contribute-activate"){this.cleanup_image_registration()}};this.disableCurrent=function(){$(this.currentForm).hide();if(this.currentToggle!=undefined){$(this.currentToggle).removeClassName("current")}};this.setErrMessage=function(t){$("contribute-message").update(t);$("contribute-message").addClassName("error");$("contribute-message").show();$("contribute-submit").disabled=false};this.server_error=function(t){$("saving-status").hide();this.setErrMessage(this.ERR)};this.addLineBreaks=function(t){t=t.replace(/(\r|\r\n|\n){2,}/gm,'<span class="line-break">&nbsp;</span>');t=t.replace(/(\r|\r\n|\n)/gm,"<br />");return t};this.url_entities=function(t){if(t){var r="";var a=t.split("");for(i=0;i<a.length;i++){var s=a[i].charCodeAt(0);if(s>127){r+=encodeURIComponent(a[i])}else{r+=a[i]}}return r}};this.observeRespond=function(t){t.stop();bf_contribute.reset_contribute_box();var i=this.getAttribute("rel:parent_comment_id");var r=this.getAttribute("rel:real_parent_id");if(!i){return}var a=this.getAttribute("rel:buzz_id");$("contribute-parent-id").setValue(i);$("contribute-real-parent-id").setValue(r);$("contribute-id").setValue(a);$("contrib-form-container-"+i).appendChild($("contribute-preview-content"));$("contrib-form-container-"+i).appendChild($("contribute-box"));bf_contribute.subContributeParent=i;BF_Effect.ScrollIntoView("contribute-box")};this.goforit_default=function(){$("contribute-again-link").stopObserving("click");$("contribute-again-link").observe("click",function(e){e.stop();if($("contribution-types-tab"))$("contribution-types-tab").show();if($("add-something-interesting"))$("add-something-interesting").show();if($("respond"))$("respond").removeClassName("previewing");$("contribute-preview").hide();$("contribute-submit-fieldset").show();bf_contribute_toggleTabs("on");$("contribute-form").reset();$("contribute-box").show();$("contribute-success").hide();$("contribute-cancel").hide();$("image-button").value="Select Image...";BF_Effect.ScrollIntoView("respond")})};this.goforit_reactcam=function(){$("contribute-again-link").stopObserving("click");$("contribute-again-link").observe("click",function(e){e.stop();$("contribute-success").hide();BF_Effect.ScrollIntoView("react_cam_button");document.fire("contribute:goforit_reactcam")})}};fadeIn=function(t,i){$(t).setOpacity(i/100);if(i<100){setTimeout("fadeIn('"+t+"',"+(i+2)+")",5)}};bf_contribute_toggleTabs=function(t){if(t=="on"){if($("contribution-types-tab"))$("contribution-types-tab").show();if($("add-something-interesting"))$("add-something-interesting").show()}else{if($("contribution-types-tab"))$("contribution-types-tab").hide()}};var bf_contribute=new BFContribute;BuzzLoader.register(bf_contribute.init,1);var BF_MobilePreview=function(){this.scroll_values={wrapper_offset:300,show_threshold:.98,hide_threshold:.55,header_trigger:parseInt(BF_STATIC.public_draft)?825:775};this.init=function(){var t=new BF_User,i=t.getUserInfo(),r=$s(".ptools-draftpage",true);$s(".draft-promo-content",true).appendChild(r);$s(".pt-t-edit").update("Edit");$s(".pt-t-edit").addClassName("btn--buzz btn--buzz--thin");if(acl.user_can("new_preview")){$(document).body.addClassName("new-draft");mobile_preview.default_draft=0}else{$(document).body.addClassName("default-draft");mobile_preview.default_draft=1}$$(".mobile-preview-phone").each(function(r){mobile_preview._init({back_button:$$(".browser-back-button")[0],browser_frame:r.select(".mobile-preview-browser-window")[0],home_button:r.select(".home-button")[0],preview:$("mobile-preview"),preview_url:window.location.href+"/"+(r.readAttribute("preview-mode")&&r.readAttribute("preview-mode").length>0?r.readAttribute("preview-mode"):"mobile"),preview_form:$("mobile-preview-form"),trigger:$$(".pt-preview-mobile")[0],user:t,userinfo:i,has_custom_header:$$(".longform_custom_header_media").length>0})});if(!parseInt(BF_STATIC.public_draft))mobile_preview.send_preview_init();if(document.location.href.match("log_debug")){mobile_preview.debug=true}};this._init=function(t){this.config=t;if($("mobile-preview")){if(!document.location.pathname.match(/\/_breaking_preview/)&&t.preview.hasClassName("is-auto-loaded")){this.toggle_preview()}Event.observe(top.window,"resize",function(e){if(top.window.innerWidth<1045){$s(".back-to-mobile",true).addClassName("back-to-mobile--hidden")}else{$s(".back-to-mobile",true).removeClassName("back-to-mobile--hidden")}})}};this.toggle_preview=function(){var t=this.config.trigger.getAttribute("rel:data").evalJSON();if(this.config.preview.hasClassName("is-inactive")){if(t.buzz_id){this.open_preview()}else{alert("Invalid ID ("+this.buzz_info.buzz_id+")")}}else{this.close_preview()}};this.load_iframe_src=function(t){var i=this.config.browser_frame,r=this.config.trigger,a=this.config.back_button;console.log("======================= preview_url: ",t);if(t.indexOf("?")!=-1){t=t.substring(0,t.indexOf("?"));t=t+"/mobile"}t=t+"?drafttools=0";if(/breaking_preview/.test(document.location))t+="&"+document.location.search.replace(/^\?/,"");if(!mobile_preview.preview_loaded)r.addClassName("is-loading");i.src=t;Event.observe(i,"load",function(){r.removeClassName("is-loading");mobile_preview.preview_loaded=1;Event.observe(a,"click",function(){i.src=t})})};this.open_preview=function(e){var t=this,i=this.config.preview,r=this.config.browser_frame,a=this.config.trigger,s=this.config.preview_form;mobile_preview.no_trigger=false;if(mobile_preview.default_draft){if(this.config.preview.hasClassName("is-inactive"))this.config.preview.removeClassName("is-inactive");this.config.preview.show()}t.mobile_safe=buzzDetails.postTags.match("--mobile_safe")?1:0;if(!mobile_preview.is_preview_page&&!mobile_preview.default_draft)t.send_overlay(true);if(mobile_preview.is_preview_page){s.submit();a.addClassName("is-loading")}else{this.load_iframe_src(this.config.preview_url)}Event.observe(r,"load",function(){i.show();t.close_preview_overlay({load:true});mobile_preview.wrapper_height=r.contentWindow.document.activeElement.clientHeight+300>=document.viewport.getHeight()?r.contentWindow.document.activeElement.clientHeight+300:document.viewport.getHeight();universal_dom.assign_handler({bucket:"close_info",event:"click",handler:t.close_preview_info});universal_dom.assign_handler({bucket:"bad_embed",event:"click",handler:t.close_preview_overlay});universal_dom.assign_handler({bucket:"good_embed",event:"click",handler:t.close_preview_overlay});universal_dom.assign_handler({bucket:"no_preview",event:"click",handler:t.close_preview_overlay});universal_dom.assign_handler({bucket:"phone_toggle_check",event:"click",handler:t.toggle_check});universal_dom.assign_handler({bucket:"skip_to_desktop",event:"click",handler:t.skip_to_desktop});if(store.get("preview-info")!=false&&!parseInt(BF_STATIC.public_draft)){$s(".preview-info-box").removeClassName("hidden")}a.removeClassName("is-loading");i.removeClassName("is-inactive");if(!t.mobile_safe&&!mobile_preview.default_draft){t.mobile_safe_embeds(r)}if(!mobile_preview.desktop_unlocked){if(!mobile_preview.is_preview_page&&!mobile_preview.default_draft){$s(".preview-wrapper").setStyle({height:mobile_preview.get_wrapper_height()+"px"})}}if(mobile_preview.default_draft||mobile_preview.is_preview_page){$$(".preview-error-box, .preview-info-box , .keep-scrolling-box, .android, .bflite").each(function(t){if(t)t.remove()})}if(mobile_preview.debug){mobile_preview._log_debug("VIEWPORT_HEIGHT"+document.viewport.getHeight(),"open_preview");mobile_preview._log_debug("WRAPPER_HEIGHT"+$s(".preview-wrapper").getHeight(),"open_preview")}if(!acl.user_can("bflite_preview")){$$(".mobile-preview-phone.bflite").each(function(t){if(t)t.remove()})}var s=new Element.Layout(i),o=s.get("top"),n=Element.getHeight(r),l;a.removeClassName("is-loading");if(t.config.has_custom_header&&mobile_preview.default_draft)t.move_preview(o);Event.observe(window,"scroll",function(e){if(!l){l=r.contentWindow.document.body.scrollHeight}if(mobile_preview.default_draft||mobile_preview.is_preview_page)t.move_preview(o);t.scroll_browser(n,l)});if(!mobile_preview.is_preview_page&&!mobile_preview.default_draft){mobile_preview.show_desktop(0)}})};this.close_preview=function(){this.config.preview.hide();this.config.preview.addClassName("is-inactive")};this.move_preview=function(t){var i=t,r=Element.getHeight($("page_container")),a=this.config.has_custom_header?Element.viewportOffset($("js-longform_custom_header_media")):Element.viewportOffset($("page_container")),s=this.config.preview,o=Element.getHeight(s),n=Element.viewportOffset(s);if(this.config.has_custom_header)t-=Element.getHeight($("js-longform_custom_header_media"));window.clearTimeout(l);var l=setTimeout(function(){if(a["top"]<0){if(mobile_preview.is_preview_page){i=53}else{i=10}}else if(a["top"]>0){i=t}else{return}if(i>r-o&&r>o){i=r-o}s.setStyle({top:i+"px"})},1)};this.send_preview_init=function(){var t=this;if(acl.user_can("general_admin")&&!mobile_preview.is_preview_page){$s(".send-preview").removeClassName("is-disabled")}$("send-preview-form").observe("submit",function(i){i.stop();t.send_preview(this)});$("send-preview-again").observe("click",function(t){t.stop();$$(".send-preview")[0].removeClassName("is-sent")});var i=readCookie("send_preview_number");if(i){i=JSON.parse(i);$$(".send-preview-form-fields-phone-number")[0].writeAttribute("value",i.phone_number);$$(".send-preview-form-fields-phone-country")[0].select('option[value="'+i.country_code+'"]')[0].writeAttribute("selected","selected")}};this.send_preview=function(t){var i=this;ajax=new BF_Request,container=$$(".send-preview")[0],data=t.serialize(true),url="/buzzfeed/_draft/sms_message/"+BF_STATIC.campaignid,errors=false,country_code=data["country_code"],phone_number=data["phone_number"],cookie_data={},onphone_preview="";if(!mobile_preview.default_draft)onphone_preview="/onphone";container.removeClassName("is-error");container.removeClassName("is-sent");phone_number=phone_number.replace(/[^0-9]/gi,"");if(phone_number===""||(country_code==="1"&&phone_number.length!==10||country_code==="44"&&phone_number.length!==10||country_code==="61"&&phone_number.length!==9)){errors=true}if(data["save"]&&!errors){cookie_data["country_code"]=country_code;cookie_data["phone_number"]=data["phone_number"];createCookie("send_preview_number",JSON.stringify(cookie_data),"","")}if(!errors){if(!i.mobile_safe&&!mobile_preview.default_draft){i.send_overlay()}ajax.request(url,{parameters:{phone_number:country_code+" "+phone_number,message:"Here's your mobile preview of \""+BF_STATIC.buzz_name+'" '+window.location.href+"/mobile"+onphone_preview},method:"get",onSuccess:function(t){data=JSON.parse(t.responseText);if(mobile_preview.no_embeds)$s(".preview-overlay").addClassName("hidden");if(data["success"]==1){container.removeClassName("is-ready");container.addClassName("is-sent")}else{if(mobile_preview.default_draft){$s(".send-preview-message-error").update("Oh dear. Looks like you broke something. Please try again.")}else{$s(".send-preview-message-error").update("Looks like something went wrong. Please re-enter your phone number and click Send.")}container.addClassName("is-error")}}})}else{$s(".send-preview-message-error").update("Whoops! Please make sure you've entered a valid phone number.");container.addClassName("is-error")}};this.skip_to_desktop=function(){mobile_preview.show_desktop(0);window.scrollTo(0,0);window.scrollTo(0,$s("#page-header").viewportOffset().top-50)};this.scroll_browser=function(t,i){var r=document.viewport.getHeight(),a=Element.getHeight($$("body")[0]),s=document.viewport.getScrollOffsets();if(mobile_preview.default_draft||!mobile_preview.default_draft&&!mobile_preview.desktop_unlocked){var o=s["top"]/(a-r)}var n=o*(i-t);$$(".mobile-preview-browser-window").each(function(t,i){if(!mobile_preview.desktop_unlocked){var r=t.contentDocument.getElementById("buzz");if(r==null){r=t.contentDocument.getElementById("js-post-container")}var a=parseInt(t.contentWindow.getComputedStyle(r,null).height.replace("px",""));t.contentWindow.scrollTo(0,n);if(a<=t.contentWindow.innerHeight)mobile_preview.small_post=true}if(!mobile_preview.default_draft){var s=t.contentDocument.getElementsByClassName("unavail_mobile");if(o!=undefined&&o>=mobile_preview.scroll_values.show_threshold&&!mobile_preview.is_preview_page&&!mobile_preview.default_draft&&$("mobile-preview").viewportOffset().top>0&&!mobile_preview.desktop_unlocked&&!mobile_preview.no_trigger){if(mobile_preview.debug){mobile_preview._log_debug("SHOW","scroll_browser");mobile_preview._log_debug("is_preview_page"+mobile_preview.is_preview_page,"scroll_browser");mobile_preview._log_debug("no_trigger"+mobile_preview.no_trigger,"scroll_browser")}mobile_preview.show_desktop(i,true)}if($s("#page-header").viewportOffset().top>=mobile_preview.scroll_values.header_trigger&&!mobile_preview.no_trigger&&!mobile_preview.small_post){if(mobile_preview.debug){mobile_preview._log_debug("HIDE","scroll_browser")}if(!mobile_preview.desktop_hidden)window.scrollTo(0,t.contentWindow.document.activeElement.clientHeight-500);mobile_preview.hide_desktop();mobile_preview.desktop_unlocked=false;mobile_preview.no_trigger=true}if(mobile_preview.desktop_hidden){if(o<=mobile_preview.scroll_values.hide_threshold&&mobile_preview.no_trigger&&!mobile_preview.desktop_unlocked){mobile_preview.no_trigger=false}}if(!mobile_preview.mobile_safe){for(var l=0;l<s.length;l+=1){var u=t.parentElement.parentElement.getElementsByClassName("unsafe-embed-notice");u[l].setStyle({top:s[l].getBoundingClientRect().top+"px"});if(s[l].getBoundingClientRect().top<0)u[l].addClassName("hidden");else if(s[l].getBoundingClientRect().top>0&&u[l].hasClassName("hidden"))u[l].removeClassName("hidden");if(s[l].getBoundingClientRect().top>t.contentWindow.innerHeight)u[l].addClassName("hidden")}}}});if($("mobile-preview").viewportOffset().top>=50&&!mobile_preview.default_draft&&!mobile_preview.is_preview_page){mobile_preview.no_trigger=false}if($s("#page-header").viewportOffset().top<=50&&$$(".back-to-mobile").length&&$s(".back-to-mobile").hasClassName("hidden")){$s(".back-to-mobile").removeClassName("hidden")}else if($s("#page-header").viewportOffset().top>=1&&!mobile_preview.default_draft&&!mobile_preview.is_preview_page){$s(".back-to-mobile").addClassName("hidden")}};this.get_wrapper_height=function(){var t=$s(".mobile-preview-browser-window").contentWindow.document.activeElement.clientHeight+mobile_preview.scroll_values.wrapper_offset>=document.viewport.getHeight()?$s(".mobile-preview-browser-window").contentWindow.document.activeElement.clientHeight+mobile_preview.scroll_values.wrapper_offset:document.viewport.getHeight();return t};this.launch_app=function(t){
if(t=="home"){var i=["OMG!","WTF?","LOL","WIN!","CUTE","FAIL"];var r=Math.floor(Math.random()*(i.length-1)+1);alert(i[r])}};this.mobile_safe_embeds=function(t){var i=$(t.contentWindow.document).getElementsByClassName("unavail_mobile"),r=buzzDetails.postTags.match("--mobile_safe")?1:0,a=t.parentElement.parentElement;if(!i||!i.length){mobile_preview.no_embeds=1;return false}if(t&&i&&!r){this.update_error_box(false,i.length);t.contentWindow.document.getElementsByClassName("buzz")[0].className+="mobile_draft_preview"}for(var s=0;s<i.length;s++){if(s<=i.length){var o=t.contentWindow.innerHeight<=i[s].getBoundingClientRect().top?"hidden":"";t.parentElement.parentElement.insert('<div class="unsafe-embed-notice '+o+'" style="top:'+i[s].getBoundingClientRect().top+'px"><i class="fa fa-exclamation"></i></div>')}}};this.update_error_box=function(t,i){var r=$s(".preview-error-box"),a=r.select(".preview-error-box__header")[0],s=["is","embed"],o=["are","embeds"];if(!t){if(r.hasClassName("good"))r.removeClassName("good");if(r.hasClassName("hidden"))r.removeClassName("hidden");if($("embed_count")){$("embed_count").update(i);if(i>1){s.each(function(t,i){a.innerHTML=a.innerHTML.replace(" "+s[i]+" "," "+o[i]+" ")})}}}else if(t){r.addClassName("good");$$(".confirm").each(function(t){t.removeClassName("hidden")});$$(".default").each(function(t){t.addClassName("hidden")})}};this.close_preview_info=function(){$s(".preview-info-box").addClassName("hidden");store.set("preview-info",false)};this.show_desktop=function(t,i){if(mobile_preview.debug){mobile_preview._log_debug("SHOW","show_desktop")}try{$$(".page-head, .PageContainer, .longform_custom_header_media").each(function(t){t.show()});$s(".preview-wrapper").setStyle({height:"800px"});$s(".mobile-preview").setStyle({position:"relative"});if(t<1&&!$$(".back-to-mobile").length){var r=new Element("div",{"class":"back-to-mobile"});r.insert('<div class="back-to-mobile--arrow"></div>');r.insert("<span>Back to Mobile Preview</span>");r.addClassName("hidden");r.onclick=function(){mobile_preview.desktop_unlocked=false;mobile_preview.hide_desktop();window.scrollTo(0,0)};$s(".PageContent").insert(r)}else if($s(".back-to-mobile")){$s(".back-to-mobile").removeClassName("hidden")}if(i){window.scrollTo(0,$$(".page-header")[0].offsetTop)}mobile_preview.desktop_unlocked=true}catch(a){console.log(a)}};this.hide_desktop=function(){if(mobile_preview.debug){mobile_preview._log_debug("HIDE","hide_desktop")}$$(".page-head, .PageContainer, .longform_custom_header_media").each(function(t){t.hide()});$s(".preview-wrapper").setStyle({height:mobile_preview.get_wrapper_height()+"px"});$s(".mobile-preview").setStyle({position:"fixed"});$s(".back-to-mobile").addClassName("hidden");mobile_preview.desktop_hidden=true};this.send_overlay=function(t){var i=$s(".preview-overlay");i.removeClassName("hidden");if(t){$("pre-text").update("");$("main-text").update("Loading preview...")}if(!t){setTimeout(function(){mobile_preview.update_overlay(mobile_preview.no_embeds)},3e3)}};this.update_overlay=function(t){if(t){if($("pre-text"))$("pre-text").removeClassName("hidden");if($("preview-spinner"))$("preview-spinner").removeClassName("hidden");if($("main-text"))$("main-text").update("Your mobile draft preview is on its way…");if($("overlay-buttons"))$("overlay-buttons").addClassName("hidden")}else{if($("pre-text"))$("pre-text").addClassName("hidden");if($("preview-spinner"))$("preview-spinner").addClassName("hidden");if($("main-text"))$("main-text").update("Does the embed work on your phone?");if($("overlay-buttons"))$("overlay-buttons").removeClassName("hidden")}};this.close_preview_overlay=function(e){var t=$s(".preview-overlay");if(t)t.addClassName("hidden");if(!e.load){var i=e.element.getAttribute("rel:bf_bucket");if(i=="good_embed"){mobile_preview.mobile_safe=1;mobile_preview.update_error_box(true);store.set("mobile_safe",true);$$(".unsafe-embed-notice").each(function(t){if(t)t.addClassName("hidden")});if(!e.load){mobile_preview.show_embeds()}}else if(i=="bad_embed"){mobile_preview.update_error_box(false)}}mobile_preview.update_overlay(true)};this.toggle_check=function(e){var t=e.target,i=$("phone-number-checkbox");if(t.hasClassName("fa-check-square-o")&&i.value){t.addClassName("fa-square-o");t.removeClassName("fa-check-square-o");i.removeAttribute("checked")}else if(t.hasClassName("fa-square-o")&&!i.hasAttribute("checked")){t.removeClassName("fa-square-o");t.addClassName("fa-check-square-o");i.setAttribute("checked","checked")}};this.show_embeds=function(){mobile_preview.mobile_safe=true;if($$(".unsafe-embed-notice")){$$(".unsafe-embed-notice").each(function(t){if(t)t.remove()})}var t=function(t,i){for(var r=0;r<=t.length-1;r++){if(i=="hide"&&t[r]!="undefined"){t[r].className+=" hidden"}if(i=="show"&&t[r]!="undefined"){t[r].className="draft-preview-safe-embed"}}};$$(".mobile-preview-phone").each(function(i){t(i.select("iframe")[0].contentWindow.document.getElementsByClassName("unavail_mobile"),"hide");t(i.select("iframe")[0].contentWindow.document.getElementsByClassName("draft-preview-safe-embed"),"show")})};this._log_debug=function(t,i){console.log("DEBUG_"+t+"FROM_"+i)}};if(document.location.href.match("/_draft|breaking_preview/")){var draft_no_scroll=1;var mobile_preview=new BF_MobilePreview;BuzzLoader.register(mobile_preview.init,1)}(function(t){if(t.getGlobal("flagComment"))return;var $=t.getGlobal("$");var i=t.getGlobal("$$");var r=t.getGlobal("BFW_Util");var a=t.getGlobal("BuzzLoader");var s;var o;var n=function(){this.init=function(){s=t.getGlobal("universal_dom");o=t.getGlobal("bf_catcha");flagComment.assign_handlers()};this.image_path="";this.assign_handlers=function(){s.assign_handler({bucket:"flag-comment-cancel",handler:flagComment.hide_flag_comment_form,event:"click"})};this.hide_flag_comment_form=function(){$("flag_comment").hide();o.catcha_answer=""};this.move_it=function(t){$(t).appendChild($("flag_comment").remove());var i=$("flag_comment").up().getHeight();var r=$("flag_comment").up().getWidth()-$("flag_comment").getWidth()/2;$("flag_comment").setStyle({top:i+"px"});$("flag_comment").setStyle({left:r+"px"});$("flag_submit").setAttribute("comment_id",t)};this.draw_catcha=function(){if(flagComment.image_path==""){flagComment.image_path=i("form.flag_comment_popup img")[0].src}if(r.getCookie("catcha-anonymus_flag_comment")){o.catcha_answer="";s.get_bucket_elements("catcha-anonymus_flag_comment").each(function(t){t.getElementsByTagName("INPUT")[0].value="";t.getElementsByTagName("IMG")[0].src=flagComment.image_path;t.getElementsByTagName("SPAN")[0].innerHTML="";o.set_image_and_question({service:"anonymus_flag_comment",image_element:t.getElementsByTagName("IMG")[0],question_element:t.getElementsByTagName("SPAN")[0]});t.show();$("flag_comment").show()})}}};flagComment=new n;t.setGlobal("flagComment",flagComment);a.register(function(){flagComment.init()},1)})(bfjs);BF_Reactions=function(){this.data=[];this.els={};this.ready=false;this.count_height=18;this.badge_height=25;this.step_height=3;this.min_step_difference=2;this.bar_max_height=90;this.reaction_toggle="reaction_toogle";this.reactions_wrapper="reactions_wrapper";this.main_el=null;this.reaction_template=new Template('<li id="reaction-#{name}" class="reaction-badges__item reaction-#{name} #{lang}-reaction">                        <div class="reaction-badges__bar" style="height:#{wrapper_height}px" >                            <div class="reaction-badges__bar--jump-bar"></div>                            <div class="reaction-badges__bar--static-bar" style="height:#{height}px">                                #{count_html}                                #{image_html}                                #{badge_html}                            </div>                        </div>                        #{button_html}                    </li>');this.count_template=new Template('<div class="reaction-badges__bar__reaction-count" style="margin-top: -#{margin}px;">#{count}</div>');this.image_template=new Template('<div class="reaction-badges__image #{image.name}" style="background-image:url(#{image_path});width:#{image_width}px;height:#{image_height}px;"></div>');this.badge_template=new Template('<div class="reaction-badges__badge #{badge.name}" style="margin-top:-#{badge_margin}px"><img src="#{badge.path}" class="reaction-badges__badge-img"/></div>');this.button_template=new Template('<a rel:gt_act="#{gt_act}" rel:value="#{value}" rel:abtrack_id="#{abtrack_id}" href="javascript:;" rel:message="#{message}" rel:badge_id="#{badge_id}" rel:badge_name="#{badge_name}" rel:badge_uri="#{badge_uri}" class="#{a_class} reaction-badges__btn #{name}" data-bfa="@a:Standard-Reaction; @d:#{badge_name};"><span class="reaction-badges__btn-word">#{badge_wording}</span></a>');this.init=function(t){if(typeof t.reactions_id=="undefined"||!$(t.reactions_id))return false;bf_reactions.main_el=$(t.reactions_id);bf_reactions._get_reactions_data();bf_reactions._sort();bf_reactions.main_el.innerHTML="";bf_reactions._calculate_extra_steps();var i=null;for(var r=0;r<bf_reactions.data.length;r++){bf_reactions.data[r].height=bf_reactions.calculation_reaction_height(bf_reactions.data,r);if(r==0){bf_reactions.bar_max_height=bf_reactions.data[r].height}var a=bf_reactions.build(bf_reactions.data[r]);if(bf_reactions.data[r].pin_reaction){if(!i){i=$("reaction-"+bf_reactions.data[0].name);if(!i){bf_reactions.main_el.insert(a)}else{Element.insert(i,{before:a})}}else{Element.insert(i,{after:a})}i=$("reaction-"+bf_reactions.data[r].name)}else{bf_reactions.main_el.insert(a)}var s=$("reaction-"+bf_reactions.data[r].name);bf_reactions.els["reaction-"+bf_reactions.data[r].name]={bar:s.select(".reaction-badges__bar--static-bar").first(),jump_bar:s.select(".reaction-badges__bar--jump-bar").first(),label:s.select(".reaction-badges__bar--static-bar .reaction-badges__bar__reaction-count").first(),button:s.select(".reaction-badges__btn").first(),image:s.select(".reaction-badges__bar--static-bar .reaction-image").length?s.select(".reaction-badges__bar--static-bar .reaction-image").first():false,badge:s.select(".reaction-badges__bar--static-bar .reaction-badge").length?s.select("reaction-badges__bar--static-bar .reaction-badge").first():false,height:bf_reactions.data[r].height,count_react:!isNaN(parseInt(bf_reactions.data[r].count,10))?parseInt(bf_reactions.data[r].count,10):0}}universal_dom.assign_handler({bucket:"reaction-toggle",event:"click",handler:bf_reactions.toggle});var o={el:$("slider"),reactions_class:"reaction-badges__item"};new BF_Reactions_Slider(o);if(store.get(bf_reactions.reaction_toggle)=="closed"){bf_reactions.toggle()}bf_reactions.ready=true};this.toggle=function(){var t=$(bf_reactions.reactions_wrapper).hasClassName("open")?"closed":"open";$(bf_reactions.reactions_wrapper).className=t+" reactions-carousel-wrap";$s("#reactions-normal .reactions-container__header").removeClassName("closed").removeClassName("open").addClassName(t);store.set(bf_reactions.reaction_toggle,t)};this.build=function(t){t.margin=0;t.wrapper_height=bf_reactions.bar_max_height;if(t.image&&typeof t.image.height!="undefined"&&typeof t.image.width!="undefined"&&typeof t.image.path!="undefined"&&t.image.height&&typeof t.image.name!="undefined"){t.image_height=parseInt(t.image.height,10);t.image_width=parseInt(t.image.width,10);t.image_path=t.image.path;t.wrapper_height+=t.image_height;t.margin+=t.image_height;t.image_html=bf_reactions.image_template.evaluate(t)}if(t.badge&&typeof t.badge.name!="undefined"&&typeof t.badge.path!="undefined"){t.badge_margin=0;if(typeof t.badge.height!="undefined"){t.badge_height=parseInt(t.badge.height,10)}else{t.badge_height=bf_reactions.badge_height}t.margin+=t.badge_height/2;t.wrapper_height+=t.badge_height/2;if(typeof t.image_height!="undefined"){t.wrapper_height-=t.badge_height/2;t.margin-=t.badge_height/2;t.badge_margin=t.badge_height/2}t.badge_html=bf_reactions.badge_template.evaluate(t)}t.wrapper_height+=bf_reactions.count_height;t.margin+=bf_reactions.count_height;t.count_html=bf_reactions.count_template.evaluate(t);t.button_html=bf_reactions.button_template.evaluate(t);t.wrapper_height+=10;return bf_reactions.reaction_template.evaluate(t)};this._get_reactions_data=function(){if(bf_reactions.main_el){bf_reactions.main_el.select(".reaction").each(function(t){var i=JSON.parse(t.getAttribute("reaction_data"));for(reaction_param in i){if(i[reaction_param]&&typeof i[reaction_param]=="string"){i[reaction_param]=i[reaction_param].replace(/[']/g,"&rsquo;").replace(/["]/g,"&quot;")}}if(i.name!="love"&&i.name!="hate"){if(BFW_Util.getCookie("country")!=null&&BFW_Util.getCookie("country")=="uk"){if(i.lang=="us"&&i.category!="Custom"){return}}else{if(i.lang=="uk"){return}}}bf_reactions.data.push(i)})}};this._sort=function(){function t(t,i){var r=!isNaN(parseInt(t.count,10))?parseInt(t.count,10):0;var a=!isNaN(parseInt(i.count,10))?parseInt(i.count,10):0;var s=!isNaN(parseInt(t.order,10))?parseInt(t.order,10):1e3;var o=!isNaN(parseInt(i.order,10))?parseInt(i.order,10):1e3;if(r<a)return 1;if(r>a)return-1;if(s>o)return 1;if(s<o)return-1;return 0}bf_reactions.data.sort(t)};this.calculation_reaction_height=function(t,i){if(typeof t[i-1]=="undefined"){t[i].height=bf_reactions.bar_max_height}else{if(t[i].count==0){t[i].height=0}else{var r=(bf_reactions.extra_steps*(1-t[i].count/t[i-1].count)).toFixed(0);var a=Math.min(parseInt(r)+bf_reactions.min_step_difference,t[i-1].count-t[i].count);bf_reactions.extra_steps-=Math.min(r,a);t[i].height=t[i-1].height-bf_reactions.step_height*a}}return Math.min(t[i].height,t[i].count*bf_reactions.step_height)};this._calculate_extra_steps=function(){var t={};var i=0;var r=bf_reactions.bar_max_height/bf_reactions.step_height;bf_reactions.data.each(function(r,a){if(typeof t[r.count]=="undefined"){if(typeof t[1+parseInt(r.count,10)]!="undefined"){i++}else{i+=bf_reactions.min_step_difference}t[r.count]=parseInt(r.count,10)}});bf_reactions.extra_steps=r-i};this.grow_up_css=function(t){if(typeof bf_reactions.els[t.up(".reaction-badges__item").id]=="undefined")return false;var i=bf_reactions.els[t.up(".reaction-badges__item").id];if(!i.button.hasClassName("reaction-badges__btn--voted")){i.button.addClassName("reaction-badges__btn--voted");i.jump_bar.setStyle({height:i.height+bf_reactions.step_height+"px",visibility:"hidden"});var r=bf_reactions.whichAnimationEvent();r&&i.jump_bar.addEventListener(r,function(){i.jump_bar.removeClassName("animated").removeClassName("bounce-in-up")});setTimeout(function(){i.jump_bar.addClassName("animated").addClassName("bounce-in-up");setTimeout(function(){i.bar.addClassName("hidden");i.jump_bar.setStyle({visibility:"visible"});i.jump_bar.insert(i.bar.innerHTML);i.jump_bar.select(".reaction-badges__bar__reaction-count").first().innerHTML=i.count_react+1},360)},10)}};this.whichAnimationEvent=function(){var t;var i=document.createElement("fakeelement");var r={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(t in r){if(i.style[t]!==undefined){return r[t]}}}};BF_Reactions_Slider=function(t){this.el=null;this.reactions=[];this.slider_wrapper_width=0;this.slider_wrapper_class="reaction-badges__slider";this.reactions_width=0;this.index_first_visible_el=0;this.overlay=null;this.arrow_left=null;this.arrow_right=null;this.slider_animating=false;this.transform=0;this.init(t)};BF_Reactions_Slider.prototype.init=function(t){if(typeof t.el=="undefined"||!t.el)return false;if(typeof t.reactions_class=="undefined"||!t.reactions_class){t.reactions_class="reaction"}var i=this;this.el=t.el;this.reactions=this.el.select("."+t.reactions_class);this.slider_wrapper=this.el.select(".reaction-badges__slider").first();this.overlay=this.el.select(".overlay").first();this.arrow_left=this.el.select(".reactions-carousel__arrows--left").first();this.arrow_right=this.el.select(".reactions-carousel__arrows--right").first();this.slider_wrapper_width=this.el.getLayout().get("width")-68;this.reactions_width=0;this.reactions.each(function(t){i.reactions_width+=t.getLayout().get("margin-box-width")});var r=this.slider_wrapper_width;if(this.slider_wrapper_width+this.reactions[this.index_first_visible_el].getLayout().get("margin-box-width")>this.reactions_width){r=this.slider_wrapper_width+(this.reactions_width-this.slider_wrapper_width)}else{this._show_right_arrow()}this.el.select("."+this.slider_wrapper_class).first().setStyle({width:r+"px"});this.add_slider_overlay();this.arrow_left.observe("click",function(t){i.max_slide_css(t)});this.arrow_right.observe("click",function(t){i.max_slide_css(t)})};BF_Reactions_Slider.prototype._hide_right_arrow=function(){this.arrow_right.addClassName("hidden")};BF_Reactions_Slider.prototype._hide_left_arrow=function(){this.arrow_left.addClassName("hidden")};BF_Reactions_Slider.prototype._show_right_arrow=function(){this.arrow_right.removeClassName("hidden")};BF_Reactions_Slider.prototype._show_left_arrow=function(){this.arrow_left.removeClassName("hidden")};BF_Reactions_Slider.prototype.add_slider_overlay=function(){var t=0;var i=true;this.overlay.addClassName("hidden");var r=this.el.select("."+this.slider_wrapper_class).first().offsetWidth;for(var a=this.index_first_visible_el;a<this.reactions.length;a++){t+=this.reactions[a].getLayout().get("margin-box-width");if(t==r){i=false}else if(t>r){this.overlay.setStyle({width:this.reactions[a].getLayout().get("margin-box-width")+r-t+"px"}).removeClassName("hidden");break}}};BF_Reactions_Slider.prototype._set_slider_wrapper_width=function(t){this.slider_wrapper.setStyle({width:t+"px"})};BF_Reactions_Slider.prototype.max_slide_css=function(e){_this=this;if(this.slider_animating)return false;this.slider_animating=true;this.transform=0;this.not_supported_transition_event="not_supported:transition";var t=e.target,i=0,r=0,a=this.slider_wrapper_width;for(var s=0;s<this.index_first_visible_el;s++){i+=this.reactions[s].getLayout().get("margin-box-width")}if(t.hasClassName("right")){for(var s=this.index_first_visible_el;s<=this.reactions.length-1;s++){if(this.reactions_width<=i+r+this.slider_wrapper_width){this.index_first_visible_el=s;break}r+=this.reactions[s].getLayout().get("margin-box-width");if(r>=a){this.index_first_visible_el=s;break}}}else{for(var s=this.index_first_visible_el-1;s>=0;s--){r+=this.reactions[s].getLayout().get("margin-box-width");if(r>=a){this.index_first_visible_el=s+1;break}if(s==0)this.index_first_visible_el=0}}for(var s=0;s<this.index_first_visible_el;s++){this.transform+=this.reactions[s].getLayout().get("margin-box-width")}this.el.select(".reaction-badges__slider__items").first().observe(this.whichTransitionEvent(),this.after_animation);this.el.select(".reaction-badges__slider__items").first().setStyle({"-ms-transform":"translateX(-"+this.transform+"px)","-webkit-transform":"translateX(-"+this.transform+"px)",transform:"translateX(-"+this.transform+"px)"});if(this.transform+this.slider_wrapper_width+this.reactions[this.index_first_visible_el].getLayout().get("margin-box-width")>this.reactions_width){this._hide_right_arrow()}else{this._set_slider_wrapper_width(a);this.add_slider_overlay()}if(this.transform!=0){this._show_left_arrow()}else{this._hide_left_arrow()}if(this.whichTransitionEvent()==this.not_supported_transition_event){this.el.select(".reaction-badges__slider__items").first().fire(this.not_supported_transition_event)}};BF_Reactions_Slider.prototype.after_animation=function(){if(_this.transform+_this.slider_wrapper_width+_this.reactions[_this.index_first_visible_el].getLayout().get("margin-box-width")>_this.reactions_width){_this._set_slider_wrapper_width(_this.slider_wrapper_width+(_this.reactions_width-(_this.transform+_this.slider_wrapper_width)));_this.add_slider_overlay()}else{_this._show_right_arrow()}_this.slider_animating=false;_this.el.select(".reaction-badges__slider__items").first().stopObserving(_this.whichTransitionEvent(),_this.after_animation);EventManager.fire("reaction_slider:animation_end")};BF_Reactions_Slider.prototype.whichTransitionEvent=function(){var t;var i=document.createElement("fakeelement");var r={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in r){if(i.style[t]!==undefined){return r[t]}}return this.not_supported_transition_event};var bf_reactions=new BF_Reactions;BuzzLoader.register(function(){bf_reactions.init({reactions_id:"reactions"})},5);var Bookmarks=function(){var t=this;this.initializedGoogleCallback=false;this.maxBookmarkCount=1e3;this.ajaxUrl="/buzzfeed/api/bookmarks";this.bookmarkContainerClass="bookmark-share share-bookmark";this.bookmarksData={userId:"",bookmarks:{},showPromo:true,hasBookmarks:false,addAfterLogin:0,sync_id:0};this.templates={post_button:'<a class="bf_dom shareBtn share-button big square" rel:gt_cat="Buzz:sharing-upper" rel:gt_act="bookmark" rel:bf_bucket="add_bookmark" href="javascript:;" data-bfa="@a:Bookmark;">						<svg viewBox="0 0 512 512" class="svg-icon"><use xlink:href="#icon-bookmark"></use<></svg>						<div class="label">Bookmark it</div>					</a>					<div class="bookmark-tooltip" style="display:none;"></div>',tooltips:{new_tooltip:"<b>NEW!</b> <a>Click to bookmark</a>",bookmarked_tooltip:"<b>"+local.t("Bookmarked!")+'</b><a class="bf_dom view-bookmarks" rel:gt_cat="Buzz:sharing-upper" rel:gt_act="view-bookmarks" href="#">'+local.t("View bookmarks")+"</a>"},bmtools:'<div class="bookmark-tools"  rel:gt_cat="BuzzBookmarks:feed" >								<a class="bf_dom bm-tool-track bookmark-tools__icon bookmark-share fa fa-share" href="javascript:;" rel:bf_bucket="share_bookmark"></a>								<a class="bf_dom bm-tool-track bookmark-tools__icon bookmark-delete fa fa-trash-o" href="javascript:;"  rel:bf_bucket="delete_bookmark_confirm"></a>								<div class="clear"></div>								<div class="bookmark-tools__delete-confirm bm-tool-track bf_dom" style="display: none;"><span>Are you sure?</span><a class="bookmark-tools__cancel-delete bf_dom bm-tool-track" rel:bf_bucket="cancel_delete_bookmark">No</a><a class="bookmark-tools__delete bf_dom bm-tool-track" rel:bf_bucket="delete_bookmark">Yes</a></div>							</div>',bookmark_item:'<article>											<header>												<div class="thumb-unit"><a href="'+BF_STATIC.web_root+'/#{username}/#{uri}" class="title" ><img src="#{image}" width="125" height="83" alt="" /></a></div>												<hgroup><h2><a href="'+BF_STATIC.web_root+'/#{username}/#{uri}" class="title" >#{title}</a></h2></hgroup>											</header>											<div class="small-meta"><div class="small-meta__item small-meta__item--timestamp"><svg viewBox="0 0 512 512" class="svg-icon small-meta__icon small-meta__icon--time f-icon-time_grey_10"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-time"></use></svg><time>Saved #{ago} ago</time></div></div>										</article>',bookmark_share:"<div class=\"bookmark-share-block bm-tool-track share-block share-block--light share-block--stacked share-block--bookmarks\" style=\"display: none;\" rel:bf_bucket=\"hide_bookmark_share\" ><ul class=\"share-block__list\">						<li class=\"share_facebook share-facebook\">								<img src=\"#{share_gif}\" onload=\"sharing.buttons.facebook_share({'replace': this,'url': '#{share_url}','type': '#{type}','icon': 'facebook-f'  });\" />						</li>						<li class=\"share_twitter share-twitter\">								<img src=\"#{share_gif}\" onload=\"sharing.buttons.twitter({'replace': this,'type': '#{type}','via': '#{via}','url': '#{buzz_id}','blurb': '#{blurb}' ,'icon': 'tweet'});\" />						</li>						<li class=\"share_email share-email\">							<a class=\"bm-tool-track\" target=\"_self\" href=\"mailto:?subject=#{blurb}&body=#{emailbody}\"><svg viewBox=\"0 0 512 512\" class=\"svg-icon\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#social-icon--email\"></use></svg></a>						</li>						<li class=\"share_pinterest share-pinterest\"><img src=\"#{share_gif}\" onload=\"sharing.buttons.pinterest({'replace': this,'type': 'longform', 'icon': 'pinterest'});\" />						</li>						<li class=\"share_google share-google\"><img src=\"#{share_gif}\" onload=\"sharing.buttons.googleplus({'replace': this,'url': '#{share_url}',  'icon': 'google-plus' });\" />						</li>					</ul>				</div>",share_gif:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",bookmark_spinner:'<div id="bookmark_overlay"><div class="bookmarks-loader-content">Syncing bookmarks...</div><div class="bookmark-loader loader"></div></div>',bookmark_popup_container:'<div class="bookmark-white-overlay" style="display: none;"><div id="bookmark-popup" style="display: none;"><a href="javascript:;" class="bookmark-popup__close bf_dom fa fa-times" rel:bf_bucket="close_bookmark_popup" ></a><div class="bookmark-popup__content"></div></div></div>',bookmark_popups:{saved:'<div class="bookmark-login bookmark-login__title">'+local.t("Bookmark saved!")+'</div><div class="bookmark-login__content">'+local.t("Your bookmarked stories are saved to your")+' <a class="bookmark-acc-link">'+local.t("BuzzFeed account")+'</a>.</div><div id="bookmarks-promo" class="bookmarks-promo"><a href="/tools/mobile-ios">'+local.t("Download")+"</a> "+local.t("the Buzzfeed app for<br />iOS or Android and sign in to<br />access your bookmarks on the go!")+"</div>",login:'<div class="bookmark-login bookmark-login__title">'+local.t("See your bookmarks from anywhere!")+'</div>							<div class="bookmark-login__content bookmark-login__content--account"><div class="bookmark-login__icon"></div><div class="bookmark-login__text">'+local.t("Bookmarked stories are saved to your BuzzFeed account")+'</div></div>							<div class="bookmark-login__content bookmark-login__content--app"><div class="bookmark-login__icon"></div><div class="bookmark-login__text">'+local.t("Save them for later or view them on<br />the go with the BuzzFeed app.")+'<a href="/tools/mobile-ios" class="bf_dom bookmark-login__link-download" rel:gt_cat="MobileBuzzBookmark:pop-up" rel:gt_act="app-promo" >'+local.t("Download the app!")+'</a></div></div>							<div class="bookmark-login__content bookmark-login__content--share">							<a rel:gt_act="initial-fb-sign-header" rel:bf_bucket="signin_with_facebook" class="fb-button bf_dom" href="javascript:;"><div class="fb-icon fa fa-facebook"></div><div class="fb-label" id="initial_fb_text">'+local.t("Sign in with Facebook")+'</div></a>              <a rel:gt_act="googleplus-signin-header" rel:bf_bucket="gplus_login" class="bf-gplus-button bf_dom"><span id="g-signin-button"></span><div class="gplus-icon fa fa-google-plus"></div><div class="gplus-label" id="initial_gplus_text">'+local.t("Sign in with Google")+'</div></a>              </div>              <div class="bookmark-login__content bookmark-login__content--more-options"><a id="bookmark-more-signin" class="bf_dom bookmark-login__more-signin" rel:bf_bucket="bookmark_more_signin">'+local.t("More Sign In Options")+"</a></div>"}};this.init=function(){if(document.location.href.match("/_draft/"))return false;this.initHandlers();this.build()};this.initHandlers=function(){universal_dom.assign_handler({bucket:"add_bookmark",event:"click",handler:this.addBookmark.bind(this)});universal_dom.assign_handler({bucket:"close_bookmark_popup",event:"click",handler:this.closePopup.bind(this)});universal_dom.assign_handler({bucket:"gplus_login",event:"click",handler:this.gPlusLogin.bind(this)});universal_dom.assign_handler({bucket:"bookmark_more_signin",event:"click",handler:this.openMoreSignIn.bind(this)});universal_dom.assign_handler({bucket:"delete_bookmark_confirm",event:"click",handler:this.deleteBookmarkConfirm.bind(this)});universal_dom.assign_handler({bucket:"cancel_delete_bookmark",event:"click",handler:this.cancelDeleteBookmark.bind(this)});universal_dom.assign_handler({bucket:"delete_bookmark",event:"click",handler:this.deleteBookmark.bind(this)});universal_dom.assign_handler({bucket:"share_bookmark",event:"click",handler:this.shareBookmark.bind(this)});universal_dom.assign_handler({bucket:"hide_bookmark_promo",event:"click",handler:this.hideBookmarkPromo.bind(this)});universal_dom.assign_handler({bucket:"signin_with_facebook",event:"click",handler:this.onFacebookSignIn.bind(this)})};this.build=function(){this.user=new BF_User;var i=store.get("bookmark_data");if(!i){i=this.defaultData(0)}if(this.user.isLoggedIn()&&i.userId!==this.user.getUserInfo().userid&&i.userId||!this.user.isLoggedIn()){i=this.defaultData(this.user.getUserInfo().userid)}this.setBookmarkUserData(i);if(BF_STATIC.tt_page=="User"&&document.location.pathname.match(/\/bookmarks/)){if(this.user.isLoggedIn()&&document.location.pathname.match(this.user.getUserInfo().username)){if(this.bookmarksData.showPromo){$("bookmarks-promo").show()}this.showUserBookmarks()}else{$("bookmark_overlay").hide();$("bookmarks-unauthorized").show();$("bookmarks-container").hide()}}else if(BF_STATIC.tt_page=="Buzz"){for(var r=0;r<$$("header div.square_shares").length;r++){if(!$$("header div.square_shares")[r].hasClassName("hidden")){$$("header div.square_shares")[r].addClassName("shown")}}this.showPostBookmarkButton("header div.square_shares.shown > .horizontal-share-buttons",false);if($("inline_shares_box"))this.showPostBookmarkButton("#inline_shares_box .share-block__list",true)}else if(BF_STATIC.tt_page=="Videos"){this.showPostBookmarkButton(".video-splash-share .bottom-share-buttons",false)}if((typeof $$(".rerank_cta")[0]!="undefined"||!$$(".rerank_cta")[0].hasClassName("hidden"))&&this.container.select(".bookmark-tooltip").length&&this.container.select(".bookmark-tooltip")[0].visible()){this.hideTooltips()}Event.observe($$(".video-splash-share .bookmark-share a")[0],"click",function(){t.addBookmark()});Event.observe($$("#bookmark-popup .bookmark-popup__close")[0],"click",function(){t.closePopup()});Event.observe($$("#bookmark-popup .fb-button")[0],"click",function(){t.onFacebookSignIn()})};this.showPostBookmarkButton=function(t,i){if(!$$(t).length)return;$$("body")[0].insert(this.templates.bookmark_popup_container);this.container=$$(t)[0];var r=this.container.select(".clear");if(!r.length)return;var a=this.templates.post_button;if(this.container.parentNode&&this.container.parentNode.getAttribute("data-bfa-campaignid")){a=a.replace('data-bfa="@a:Bookmark;"','data-bfa="@a:Bookmark;@d:'+this.container.parentNode.getAttribute("data-bfa-campaignid")+';"')}if(i){a='<li class="'+this.bookmarkContainerClass+'">'+a+"</li>"}else{a='<div class="'+this.bookmarkContainerClass+'">'+a+"</div>"}r[0].insert({before:a});if(this.user.isLoggedIn()&&this.bookmarksData.addAfterLogin&&this.bookmarksData.addAfterLogin==BF_STATIC.campaignid){this.addBookmark(this.bookmarksData.addAfterLogin)}else{this.showTooltips("start")}universal_dom.update($s(".bookmark-share a.shareBtn"))};this.gPlusLogin=function(){if(typeof gapi!=undefined&&typeof gapi.auth!=undefined){t.initializedGoogleCallback=false;var i={clientid:BF_STATIC.google_plus_client_id,redirecturi:"postmessage",accesstype:"offline",cookiepolicy:"single_host_origin",callback:t.onGoogleSignIn,apppackagename:"com.buzzfeed.android"};gapi.auth.signIn(i)}};this.defaultData=function(t){return{userId:t,bookmarks:{},showPromo:true,hasBookmarks:false,addAfterLogin:0,sync_id:0}};this.openPopup=function(t){var i=$$("#bookmark-popup .bookmark-popup__content");if(!i.length)return false;i[0].innerHTML=this.templates.bookmark_popups[t];universal_dom.update($$(".bookmark-popup__close")[0]);$("bookmark-popup").className="bookmark-popup";$("bookmark-popup").addClassName(t);$("bookmark-popup").show();$s(".bookmark-white-overlay").show();if(t==="login"){universal_dom.update(i[0]);if(BF_STATIC.tt_page=="Videos"||BF_STATIC.language!=="en"){$s("#bookmark-popup .bf-gplus-button").hide();if(BF_STATIC.tt_page=="Videos")$("bookmark-popup").addClassName("video-bookmark")}}else{var r=BF_STATIC.web_root+"/bookmarks/"+this.user.getUserInfo().username;$s(".bookmark-acc-link").setAttribute("href",r)}};this.closePopup=function(t){$("bookmark-popup").hide();
if(typeof t!=="boolean"||!t)$s(".bookmark-white-overlay").hide();this.removeSpinner()};this.openMoreSignIn=function(){BF_LOGIN_SIGNUP.show({locationName:"header",onSuccessLoginCb:function(){BF_LOGIN_SIGNUP.updateUserNav();location.reload()}.bind(this),onCancelLoginCb:function(){$s(".bookmark-white-overlay").hide()}});this.closePopup(true)};this.setBookmarkUserData=function(t){var i=false,r;for(r in t){if(t[r]!==this.bookmarksData[r]){this.bookmarksData[r]=t[r];i=true}}if(i){store.set("bookmark_data",this.bookmarksData)}};this.showUserBookmarks=function(){new Ajax.Request(this.ajaxUrl,{method:"get",parameters:{sync_id:t.bookmarksData.sync_id},onComplete:function(i){if(i.status===304){t.drawBookmarkList(t.bookmarksData.bookmarks)}else{var r=i.responseText.evalJSON();if(r.success){t.setBookmarkUserData({bookmarks:r.bookmarks,sync_id:r.sync_id});t.drawBookmarkList(r.bookmarks)}else{console.error("added ajax error",r.error)}}}})};this.drawBookmarkList=function(i){if(i.length){$("bookmarks-count").innerHTML=i.length;var r=document.createElement("ul");r.className="flow bookmarks-list bf_dom";r.id="bookmarks_list";var a=new Template(t.templates.bookmark_item);var s=new Template(t.templates.bookmark_share);for(var o=0;o<i.length;o++){var n=i[o];var l=document.createElement("li");l.id="post-"+n.buzz_id;l.className="post bf_dom";l.setAttribute("rel:buzz_id",n.buzz_id);n.ago=this.getDateAgo(n.date_added);l.setAttribute("rel:ptool","true");l.setAttribute("rel:bf_bucket","post");if(n.image==null){n.image="/static/images/public/backgrounds/trans.gif"}var u={share_gif:t.templates.share_gif,type:"longform",buzz_id:n.buzz_id,via:"buzzfeed",blurb:n.title.replaceAll('"',"%22").replaceAll("&#39;","%27").replaceAll("&%2339;","%27").replaceAll("'","%27").replaceAll("&amp;","&#38;"),share_url:"http://"+document.domain+BF_STATIC.web_root+"/"+n.username+"/"+n.uri};u.emailbody=encodeURIComponent("Hey, I saw this on BuzzFeed and thought of you.")+"%0D%0A %0D%0A"+encodeURIComponent(u.share_url);l.innerHTML=a.evaluate(n)+this.templates.bmtools;l.select(".bookmark-tools")[0].insert(s.evaluate(u));r.appendChild(l)}$("bookmarks-container").update(r);t.prepareTools()}else{$("bookmarks-count").innerHTML="0";$("bookmarks-container").insert('<div class="default-text">You don\'t have bookmarks yet</div>')}$("bookmark_overlay").hide()};this.getDateAgo=function(t){var i=new Date(0);i.setUTCSeconds(t);var r=Math.floor((new Date-i)/1e3);var a=Math.floor(r/31536e3);if(a>=1){return a+" year"+(a>1?"s":"")}a=Math.floor(r/2592e3);if(a>=1){return a+" month"+(a>1?"s":"")}a=Math.floor(r/86400);if(a>=1){return a+" day"+(a>1?"s":"")}a=Math.floor(r/3600);if(a>=1){return a+" hour"+(a>1?"s":"")}a=Math.floor(r/60);if(a>=1){return a+" minute"+(a>1?"s":"")}return Math.floor(r)+" seconds"};this.hideTooltips=function(){var t=this.container.select(".bookmark-tooltip");if(!t.length)return;t[0].hide()};this.showTooltips=function(t){var i=this.container.select(".bookmark-tooltip");if(!i.length)return false;i=i[0];i.innerHTML="";if(t=="start"){if(new Date(2014,8,15)>new Date&&!this.bookmarksData.hasBookmarks){i.insert(this.templates.tooltips.new_tooltip);if(this.container.getAttribute("class")!=="share-block__list"){i.show()}}}if(t=="bookmark-tooltip--bookmarked"){i.insert(this.templates.tooltips.bookmarked_tooltip);i.addClassName("bookmark-tooltip--bookmarked");i.removeClassName("bookmark-tooltip--bookmarked-standard");if(this.bookmarksData.hasBookmarks){this.container.select(".bookmark-tooltip .view-bookmarks")[0].hide();i.addClassName("bookmark-tooltip--bookmarked-standard")}else{var r=BF_STATIC.web_root+"/bookmarks/"+this.user.getUserInfo().username;this.container.select(".bookmark-tooltip .view-bookmarks")[0].setAttribute("href",r)}i.show()}};this.onFacebookSignIn=function(){this.spinner();bf_login.loggedInCallbacks.push(function(){t.removeSpinner()});facebook.FB_login(false,this.removeSpinner.bind(this))};this.onGoogleSignIn=function(i){if(!t.initializedGoogleCallback)t.spinner();if(!i["status"]["signed_in"]){t.removeSpinner();t.closePopup();return}else if(i["status"]["signed_in"]&&!t.initializedGoogleCallback){new Ajax.Request("/buzzfeed/_www_login",{method:"post",parameters:{googleplus:"1",otc:i["code"]},onSuccess:function(i){t.removeSpinner();gplus._result(i);t.closePopup()},onFailure:function(i){t.removeSpinner();return}})}t.initializedGoogleCallback=true};this.spinner=function(){return false};this.removeSpinner=function(){return false};this.addBookmark=function(i){this.hideTooltips();if(this.user.isLoggedIn()){var r=0;if(BF_STATIC.tt_page=="Videos"){r=videopromo["buzz_id"]}else{r=BF_STATIC.campaignid}if(!r){console.error("add error - wrong buzz_id");return false}if(i&&typeof i!=="object"){r=i}else if(i&&typeof i==="object"){var a=i.target.up("div").up();if(a!==this.container){this.container=a}}new Ajax.Request(this.ajaxUrl,{method:"post",parameters:{buzz_id:r},onComplete:function(i){var r=i.responseText.evalJSON();if(r.success){if(t.maxBookmarkCount-r.bookmarks_remaining==1&&!t.bookmarksData.hasBookmarks){t.openPopup("saved")}t.showTooltips("bookmark-tooltip--bookmarked");t.setBookmarkUserData({hasBookmarks:true,addAfterLogin:0});t.container.down(".bookmark-share").addClassName("disabled")}else{console.error("added ajax error",r.error)}}})}else{t.setBookmarkUserData({addAfterLogin:BF_STATIC.campaignid});this.openPopup("login")}};this.shareBookmark=function(e){var t=Event.element(e);this.safeVisibilityToggle($(t).up(".bookmark-tools").select(".bookmark-tools__delete-confirm"),false);this.safeVisibilityToggle($(t).up("div").select(".bookmark-share-block"),true);return false};this.safeVisibilityToggle=function(t,i){if(!t.length)return false;if(i){t[0].show()}else{t[0].hide()}};this.hideBookmarkShare=function(e){$(e).hide()};this.hideBookmarkDeleteDialog=function(e){$(e).hide()};this.deleteBookmarkConfirm=function(e){var t=Event.element(e);this.safeVisibilityToggle($(t).up(".bookmark-tools").select(".bookmark-tools__delete-confirm"),true);this.safeVisibilityToggle($(t).up("div").select(".bookmark-share-block"),false);return false};this.cancelDeleteBookmark=function(e){var t=Event.element(e);this.safeVisibilityToggle($(t).up(".bookmark-tools").select(".bookmark-tools__delete-confirm"),false);return false};this.deleteBookmark=function(e){var t=Event.element(e);$(t).up(".bookmark-tools").hide();var i=$(t).getAttribute("rel:buzz_id");if(!i){console.error("delete error - wrong buzz_id");return false}this.safeVisibilityToggle($(t).up(".bookmark-tools").select(".bookmark-tools__delete-confirm"),false);new Ajax.Request(this.ajaxUrl,{method:"post",parameters:{buzz_id:i,_method:"delete"},onComplete:function(t){var r=t.responseText.evalJSON();if(r.success){$("post-"+i).remove();$("bookmarks-count").innerHTML=$("bookmarks-count").innerHTML-1}else{console.error("delete ajax error",r.error)}}});return false};this.prepareTools=function(){var i=$$("#bookmarks_list > li");if(i.length){i.each(function(t){t.select(".bm-tool-track").each(function(i){i.setAttribute("rel:buzz_id",t.getAttribute("rel:buzz_id"));universal_dom.update(i)});t.select(".inlineShareBtn").each(function(t){universal_dom.update(t)});t.select(".shareBtn").each(function(t){universal_dom.update(t)})})}$$(".bookmark-tools__delete-confirm").each(function(i){$(i).observe("mouseleave",function(){t.hideBookmarkDeleteDialog(i)})});$$(".bookmark-share-block").each(function(i){$(i).observe("mouseleave",function(){t.hideBookmarkShare(i)})})};this.hideBookmarkPromo=function(){$("bookmarks-promo").hide();this.setBookmarkUserData({showPromo:false})}};if(BF_STATIC.tt_page=="User"||BF_STATIC.tt_page=="Buzz"||BF_STATIC.tt_page=="Videos"){var bookmarks=new Bookmarks;BuzzLoader.register(bookmarks.init.bind(bookmarks),6)}(function(t){var $=t.getGlobal("$");var i=t.getGlobal("$s");var r=t.getGlobal("Event");var a=t.getGlobal("BuzzLoader");var s=t.getGlobal("BF_UTIL");var o=t.getGlobal("draft_no_scroll");var n=function(){var t=this;var r;var a;var n;var l;var u;var _;var f;this.setShareBarVars=function(){l=a?a.cumulativeOffset().top:0,u=n?n.cumulativeOffset().top:0,_=document.viewport.getScrollOffsets().top,f=_+s.browser.dimensions.height()};this.waitShareBarVars=function(){t.setShareBarVars();if(a&&!l||n&&!u){setTimeout(function(){t.waitShareBarVars()},50)}else{t.showShareBar()}return};this.showShareBar=function(){if(!r||o)return;t.setShareBarVars();if(u<=0&&i(".wide-content"))u=i(".wide-content").getHeight();if(_>=l){if(f<=u){r.addClassName("share-block--sticky")}else{r.removeClassName("share-block--sticky")}}else{r.removeClassName("share-block--sticky")}};this.init=function(){r=$("inline_shares_box");a=$$(".square_shares:not(.hidden) .upper-share-buttons").length?$$(".square_shares:not(.hidden) .upper-share-buttons")[0]:null;n=$$(".square_shares:not(.hidden) .bottom-share-buttons").length?$$(".square_shares:not(.hidden) .bottom-share-buttons")[0]:null;t.waitShareBarVars()}};var l=new n;r.observe(window,"scroll",l.showShareBar);a.register(l.init,5)})(bfjs);(function(){if(!window.Box||!Box.Application||!Box.Application.getService("template-engine"))return;Box.Application.getService("template-engine").addTemplates({_share_button:new Hogan.Template({code:function(t,i,r){var a=this;a.b(r=r||"");a.b("\n"+r);a.b('<div id="share-btn-template" class="js-share-btn-template" style="display: none">');a.b("\n"+r);a.b('<a class="share-btn">');a.b("\n"+r);a.b("</a>");a.b("\n"+r);a.b("</div>");a.b("\n");return a.fl()},partials:{},subs:{}})})})();(function(){if(!window.Box||!Box.Application||!Box.Application.getService("template-engine"))return;Box.Application.getService("template-engine").addTemplates({modal_base:new Hogan.Template({code:function(t,i,r){var a=this;a.b(r=r||"");a.b('<div class="modal__wrapper solid">');a.b("\n"+r);a.b('  <div class="modal__content xs-mt0 sm-mt6 xs-col-12 sm-col-9 md-col-7 lg-col-5">');a.b("\n"+r);a.b('    <a class="modal__close" href="javascript:">');a.b("\n"+r);a.b('      <svg class="modal__close-icon" viewBox="0 0 512 512"><use xlink:href="#close--thick"></use></svg>');a.b("\n"+r);a.b("    </a>");a.b("\n"+r);a.b('    <div class="modal__body"></div>');a.b("\n"+r);a.b("  </div>");a.b("\n"+r);a.b("</div>");return a.fl()},partials:{},subs:{}})})})();if(typeof String.prototype.trim==="undefined"){String.prototype.trim=function(){return String(this).replace(/^\s+|\s+$/g,"")}}var AdGeoTranslations={init:function(){this.geoId=this.getCookie("bf-geo-country");this.translation_map={GB:{"Brand Publisher":"Promoted Content"}}},getCookie:function(t){var i=new RegExp(t+"=([^;]+)");var r=i.exec(document.cookie);return r!=null?unescape(r[1]):null},getId:function(){return this.geoId},getTranslation:function(t){if(this.translation_map[this.geoId]&&this.translation_map[this.geoId][t.trim()]){return this.translation_map[this.geoId][t.trim()]}}};var adGeo=AdGeoTranslations;adGeo.init();document.addEventListener("DOMContentLoaded",function(t){var i=document.getElementsByClassName("byline__title_f_ad");for(var r=0;r<i.length;r++){if(adGeo.getTranslation(i[r].innerHTML.trim())){i[r].innerHTML=adGeo.getTranslation(i[r].innerHTML.trim())}i[r].style.display="block"}});